{"file_contents":{"src/components/floating-countries.css":{"content":"/* Improved floating countries for better visibility and accessibility */\n.floating-container {\n  position: relative;\n  width: 100%;\n  height: auto;\n  min-height: 600px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-wrap: wrap;\n  gap: 2.5rem;\n  padding: 3rem 1.5rem;\n  overflow: visible;\n}\n\n.floating-circle {\n  width: 120px;\n  height: 120px;\n  border-radius: 50%;\n  background: linear-gradient(135deg, #ffffff 0%, #f5f5f5 100%);\n  border: 2px solid #d0d0d0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);\n  position: relative;\n  animation: float 5s ease-in-out infinite;\n  animation-delay: var(--delay);\n  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.12);\n  flex-shrink: 0;\n}\n\n.floating-circle:hover {\n  transform: scale(1.12);\n  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.18);\n}\n\n.floating-circle:focus-visible {\n  outline: 3px solid #8b0000;\n  outline-offset: 4px;\n}\n\n/* Countries with conflict shown in red */\n.floating-circle.has-conflict {\n  background: linear-gradient(135deg, #8b0000 0%, #a00000 100%);\n  border-color: #6b0000;\n  color: white;\n  box-shadow: 0 6px 20px rgba(139, 0, 0, 0.25);\n}\n\n.floating-circle.has-conflict:hover {\n  background: linear-gradient(135deg, #a00000 0%, #c00000 100%);\n  box-shadow: 0 10px 30px rgba(139, 0, 0, 0.35);\n}\n\n.country-name {\n  font-size: 0.95rem;\n  font-weight: 600;\n  text-align: center;\n  line-height: 1.3;\n  padding: 0.8rem;\n  color: #1a1a1a;\n  font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif;\n}\n\n.floating-circle.has-conflict .country-name {\n  color: white;\n  font-weight: 700;\n}\n\n@keyframes float {\n  0%,\n  100% {\n    transform: translateY(0px);\n  }\n  50% {\n    transform: translateY(-20px);\n  }\n}\n\n@media (max-width: 1024px) {\n  .floating-container {\n    min-height: 500px;\n    gap: 2rem;\n    padding: 2.5rem 1.5rem;\n  }\n\n  .floating-circle {\n    width: 110px;\n    height: 110px;\n  }\n\n  .country-name {\n    font-size: 0.9rem;\n  }\n}\n\n@media (max-width: 768px) {\n  .floating-container {\n    min-height: auto;\n    gap: 1.5rem;\n    padding: 2rem 1rem;\n  }\n\n  .floating-circle {\n    width: 100px;\n    height: 100px;\n    font-size: 0.85rem;\n  }\n\n  .country-name {\n    font-size: 0.85rem;\n  }\n}\n\n@media (max-width: 480px) {\n  .floating-container {\n    gap: 1.2rem;\n    padding: 1.5rem 1rem;\n  }\n\n  .floating-circle {\n    width: 90px;\n    height: 90px;\n  }\n\n  .country-name {\n    font-size: 0.8rem;\n    padding: 0.6rem;\n  }\n}\n\n/* Styles for the mobile list view */\n.country-dropdown-container {\n  width: 100%;\n  padding: 0 20px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 16px;\n}\n\n.select-instruction {\n  font-family: var(--font-serif, Georgia, serif);\n  font-style: italic;\n  color: #666;\n  margin: 0;\n  text-align: center;\n  font-size: 1rem;\n}\n\n/* Hide old list styles if present, add grid styles */\n.mobile-country-list {\n  display: none;\n}\n\n.mobile-country-grid {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 24px;\n  width: 100%;\n  max-width: 400px;\n  justify-items: center;\n  padding: 10px 0;\n}\n\n.mobile-country-circle {\n  width: 110px;\n  height: 110px;\n  border-radius: 50%;\n  background: #ffffff;\n  border: 1px solid #e0e0e0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  text-align: center;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);\n  cursor: pointer;\n  transition: transform 0.2s ease, box-shadow 0.2s ease;\n}\n\n.mobile-country-circle:active {\n  transform: scale(0.95);\n  background: #fcfcfc;\n}\n\n.mobile-country-circle.has-conflict {\n  border-color: #8b0000;\n  background: linear-gradient(145deg, #ffffff, #fffafa);\n}\n\n.country-name-mobile-circle {\n  font-family: var(--wiki-font-serif);\n  font-size: 14px;\n  font-weight: 600;\n  color: #333;\n  padding: 0 8px;\n  line-height: 1.2;\n}\n\n.simple-country-list {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n  border: 1px solid #ccc;\n  border-radius: 4px;\n  overflow: hidden;\n}\n\n.country-list-item {\n  background: white;\n  border: none;\n  border-bottom: 1px solid #eee;\n  padding: 1rem;\n  text-align: left;\n  font-size: 1.1rem;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  cursor: pointer;\n  transition: background 0.2s;\n}\n\n.country-list-item:last-child {\n  border-bottom: none;\n}\n\n.country-list-item:hover {\n  background: #f5f5f5;\n}\n\n.country-list-item .arrow {\n  color: var(--wiki-link);\n}\n\n/* New styles for the clean mobile list */\n\n/* New grid layout for mobile */\n\n.country-name-mobile {\n  font-family: var(--wiki-font-serif);\n  font-size: 1.2rem;\n  color: #222;\n  font-weight: 500;\n}\n\n.arrow-icon {\n  color: var(--wiki-red);\n  font-size: 1.5rem;\n  line-height: 1;\n  font-weight: 300;\n}\n","path":null,"size_bytes":4762,"size_tokens":null},"src/utils/dataLoader.js":{"content":"export async function loadJSON(lang = \"es\", countrySlug = \"palestine\", filename = \"description.json\") {\n  const base = `/data/${lang}/${countrySlug}/${filename}`\n  try {\n    const res = await fetch(base, { cache: \"no-store\" })\n    if (!res.ok) {\n      console.log(`[v0] File not found: ${base}, trying fallback language`)\n      if (lang !== \"es\") {\n        return loadJSON(\"es\", countrySlug, filename)\n      }\n      return null\n    }\n    const json = await res.json()\n    return json\n  } catch (err) {\n    console.error(\"Error loading JSON\", base, err)\n    if (lang !== \"es\") {\n      return loadJSON(\"es\", countrySlug, filename)\n    }\n    return null\n  }\n}\n\n// helpers para Ã­ndices concretos\nexport const loadDescription = (lang, slug) => loadJSON(lang, slug, \"description.json\")\nexport const loadTestimoniesIndex = (lang, slug) => loadJSON(lang, slug, \"testimonies.index.json\")\nexport const loadAnalystsIndex = (lang, slug) => loadJSON(lang, slug, \"analysts.index.json\")\nexport const loadGenocidesIndex = (lang, slug) => loadJSON(lang, slug, \"genocides.index.json\")\nexport const loadTerminologyLetters = (lang, slug) => loadJSON(lang, slug, \"terminology.index.json\")\n","path":null,"size_bytes":1169,"size_tokens":null},"src/layout/media-gallery.css":{"content":"/* Complete redesign for professional newspaper aesthetic */\n.media-gallery {\n  display: flex;\n  flex-direction: column;\n  gap: 24px;\n}\n\n.media-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); /* Wider cards */\n  gap: 20px;\n  padding: 16px 0;\n}\n\n.media-card {\n  cursor: pointer;\n  border-radius: 5px; /* Sharper corners for pro look */\n  overflow: hidden;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n  transition: all 0.2s ease;\n  background: #fff;\n  border: 1px solid #061b23;\n  display: flex;\n  flex-direction: column;\n}\n\n.media-card:hover {\n  transform: translateY(-6px);\n  box-shadow: 0 8px 20px rgba(139, 0, 0, 0.15);\n  border-color: #061b23;\n}\n\n.media-thumb {\n  width: 100%;\n  height: 140px;\n  object-fit: cover;\n}\n\n.media-title {\n  padding: 12px 16px;\n  font-size: 14px;\n  text-align: left;\n  color:#061b23;\n  font-family: var(--wiki-font-sans);\n  background: #fff;\n  border-top: 1px solid #eee;\n}\n\n.media-empty {\n  text-align: center;\n  padding: 60px 40px;\n  font-size: 16px;\n  color: #061b23;\n  font-style: italic;\n}\n\n/* Enhanced modal with smooth animations */\n.media-modal {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: #061b23;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 1000;\n  animation: fadeIn 0.3s ease;\n  backdrop-filter: blur(4px);\n}\n\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n.media-detail-content {\n  max-width: 90%;\n  max-height: 90vh;\n  text-align: center;\n  position: relative;\n  animation: slideUp 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);\n}\n\n@keyframes slideUp {\n  from {\n    opacity: 0;\n    transform: translateY(20px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n.media-full {\n  max-width: 100%;\n  max-height: 80vh;\n  border-radius: 8px;\n  box-shadow: 0 0 40px rgba(0, 0, 0, 0.3);\n}\n\n.media-detail-title {\n  color: #fff;\n  margin-top: 16px;\n  font-size: 16px;\n  font-weight: 500;\n  letter-spacing: 0.3px;\n}\n\n/* Improved control buttons */\n.media-close,\n.media-prev,\n.media-next {\n  position: absolute;\n  background: #061b23;\n  border: none;\n  color: #fff;\n  font-size: 28px;\n  cursor: pointer;\n  width: 48px;\n  height: 48px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s ease;\n  font-weight: 300;\n  z-index: 1001;\n}\n\n.media-close:hover,\n.media-prev:hover,\n.media-next:hover {\n  background: #061b23;\n  transform: scale(1.1);\n}\n\n.media-close {\n  top: 20px;\n  right: 20px;\n}\n\n.media-prev {\n  left: 20px;\n  top: 50%;\n  transform: translateY(-50%);\n}\n\n.media-next {\n  right: 20px;\n  top: 50%;\n  transform: translateY(-50%);\n}\n\n@media (max-width: 768px) {\n  .media-grid {\n    grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));\n    gap: 12px;\n  }\n\n  .media-thumb {\n    height: 110px;\n  }\n\n  .media-title {\n    padding: 10px;\n    font-size: 12px;\n  }\n\n  .media-detail-content {\n    max-width: 95%;\n    max-height: 85vh;\n  }\n\n  .media-full {\n    max-height: 70vh;\n  }\n\n  .media-close,\n  .media-prev,\n  .media-next {\n    width: 44px;\n    height: 44px;\n    font-size: 24px;\n  }\n}\n\n@media (max-width: 480px) {\n  .media-grid {\n    grid-template-columns: repeat(2, 1fr);\n    gap: 10px;\n  }\n\n  .media-thumb {\n    height: 100px;\n  }\n\n  .media-title {\n    padding: 8px;\n    font-size: 11px;\n  }\n\n  .media-close,\n  .media-prev,\n  .media-next {\n    width: 40px;\n    height: 40px;\n    font-size: 20px;\n  }\n\n  .media-close {\n    top: 12px;\n    right: 12px;\n  }\n\n  .media-prev {\n    left: 12px;\n  }\n\n  .media-next {\n    right: 12px;\n  }\n}\n","path":null,"size_bytes":3587,"size_tokens":null},"src/layout/CountryHeader.jsx":{"content":"\"use client\"\n\nimport { useState } from \"react\"\nimport { useLanguage } from \"../context/LanguageContext\"\nimport \"./country-header.css\"\n\nexport default function CountryHeader({ onHomeClick = () => {}, onSearch = () => {} }) {\n  const [open, setOpen] = useState(false)\n  const { lang, setLang, t } = useLanguage()\n  const [searchTerm, setSearchTerm] = useState(\"\")\n\n  // ðŸ”¥ Tus 4 idiomas con MAPAS/IMÃGENES (no emojis)\n  const LANGS = [\n    { code: \"eu\", img: \"/flags/eu.png\", alt: \"Euskara\" },\n    { code: \"es\", img: \"/flags/es.png\", alt: \"EspaÃ±ol\" },\n    { code: \"en\", img: \"/flags/en.png\", alt: \"English\" },\n    { code: \"ar\", img: \"/flags/ar.png\", alt: \"Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©\" },\n  ]\n\n  function toggleMenu() {\n    setOpen((v) => !v)\n  }\n\n  function changeLang(code) {\n    setLang(code)\n    setOpen(false)\n\n    if (code === \"ar\") {\n      document.body.style.fontFamily = \"'Amiri', serif\"\n      document.body.dir = \"rtl\"\n    } else {\n      document.body.style.fontFamily = \"'Cinzel', serif\"\n      document.body.dir = \"ltr\"\n    }\n\n    setTimeout(() => window.location.reload(), 100)\n  }\n\n  function handleLogoClick(e) {\n    if (e.type === \"click\" || (e.type === \"keydown\" && (e.key === \"Enter\" || e.key === \" \"))) {\n      e.preventDefault()\n      onHomeClick()\n    }\n  }\n\n  function handleSearchChange(e) {\n    const value = e.target.value\n    setSearchTerm(value)\n    onSearch(value)\n  }\n\n  return (\n    <header className=\"country-header\">\n      <div\n        className=\"header-left\"\n        onClick={handleLogoClick}\n        onKeyDown={handleLogoClick}\n        role=\"button\"\n        tabIndex={0}\n        style={{ cursor: \"pointer\" }}\n      >\n        <div className=\"header-logo\">\n          <span className=\"logo-wiki\">Wiki</span>\n          <span className=\"logo-conflicts\">conflicts</span>\n        </div>\n        <div className=\"header-quote\">La historia contada desde su presente</div>\n      </div>\n\n      <div className=\"header-center\">\n        <div className=\"search-wrapper\">\n          <input\n            className=\"header-search\"\n            type=\"search\"\n            placeholder={t(\"search-placeholder\")}\n            aria-label={t(\"search-placeholder\")}\n            value={searchTerm}\n            onChange={handleSearchChange}\n          />\n        </div>\n      </div>\n\n      <div className=\"header-right\">\n        <a\n          href=\"https://www.paypal.com/donate\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n          className=\"collaborate-button\"\n          aria-label={t(\"collaborate\")}\n        >\n          {t(\"collaborate\")}\n        </a>\n\n        <button\n          className=\"language-button-green\"\n          onClick={toggleMenu}\n          aria-expanded={open}\n          aria-haspopup=\"true\"\n          aria-label=\"Seleccionar idioma\"\n        >\n          Language\n        </button>\n\n        <div className={`language-dropdown ${open ? \"open\" : \"\"}`} role=\"menu\">\n          {LANGS.map((l) => (\n            <div\n              key={l.code}\n              className={`language-flag-circle ${lang === l.code ? \"active\" : \"\"}`}\n              onClick={() => changeLang(l.code)}\n              role=\"menuitem\"\n              title={l.alt}\n            >\n              <img src={l.img} alt={l.alt} />\n            </div>\n          ))}\n        </div>\n      </div>\n    </header>\n  )\n}\n","path":null,"size_bytes":3291,"size_tokens":null},"src/setupTests.js":{"content":"// jest-dom adds custom jest matchers for asserting on DOM nodes.\n// allows you to do things like:\n// expect(element).toHaveTextContent(/react/i)\n// learn more: https://github.com/testing-library/jest-dom\nimport '@testing-library/jest-dom';\n","path":null,"size_bytes":241,"size_tokens":null},"src/layout/country-content.css":{"content":"/* Complete redesign with professional newspaper aesthetic */\n.country-content {\n  padding: 0;\n  height: 100%;\n  overflow-y: auto;\n  background: #ffffff;\n}\n\n.content-inner {\n  padding: 10px 56px;\n  max-width: 1100px;\n  margin: 0 auto;\n}\n\n.content-loading {\n  text-align: center;\n  font-size: 16px;\n  padding: 80px 40px;\n  color: #999;\n  font-style: italic;\n}\n\n/* Modern section header styling */\n.section-header {\n  font-size: 2.5rem;\n  font-weight: 700;\n  margin-bottom: 40px;\n  color: #07202bff;\n  text-align: center;\nfont-family: Cormorant Garamond,serif;\n  letter-spacing: -0.5px;\n  border-bottom: 1px solid #949aa3;\n  padding-bottom: 20px;\n}\n\n/* Professional alphabet bar */\n.alphabet-bar {\n  display: flex;\n  justify-content: center;\n  gap: 8px;\n \n  flex-wrap: wrap;\n  \n}\n\n.alphabet-bar .letter {\n  font-size: 16px;\n  font-weight: 600;\n  padding: 8px 12px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  border-radius: 4px;\n  min-width: 28px;\n  text-align: center;\n}\n\n.alphabet-bar .letter.has-content {\n  color: #1a1a1a;\n  background: #fff;\n  border: 1px solid #d0d0d0;\n font-family: Cormorant Garamond,serif;\n  border-radius: 30px;\n}\n\n.alphabet-bar .letter.has-content:hover {\n  background: #061b23;\n  color: #fff;\n  border-color: #061b23;\n  transform: scale(1.08);\n}\n\n.alphabet-bar .letter.no-content {\n  color: #ddd;\n  font-weight: 400;\n  cursor: default;\n  /* background: transparent;\n  border: 1px solid #f0f0f0; */\n}\n\n.alphabet-bar .letter.active {\n  color: #fff;\n  background: #061b23;\n  border-color: #061b23;\n  font-weight: 700;\n  box-shadow: 0 4px 12px rgba(139, 0, 0, 0.2);\n}\n\n/* Modern grid layout for items */\n.items-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));\n  gap: 32px;\n  padding: 20px 0;\n}\n\n.item-card {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  cursor: pointer;\n  transition: all 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);\n  border-radius: 8px;\n  padding: 12px;\n}\n\n.item-card:hover {\n  transform: translateY(-10px);\n  /* background: #f8f8f8; */\n}\n\n.item-icon {\n  width: 100px;\n  height: 100px;\n  border-radius:50%;\n  overflow: hidden;\n  border: 2px solid #e0e0e0;\n  background: linear-gradient(135deg, #87ceeb 0%, #e0e0e0 100%);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-bottom: 16px;\n  transition: all 0.3s ease;\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);\n}\n\n.item-card:hover .item-icon {\n  border-color: #061b23;\n  box-shadow: 0 4px 12px rgba(139, 0, 0, 0.15);\n}\n\n.item-icon img {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n.item-name {\n  text-align: center;\n  font-size: 14px;\n  font-weight: 600;\n  color: #1a1a1a;\n  line-height: 1.4;\n  font-family: Cormorant Garamond,serif;\n  font-style: italic;\n}\n\n.item-category {\n  text-align: center;\n  font-size: 16px;\n  color: #061b23;\n  font-weight: 700;\n  margin-top: 8px;\n\n  letter-spacing: 1px;\n   font-family: Cormorant Garamond,serif;\n}\n\n/* Premium button styling */\n.back-button {\n  background: #fff;\n  border: 1px solid #d0d0d0;\n  padding: 12px 24px;\n  border-radius: 6px;\n  cursor: pointer;\n  font-size: 14px;\n  margin-bottom: 32px;\n  transition: all 0.2s ease;\n  font-weight: 500;\n  color: #1a1a1a;\n  display: inline-flex;\n  align-items: center;\n  gap: 8px;\n  \n}\n\n.back-button:hover {\n  background: #061b23;\n  color: #fff;\n  border-color: #061b23;\n  box-shadow: 0 4px 12px rgba(139, 0, 0, 0.15);\n}\n\n/* Professional article layout */\n.article-content {\n  max-width: 900px;\n  font-family: Georgia, \"Times New Roman\", serif;\n  line-height: 1.8;\n}\n\n.article-title {\n  font-size: 42px;\n  font-weight: 700;\n  margin-bottom: 20px;\n   color: #07202bff;\n  border-bottom: 1px solid #07202bff;\n  padding-bottom: 16px;\n  font-family: Cormorant Garamond,serif;\n  line-height: 1.2;\n  letter-spacing: -0.5px;\n}\n\n.article-body {\n  font-size: 18px;\n  color: #333;\n  line-height: 1.9;\n}\n\n.article-media {\n  float: right;\n  width: 380px;\n  max-width: 48%;\n  margin: 0 0 24px 32px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n  border-radius: 6px;\n  overflow: hidden;\n  border: 1px solid #e0e0e0;\n}\n\n.article-image,\n.article-video {\n  width: 100%;\n  height: auto;\n  display: block;\n}\n\n.article-text {\n  text-align: justify;\n  line-height: 1.9;\n}\n\n.article-text p {\n  margin-bottom: 20px;\n  text-indent: 0;\n  color: #07202bff;\n font-family: Cormorant Garamond, serif;\n  font-style: italic;\n}\n\n.article-text p:first-of-type::first-letter {\n  font-size: 4em;\n  font-weight: 700;\n  line-height: 0.8;\n  float: left;\n  margin: 0.1em 0.15em 0 0;\n  color: rgb(8, 74, 103);\n}\n\n/* Premium analyst header */\n.analyst-header {\n  display: flex;\n  gap: 32px;\n  align-items: flex-start;\n}\n\n.analyst-photo {\n  width: 160px;\n  height: 160px;\n  border-radius: 50%;\n  object-fit: cover;\n  border: 1px solid #061b23;\n  flex-shrink: 0;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n}\n\n.analyst-info {\n  flex: 1;\n}\n\n.analyst-name {\n  font-size: 36px;\n  font-weight: 700;\n  margin-bottom: 12px;\n  color: #1a1a1a;\nfont-family: Cormorant Garamond,serif;\n}\n\n.analyst-bio {\n  font-size: 16px;\n  line-height: 1.7;\n  color: #061b23;\n  font-family: Cormorant Garamond,serif;\n  font-style: italic;\n}\n\n.analyses-list-title {\n  font-size: 26px;\n  font-weight: 700;\n  margin-bottom: 28px;\n  color:#061b23;\n  border-top: 2px solid #e0e0e0;\n  padding-top: 24px;\n  font-family: Cormorant Garamond,serif;\n}\n\n.analyses-list {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n\n.analysis-card {\n  padding:0px 24px;\n\n border-bottom: 1px solid rgb(11, 40, 65);\n  cursor: pointer;\n  transition: all 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);\n  background: #fff;\n}\n\n.analysis-card:hover {\n  border-color: #2297c5;\n  /* background: #fafafa; */\n  /* box-shadow: 0 6px 16px rgba(139, 0, 0, 0.12); */\n  transform: translateY(-10px);\n}\n\n.analysis-title {\n  font-size: 20px;\n  font-weight: 700;\n  margin-bottom: 8px;\n  color: #061b23;\nfont-family: Georgia, \"Times New Roman\", serif;\n}\n\n.analysis-date {\n  font-size: 18px;\n  color: #061b23;\n  margin-bottom: 12px;\n  font-weight: 500;\n  \n  letter-spacing: 0.5px;\n  font-family: Cormorant Garamond,serif;\n  font-style: italic;\n}\n\n.analysis-summary {\n  font-size: 15px;\n  line-height: 1.7;\n  color: #061b23;\n  font-family: Cormorant Garamond,serif;\n  font-style: italic;\n}\n\n/* Timeline style for multiple testimonies/resistance entries */\n.analyses-list.timeline-style {\n  position: relative;\n  padding-left: 2.5rem;\n  margin-left: 1rem;\n}\n\n.analyses-list.timeline-style::before {\n  content: '';\n  position: absolute;\n  left: 0;\n  top: 0;\n  bottom: 0;\n  width: 3px;\n  background: linear-gradient(to bottom, #0c3344, #1d546b);\n  border-radius: 2px;\n}\n\n.analysis-card.timeline-card {\n  position: relative;\n  padding: 20px 24px;\n  border-bottom: none;\n  border-left: none;\n  background: #fff;\n  margin-bottom: 1.5rem;\n  border-radius: 0 8px 8px 0;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);\n}\n\n.analysis-card.timeline-card:hover {\n  transform: translateX(8px);\n  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);\n}\n\n.analysis-card.timeline-card .timeline-dot {\n  position: absolute;\n  left: -2.5rem;\n  top: 24px;\n  width: 14px;\n  height: 14px;\n  background: #0c3344;\n  border-radius: 50%;\n  border: 3px solid #fff;\n  box-shadow: 0 0 0 3px #0c3344;\n  transform: translateX(-50%);\n  z-index: 1;\n}\n\n.analysis-card.timeline-card .timeline-dot::after {\n  content: '';\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  width: 6px;\n  height: 6px;\n  background: #fff;\n  border-radius: 50%;\n  transform: translate(-50%, -50%);\n}\n\n.analysis-card-content {\n  flex: 1;\n}\n\n/* Improved search results info */\n.search-results-info {\n  padding: 16px 20px;\n  background: linear-gradient(135deg, #f8f8f8 0%, #f0f0f0 100%);\n \n  margin-bottom: 32px;\n  font-size: 14px;\n  color: #061b23;\n  border-radius: 30px;\n  font-weight: 500;\n  margin-top: 15px;\n}\n\n.no-results {\n  text-align: center;\n  padding: 60px 40px;\n  font-size: 16px;\n  color: #061b23;\n  font-style: italic;\n}\n\n/* Improved description wrapper with sticky menu */\n.description-wrapper {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  overflow: hidden;\n}\n\n.chapters-menu-sticky {\n  position: sticky;\n  top: 0;\n  /* background: linear-gradient(to bottom, #ffffff, #fafafa); */\n  z-index: 10;\n  /* border-bottom: 1px solid #07202bff; */\n  /* padding: 24px 56px 16px; */\n  /* box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05); */\n}\n\n/* New styles for hamburger menu navigation */\n.chapters-nav-container {\n  position: relative;\n  margin-top: 10px;\n}\n\n.chapters-hamburger-btn {\n  display: none;\n  width: 100%;\n  background: #f9f9f9;\n  border: 1px solid #ddd;\n  padding: 12px 16px;\n  text-align: left;\n  font-family: Georgia, \"Times New Roman\", serif;\n  font-size: 14px;\n  font-weight: 600;\n  color: #061b23;\n  cursor: pointer;\n  align-items: center;\n  gap: 10px;\n  border-radius: 4px;\n}\n\n.chapters-dropdown-menu {\n  position: absolute;\n  top: 100%;\n  left: 0;\n  width: 100%;\n  background: white;\n  border: 1px solid #ddd;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n  z-index: 50;\n  margin-top: 4px;\n  border-radius: 4px;\n  overflow: hidden;\n}\n\n.chapter-dropdown-item {\n  padding: 14px 20px;\n  border-bottom: 1px solid #f0f0f0;\n  cursor: pointer;\n  font-size: 14px;\n  color: #061b23;\n  background: #fff;\n}\n\n.chapter-dropdown-item:last-child {\n  border-bottom: none;\n}\n\n.chapter-dropdown-item.active {\n  background: #f0f0f0;\n  color: #061b23;\n  font-weight: 700;\n  border-left: 1px solid #061b23;\n}\n\n.section-header-inline {\n  font-size: 40px;\n  font-weight: 700;\n  margin-bottom: 20px;\n  color: #07202bff;\n  text-align: left;\n  font-family: Cormorant Garamond,serif;\n}\n\n.chapters-horizontal-menu {\n  display: flex;\n  /* gap: 12px; */\n  overflow-x: auto;\n  padding-bottom: 8px;\n  scrollbar-width: thin;\n  scrollbar-color: #07202bff #f0f0f0;\n}\n\n.chapters-horizontal-menu::-webkit-scrollbar {\n  height: 6px;\n}\n\n.chapters-horizontal-menu::-webkit-scrollbar-track {\n  background: #f0f0f0;\n  border-radius: 3px;\n}\n\n.chapters-horizontal-menu::-webkit-scrollbar-thumb {\n  background: #07202bff;\n  border-radius: 3px;\n}\n\n.chapter-tab {\n  padding: 10px 15px;\n  /* background: #fff;\n  border: 1px solid #d0d0d0;\n  border-radius: 6px; */\n  cursor: pointer;\n  font-size: 20px;\n  font-weight: 600;\n  color: #07202bff;\n  white-space: nowrap;\n  transition: all 0.2s ease;\n  flex-shrink: 0;\n  font-family: Cormorant Garamond,serif;\n}\n\n.chapter-tab:hover {\n  /* background: #fafafa;\n  border-color: #008b2e; */\n  color: #1a6483;\n  /* border-radius: 20px; */\n  border-bottom: 1px solid #07202bff;\n}\n\n.chapter-tab.active {\n  /* background: #008b41; */\n      background: #07202b;\n    color: #d9f2fc;\n    border-color: #07202bff;\n    font-weight: 600;\n    border-top: 1px solid #1a6483;\n    border-radius: 40px;\n    font-style: italic;\n}\n\n.chapter-content-scrollable {\n  flex: 1;\n  overflow-y: auto;\n  padding: 40px 56px;\n  scrollbar-width: none;\n}\n\n/* Responsive design improvements */\n@media (max-width: 1024px) {\n  .content-inner {\n    padding: 40px 40px;\n  }\n\n  .article-media {\n    float: none;\n    width: 100%;\n    max-width: 100%;\n    margin: 0 0 24px 0;\n  }\n\n  .chapters-menu-sticky {\n    padding: 20px 40px 12px;\n  }\n\n  .chapter-content-scrollable {\n    padding: 32px 40px;\n  }\n}\n\n@media (max-width: 768px) {\n  .content-inner {\n    padding: 24px 20px;\n  }\n\n  .section-header {\n    font-size: 26px;\n    margin-bottom: 24px;\n  }\n\n  .alphabet-bar {\n    gap: 6px;\n    padding: 16px 0;\n  }\n\n  .alphabet-bar .letter {\n    font-size: 14px;\n    padding: 6px 10px;\n  }\n\n  .items-grid {\n    grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));\n    gap: 20px;\n  }\n\n  .item-icon {\n    width: 80px;\n    height: 80px;\n  }\n\n  .article-title {\n    font-size: 28px;\n    margin-bottom: 16px;\n  }\n\n  .article-body {\n    font-size: 16px;\n  }\n\n  .analyst-header {\n    flex-direction: column;\n    gap: 20px;\n  }\n\n  .analyst-photo {\n    width: 120px;\n    height: 120px;\n  }\n\n  .chapters-menu-sticky {\n    padding: 16px 20px 10px;\n  }\n\n  /* Show hamburger, hide horizontal on mobile */\n  .chapters-hamburger-btn {\n    display: flex;\n  }\n\n  .chapters-horizontal-menu.desktop-only {\n    display: none;\n  }\n\n  .section-header-inline {\n    font-size: 20px;\n    margin-bottom: 12px;\n  }\n\n  .chapter-tab {\n    padding: 8px 14px;\n    font-size: 12px;\n  }\n\n  .chapter-content-scrollable {\n    padding: 20px;\n  }\n}\n\n@media (max-width: 480px) {\n  .content-inner {\n    padding: 16px 12px;\n  }\n\n  .section-header {\n    font-size: 22px;\n    margin-bottom: 16px;\n  }\n\n  .alphabet-bar {\n    gap: 4px;\n    padding: 12px 0;\n  }\n\n  .alphabet-bar .letter {\n    font-size: 12px;\n    padding: 5px 8px;\n    min-width: 24px;\n  }\n\n  .items-grid {\n    grid-template-columns: repeat(2, 1fr);\n    gap: 16px;\n  }\n\n  .item-card {\n    padding: 8px;\n  }\n\n  .item-icon {\n    width: 70px;\n    height: 70px;\n    margin-bottom: 8px;\n  }\n\n  .item-name {\n    font-size: 12px;\n  }\n\n  .back-button {\n    padding: 10px 16px;\n    font-size: 13px;\n  }\n\n  .article-title {\n    font-size: 22px;\n  }\n\n  .article-body {\n    font-size: 14px;\n  }\n}\n\n/* =====================================\n   FOTOTECA SECTION STYLES\n   ===================================== */\n.fototeca-container {\n  padding: 20px 40px;\n  max-width: 1200px;\n  margin: 0 auto;\n}\n\n.fototeca-header {\n  text-align: center;\n  margin-bottom: 40px;\n  padding-bottom: 20px;\n  border-bottom: 1px solid #e0e0e0;\n}\n\n.fototeca-header h2 {\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 2.5rem;\n  font-weight: 700;\n  color: #0c3344;\n  margin-bottom: 8px;\n}\n\n.fototeca-header p {\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 1.1rem;\n  color: #666;\n  font-style: italic;\n}\n\n.fototeca-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));\n  gap: 24px;\n}\n\n.fototeca-item {\n  background: #fff;\n  border-radius: 8px;\n  overflow: hidden;\n  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);\n  cursor: pointer;\n  transition: all 0.3s ease;\n}\n\n.fototeca-item:hover {\n  transform: translateY(-4px);\n  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);\n}\n\n.fototeca-media {\n  position: relative;\n  aspect-ratio: 16/10;\n  overflow: hidden;\n  background: #f0f0f0;\n}\n\n.fototeca-media img,\n.fototeca-media video {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n.fototeca-video-thumb {\n  position: relative;\n  width: 100%;\n  height: 100%;\n}\n\n.fototeca-video-thumb video {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n.play-overlay {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  width: 60px;\n  height: 60px;\n  background: rgba(139, 0, 0, 0.9);\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  font-size: 24px;\n  transition: all 0.2s ease;\n}\n\n.fototeca-item:hover .play-overlay {\n  transform: translate(-50%, -50%) scale(1.1);\n  background: rgba(139, 0, 0, 1);\n}\n\n.fototeca-info {\n  padding: 16px;\n}\n\n.fototeca-date {\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 0.85rem;\n  color: #8b0000;\n  font-weight: 600;\n  display: block;\n  margin-bottom: 6px;\n}\n\n.fototeca-title {\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 1.1rem;\n  font-weight: 600;\n  color: #0c3344;\n  line-height: 1.3;\n  margin: 0;\n}\n\n/* Fototeca Detail View */\n.fototeca-detail {\n  max-width: 900px;\n  margin: 0 auto;\n}\n\n.fototeca-detail-media {\n  width: 100%;\n  border-radius: 8px;\n  overflow: hidden;\n  margin-bottom: 24px;\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.12);\n}\n\n.fototeca-detail-media img,\n.fototeca-detail-media video {\n  width: 100%;\n  display: block;\n}\n\n.fototeca-detail-info {\n  text-align: center;\n  padding: 0 20px;\n}\n\n.fototeca-detail-date {\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 1rem;\n  color: #8b0000;\n  font-weight: 600;\n  display: block;\n  margin-bottom: 12px;\n}\n\n.fototeca-detail-title {\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 2rem;\n  font-weight: 700;\n  color: #0c3344;\n  margin: 0 0 16px 0;\n  line-height: 1.3;\n}\n\n.fototeca-detail-description {\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 1.15rem;\n  color: #444;\n  line-height: 1.7;\n  max-width: 700px;\n  margin: 0 auto;\n}\n\n@media (max-width: 768px) {\n  .fototeca-container {\n    padding: 16px;\n  }\n\n  .fototeca-header h2 {\n    font-size: 1.8rem;\n  }\n\n  .fototeca-grid {\n    grid-template-columns: 1fr;\n    gap: 16px;\n  }\n\n  .fototeca-detail-title {\n    font-size: 1.5rem;\n  }\n\n  .fototeca-detail-description {\n    font-size: 1rem;\n  }\n}\n\n/* =====================================\n   ARABIC RTL SUPPORT & AMIRI FONT\n   ===================================== */\n\n/* RTL Container */\n[dir=\"rtl\"] .content-inner,\n.content-rtl,\n.article-text-rtl {\n  direction: rtl;\n  text-align: right;\n}\n\n/* Arabic-specific font family */\n.text-arabic,\n.arabic-text,\n[lang=\"ar\"],\n[dir=\"rtl\"] .article-text,\n[dir=\"rtl\"] .article-title,\n[dir=\"rtl\"] .section-header {\n  font-family: 'Amiri', Georgia, serif;\n}\n\n/* RTL adjustments for article layout */\n[dir=\"rtl\"] .article-media {\n  float: left;\n  margin: 0 32px 24px 0;\n}\n\n[dir=\"rtl\"] .article-text {\n  text-align: justify;\n}\n\n/* RTL drop cap - float to the right */\n[dir=\"rtl\"] .article-text p:first-of-type::first-letter {\n  float: right;\n  margin: 0.1em 0 0 0.15em;\n}\n\n/* RTL adjustments for lists and navigation */\n[dir=\"rtl\"] .analyses-list.timeline-style {\n  padding-left: 0;\n  padding-right: 2.5rem;\n  margin-left: 0;\n  margin-right: 1rem;\n}\n\n[dir=\"rtl\"] .analyses-list.timeline-style::before {\n  left: auto;\n  right: 0;\n}\n\n[dir=\"rtl\"] .analysis-card.timeline-card .timeline-dot {\n  left: auto;\n  right: -2.5rem;\n  transform: translateX(50%);\n}\n\n/* RTL back button */\n[dir=\"rtl\"] .back-button {\n  flex-direction: row-reverse;\n}\n\n/* Arabic Typography with Amiri */\n.amiri-font {\n  font-family: 'Amiri', Georgia, serif;\n  line-height: 1.9;\n}\n\n.amiri-font.italic {\n  font-style: italic;\n}\n\n/* Arabic specific article text styling */\n.article-text-arabic {\n  font-family: 'Amiri', Georgia, serif;\n  direction: rtl;\n  text-align: justify;\n  line-height: 2;\n  font-size: 1.1em;\n}\n\n.article-text-arabic p:first-of-type::first-letter {\n  font-size: 4em;\n  font-weight: 700;\n  line-height: 0.8;\n  float: right;\n  margin: 0.1em 0 0 0.15em;\n  color: rgb(8, 74, 103);\n}\n\n/* Arabic section headers */\n.section-header-arabic {\n  font-family: 'Amiri', Georgia, serif;\n  direction: rtl;\n  text-align: center;\n}\n\n/* =====================================\n   DROP CAP STYLING ENHANCEMENT\n   ===================================== */\n\n/* Default drop cap styling - applied to first paragraph */\n.drop-cap-text p:first-of-type::first-letter,\n.article-text p:first-of-type::first-letter {\n  font-size: 4em;\n  font-weight: 700;\n  line-height: 0.8;\n  float: left;\n  margin: 0.1em 0.15em 0 0;\n  color: rgb(8, 74, 103);\n  font-family: 'Cormorant Garamond', Georgia, serif;\n}\n\n/* For Arabic/RTL text, drop cap floats right */\n.drop-cap-text[dir=\"rtl\"] p:first-of-type::first-letter,\n.article-text-arabic p:first-of-type::first-letter {\n  float: right;\n  margin: 0.1em 0 0 0.15em;\n}\n\n/* =====================================\n   MEDIA GALLERY FOR TESTIMONIES/RESISTANCE\n   ===================================== */\n\n.entry-media-gallery {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n  gap: 16px;\n  margin: 24px 0;\n}\n\n.entry-media-item {\n  position: relative;\n  border-radius: 8px;\n  overflow: hidden;\n  background: #f0f0f0;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);\n  cursor: pointer;\n  transition: all 0.3s ease;\n}\n\n.entry-media-item:hover {\n  transform: translateY(-4px);\n  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);\n}\n\n.entry-media-item img,\n.entry-media-item video {\n  width: 100%;\n  aspect-ratio: 16/10;\n  object-fit: cover;\n  display: block;\n}\n\n.entry-media-item audio {\n  width: 100%;\n  padding: 12px;\n  background: linear-gradient(135deg, #0c3344 0%, #1d546b 100%);\n}\n\n.entry-media-caption {\n  padding: 8px 12px;\n  background: rgba(0, 0, 0, 0.7);\n  color: white;\n  font-size: 0.85rem;\n  font-family: 'Cormorant Garamond', serif;\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n}\n\n.entry-media-type {\n  position: absolute;\n  top: 8px;\n  right: 8px;\n  background: rgba(0, 0, 0, 0.6);\n  color: white;\n  padding: 4px 8px;\n  border-radius: 4px;\n  font-size: 12px;\n}\n\n/* Audio player specific styling */\n.audio-player-container {\n  background: linear-gradient(135deg, #0c3344 0%, #1d546b 100%);\n  padding: 20px;\n  border-radius: 8px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 12px;\n}\n\n.audio-player-container audio {\n  width: 100%;\n  height: 40px;\n}\n\n.audio-player-label {\n  color: white;\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 1rem;\n  text-align: center;\n}\n\n/* Lightbox for media viewing */\n.media-lightbox {\n  position: fixed;\n  inset: 0;\n  background: rgba(0, 0, 0, 0.9);\n  z-index: 1000;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 20px;\n}\n\n.media-lightbox-close {\n  position: absolute;\n  top: 20px;\n  right: 20px;\n  background: transparent;\n  border: none;\n  color: white;\n  font-size: 32px;\n  cursor: pointer;\n  z-index: 1001;\n}\n\n.media-lightbox-content {\n  max-width: 90%;\n  max-height: 90%;\n}\n\n.media-lightbox-content img,\n.media-lightbox-content video {\n  max-width: 100%;\n  max-height: 80vh;\n  border-radius: 8px;\n}\n\n@media (max-width: 768px) {\n  .entry-media-gallery {\n    grid-template-columns: 1fr;\n  }\n\n  [dir=\"rtl\"] .article-media {\n    float: none;\n    margin: 0 0 24px 0;\n    width: 100%;\n    max-width: 100%;\n  }\n}\n\n/* VELUM Section Styles */\n.velum-section {\n  background: linear-gradient(135deg, #fafbfc 0%, #f0f2f5 100%);\n  min-height: 100vh;\n}\n\n.velum-header {\n  text-align: center;\n  padding: 40px 0 30px;\n  border-bottom: 2px solid #1a6483;\n  margin-bottom: 40px;\n}\n\n.velum-header h2 {\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 2.5rem;\n  font-weight: 700;\n  color: #1a6483;\n  margin-bottom: 10px;\n  letter-spacing: 3px;\n}\n\n.velum-subtitle {\n  font-family: Georgia, serif;\n  font-size: 1rem;\n  color: #666;\n  font-style: italic;\n}\n\n.velum-empty {\n  text-align: center;\n  padding: 60px 20px;\n  color: #888;\n  font-style: italic;\n}\n\n.velum-articles-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));\n  gap: 30px;\n  padding: 0 10px;\n}\n\n.velum-article-card {\n  background: white;\n  border-radius: 8px;\n  padding: 28px;\n  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);\n  cursor: pointer;\n  transition: all 0.3s ease;\n  border-left: 4px solid #1a6483;\n}\n\n.velum-article-card:hover {\n  transform: translateY(-4px);\n  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);\n}\n\n.velum-card-meta {\n  display: flex;\n  gap: 12px;\n  margin-bottom: 12px;\n  font-size: 0.85rem;\n}\n\n.velum-card-date {\n  color: #1a6483;\n  font-weight: 600;\n}\n\n.velum-card-author {\n  color: #666;\n}\n\n.velum-card-title {\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 1.4rem;\n  font-weight: 600;\n  color: #1a1a1a;\n  margin-bottom: 12px;\n  line-height: 1.3;\n}\n\n.velum-card-abstract {\n  font-size: 0.95rem;\n  color: #444;\n  line-height: 1.6;\n  margin-bottom: 16px;\n}\n\n.velum-card-keywords {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 8px;\n}\n\n.velum-keyword-tag {\n  background: #e8f4f8;\n  color: #1a6483;\n  font-size: 0.75rem;\n  padding: 4px 10px;\n  border-radius: 12px;\n  font-weight: 500;\n}\n\n/* VELUM Article Detail View */\n.velum-article-view {\n  background: white;\n}\n\n.velum-full-article {\n  max-width: 800px;\n  margin: 0 auto;\n  padding: 40px 20px;\n}\n\n.velum-article-header {\n  margin-bottom: 40px;\n  padding-bottom: 30px;\n  border-bottom: 1px solid #e0e0e0;\n}\n\n.velum-article-title {\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 2.5rem;\n  font-weight: 700;\n  color: #1a1a1a;\n  margin-bottom: 24px;\n  line-height: 1.2;\n}\n\n.velum-article-meta {\n  display: flex;\n  align-items: center;\n  gap: 16px;\n  margin-bottom: 20px;\n}\n\n.velum-author-image {\n  width: 60px;\n  height: 60px;\n  border-radius: 50%;\n  object-fit: cover;\n  border: 3px solid #1a6483;\n}\n\n.velum-meta-text {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n}\n\n.velum-author-name {\n  font-weight: 600;\n  color: #1a1a1a;\n  font-size: 1.1rem;\n}\n\n.velum-article-date {\n  color: #666;\n  font-size: 0.9rem;\n}\n\n.velum-article-keywords {\n  display: flex;\n  flex-wrap: wrap;\n  align-items: center;\n  gap: 10px;\n}\n\n.velum-keywords-label {\n  font-weight: 600;\n  color: #444;\n  font-size: 0.9rem;\n}\n\n.velum-keyword-pill {\n  background: #1a6483;\n  color: white;\n  font-size: 0.8rem;\n  padding: 4px 12px;\n  border-radius: 16px;\n}\n\n.velum-abstract-section {\n  background: #f8f9fa;\n  padding: 24px;\n  border-radius: 8px;\n  margin-bottom: 40px;\n  border-left: 4px solid #1a6483;\n}\n\n.velum-abstract-section h2 {\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 1.3rem;\n  color: #1a6483;\n  margin-bottom: 12px;\n}\n\n.velum-abstract-text {\n  font-size: 1rem;\n  line-height: 1.8;\n  color: #333;\n  font-style: italic;\n}\n\n.velum-content-sections {\n  margin-bottom: 40px;\n}\n\n.velum-section-block {\n  margin-bottom: 32px;\n}\n\n.velum-section-title {\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 1.5rem;\n  font-weight: 600;\n  color: #1a6483;\n  margin-bottom: 16px;\n  padding-bottom: 8px;\n  border-bottom: 1px solid #e0e0e0;\n}\n\n.velum-section-content {\n  font-size: 1.05rem;\n  line-height: 1.8;\n  color: #333;\n}\n\n.velum-section-content p {\n  margin-bottom: 16px;\n  text-align: justify;\n}\n\n.velum-section-content p:first-of-type::first-letter {\n  font-size: 3em;\n  float: left;\n  line-height: 1;\n  margin-right: 10px;\n  font-family: 'Cormorant Garamond', serif;\n  font-weight: bold;\n  color: #1a6483;\n}\n\n.velum-bibliography {\n  background: #f8f9fa;\n  padding: 24px;\n  border-radius: 8px;\n  border-top: 2px solid #1a6483;\n}\n\n.velum-bibliography h2 {\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 1.3rem;\n  color: #1a6483;\n  margin-bottom: 16px;\n}\n\n.velum-bibliography-list {\n  list-style: none;\n  padding: 0;\n  margin: 0;\n}\n\n.velum-bibliography-list li {\n  padding: 8px 0;\n  border-bottom: 1px solid #e0e0e0;\n  font-size: 0.95rem;\n  color: #444;\n  line-height: 1.5;\n}\n\n.velum-bibliography-list li:last-child {\n  border-bottom: none;\n}\n\n@media (max-width: 768px) {\n  .velum-articles-grid {\n    grid-template-columns: 1fr;\n  }\n\n  .velum-article-title {\n    font-size: 1.8rem;\n  }\n\n  .velum-header h2 {\n    font-size: 2rem;\n  }\n}\n","path":null,"size_bytes":26223,"size_tokens":null},"src/App.test.js":{"content":"import { render, screen } from '@testing-library/react';\nimport App from './App';\n\ntest('renders learn react link', () => {\n  render(<App />);\n  const linkElement = screen.getByText(/learn react/i);\n  expect(linkElement).toBeInTheDocument();\n});\n","path":null,"size_bytes":246,"size_tokens":null},"src/layout/country-layout.css":{"content":"/* Improved layout for better responsive behavior and no-scroll on home */\n.country-layout {\n  display: flex;\n  flex-direction: column;\n  height: 100vh;\n  background: #ffffff;\n  overflow: hidden;\n}\n\n.country-body {\n  display: flex;\n  flex: 1;\n  height: calc(100vh - 68px);\n  overflow: hidden;\n}\n\n.country-sidebar {\n  flex-shrink: 0;\n}\n\n.country-content-wrapper {\n  flex: 1;\n  overflow-y: auto;\n  background: #ffffff;\n  scrollbar-width: none;\n}\n\n/* Footer styling */\n.country-footer {\n  padding: 24px 32px;\n  text-align: center;\n  font-size: 12px;\n  background: #0c1e28;\n  color: #a0b0b8;\n  border-top: 1px solid #1d3a4a;\n  font-weight: 500;\n  letter-spacing: 0.5px;\n  font-family: Cormorant Garamond, serif;\n  font-style: italic;\n}\n\n.footer-social {\n  display: flex;\n  justify-content: center;\n  gap: 20px;\n  margin-bottom: 16px;\n}\n\n.social-icon {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n  background: rgba(255, 255, 255, 0.1);\n  color: #a0b0b8;\n  transition: all 0.2s ease;\n}\n\n.social-icon:hover {\n  background: rgba(255, 255, 255, 0.2);\n  color: #fff;\n  transform: translateY(-2px);\n}\n\n.footer-line {\n  height: 1px;\n  background: #e0e0e0;\n  margin-bottom: 12px;\n  display: none;\n}\n\n.country-loading {\n  padding: 60px 40px;\n  text-align: center;\n  font-size: 16px;\n  color: #999;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  min-height: 400px;\n  font-style: italic;\n}\n\n/* Responsive: Tablet view */\n@media (max-width: 1024px) {\n  .country-body {\n    height: calc(100vh - 68px);\n  }\n}\n\n/* Responsive: Mobile - stack vertically */\n@media (max-width: 860px) {\n  .country-body {\n    flex-direction: column;\n  }\n\n  .country-sidebar {\n    display: none;\n  }\n\n  .country-content-wrapper {\n    flex: 1;\n    order: -1;\n  }\n}\n\n/* Responsive: Small mobile */\n@media (max-width: 480px) {\n  .country-layout {\n    height: 100vh;\n     display: flex;\n  flex-direction: column-reverse;\n  }\n\n  .country-loading {\n    padding: 40px 20px;\n    font-size: 14px;\n  }\n}\n\n/* Refined mobile header for Wikipedia aesthetic */\n.mobile-wiki-header {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 1rem 1rem;\n  background: #fff;\n  border-bottom: 1px solid #ccc;\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.03);\n  position: sticky;\n  top: 0;\n  z-index: 100;\n}\n\n/* Added mobile header top container for logo and menu button side by side */\n.mobile-header-top {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  width: 100%;\n  margin-bottom: 0.75rem;\n}\n\n.mobile-logo-large {\n  font-size: 1.8rem;\n  cursor: pointer;\n  flex: 1;\n  text-align: left;\n}\n\n/* Added mobile search bar styles for country pages */\n.mobile-search-bar {\n  width: 100%;\n  padding: 0.5rem 0;\n  margin-bottom: 0.75rem;\n}\n\n.mobile-search-input {\n  width: 100%;\n  padding: 10px 16px;\n  border: 1px solid #ccc;\n  border-radius: 20px;\n  font-size: 14px;\n  outline: none;\n  background: #f8f8f8;\n  transition: border-color 0.2s, box-shadow 0.2s;\n  font-family: inherit;\n}\n\n.mobile-search-input:focus {\n  border-color: #8b0000;\n  box-shadow: 0 0 0 3px rgba(139, 0, 0, 0.1);\n  background: #fff;\n}\n\n.mobile-search-input::placeholder {\n  color: #999;\n}\n/* </CHANGE> */\n\n.logo-wiki {\n  color: #333;\n}\n\n.logo-conflicts {\n  color: #d32f2f;\n}\n\n.mobile-country-title {\n  font-size: 1.6rem;\n  margin: 0;\n  text-align: center;\n  color: var(--wiki-black);\n  font-family: var(--wiki-font-serif);\n  border-bottom: 1px solid #a2a9b1;\n  padding-bottom: 0.5rem;\n  width: 100%;\n}\n\n.mobile-menu-toggle {\n  background: none;\n  border: none;\n  cursor: pointer;\n  padding: 10px;\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.hamburger-line {\n  width: 30px;\n  height: 3px;\n  background-color: #333;\n  border-radius: 2px;\n}\n\n.mobile-content-padding {\n  padding: 1rem;\n}\n\n/* Styling the mobile header specific elements */\n.mobile-menu-toggle-btn {\n  background: transparent;\n  border: 1px solid #a2a9b1;\n  border-radius: 2px;\n  padding: 8px 16px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  transition: background 0.2s;\n  flex-shrink: 0;\n}\n\n.mobile-menu-toggle-btn:active {\n  background: #f0f0f0;\n}\n\n.hamburger-box {\n  width: 16px;\n  height: 12px;\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n}\n\n.hamburger-box::before,\n.hamburger-box::after,\n.hamburger-inner {\n  content: \"\";\n  display: block;\n  width: 100%;\n  height: 2px;\n  background: #000;\n}\n\n.menu-label {\n  font-size: 0.9rem;\n  font-weight: bold;\n  text-transform: uppercase;\n  letter-spacing: 1px;\n  color: #444;\n}\n\n/* Wiki styling tweaks */\n.logo-wiki {\n  \n    font-family: Cormorant Garamond, serif;\n    font-style: italic;\n    font-weight: 100;\n  color: #ddf5ffd0;\n    background:  #061b23;\n    padding: 10px;\n    border-radius: 50%;\n\n}\n.logo-conflicts {\n  font-family: Cormorant Garamond,serif;\n \n  font-weight: 900;\n    color: #0c3344;\n}\n\n.menu-icon {\n  font-size: 1.2rem;\n  line-height: 1;\n}\n","path":null,"size_bytes":5013,"size_tokens":null},"src/index.css":{"content":"/* Google Fonts Import */\n@import url('https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&family=Bonheur+Royale&display=swap');\n\n/* CSS Variables for consistent typography */\n:root {\n  --font-serif: 'Cormorant Garamond', Georgia, serif;\n  --font-script: 'Bonheur Royale', cursive;\n  --color-primary: #0c3344;\n  --color-secondary: #1d546b;\n  --color-accent: #8b0000;\n}\n\n/* Enhanced global styles with professional color scheme */\n* {\n  margin: 0;\n  padding: 0;\n  box-sizing: border-box;\n}\n\nhtml {\n  scroll-behavior: smooth;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\nbody {\n  margin: 0;\n  font-family: var(--font-serif);\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  background: #ffffff;\n  color: #1a1a1a;\n}\n\ncode {\n  font-family: source-code-pro, Menlo, Monaco, Consolas, \"Courier New\", monospace;\n}\n\n/* Focus visible styles for accessibility */\n*:focus-visible {\n  outline: 2px solid #8b0000;\n  outline-offset: 2px;\n}\n\nbutton:focus-visible,\na:focus-visible,\ninput:focus-visible {\n  outline: 2px solid #8b0000;\n  outline-offset: 2px;\n}\n\n/* Smooth transitions for all interactive elements */\nbutton,\na,\ninput,\nselect,\ntextarea {\n  transition: all 0.2s ease;\n}\n\n/* Custom scrollbar styling */\n::-webkit-scrollbar {\n  width: 8px;\n  height: 8px;\n}\n\n::-webkit-scrollbar-track {\n  background: #f0f0f0;\n}\n\n::-webkit-scrollbar-thumb {\n  background: #8b0000;\n  border-radius: 4px;\n}\n\n::-webkit-scrollbar-thumb:hover {\n  background: #6b0000;\n}\n","path":null,"size_bytes":1583,"size_tokens":null},"src/App.js":{"content":"import { BrowserRouter, Routes, Route, Navigate } from \"react-router-dom\"\nimport Home from \"./pages/Home\"\nimport CountryLayout from \"./layout/CountryLayout\"\nimport { AuthProvider, useAuth } from \"./context/AuthContext\"\nimport AdminLogin from \"./admin/AdminLogin\"\nimport AdminDashboard from \"./admin/AdminDashboard\"\nimport AdminCountry from \"./admin/AdminCountry\"\nimport AdminUsers from \"./admin/AdminUsers\"\nimport AdminPending from \"./admin/AdminPending\"\nimport \"./App.css\"\n\nfunction ProtectedRoute({ children }) {\n  const { user, loading } = useAuth()\n  \n  if (loading) {\n    return <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', minHeight: '100vh' }}>Cargando...</div>\n  }\n  \n  if (!user) {\n    return <Navigate to=\"/admin/login\" replace />\n  }\n  \n  return children\n}\n\nfunction App() {\n  return (\n    <AuthProvider>\n      <BrowserRouter>\n        <Routes>\n          <Route path=\"/\" element={<Home />} />\n          <Route path=\"/country/:code\" element={<CountryLayout />} />\n          <Route path=\"/admin/login\" element={<AdminLogin />} />\n          <Route path=\"/admin\" element={\n            <ProtectedRoute>\n              <AdminDashboard />\n            </ProtectedRoute>\n          } />\n          <Route path=\"/admin/country/:countryCode\" element={\n            <ProtectedRoute>\n              <AdminCountry />\n            </ProtectedRoute>\n          } />\n          <Route path=\"/admin/users\" element={\n            <ProtectedRoute>\n              <AdminUsers />\n            </ProtectedRoute>\n          } />\n          <Route path=\"/admin/pending\" element={\n            <ProtectedRoute>\n              <AdminPending />\n            </ProtectedRoute>\n          } />\n        </Routes>\n      </BrowserRouter>\n    </AuthProvider>\n  )\n}\n\nexport default App\n","path":null,"size_bytes":1778,"size_tokens":null},"src/layout/country-header.css":{"content":"/* ======================================\n   HEADER STYLING - PROFESSIONAL NEWSPAPER\n   ====================================== */\n\n/* === MAIN HEADER CONTAINER === */\n.country-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 16px 24px;\n  gap: 20px;\n  position: sticky;\n  top: 0;\n  z-index: 100;\n}\n\n/* === LEFT SECTION: LOGO + QUOTE === */\n.header-left {\n  display: flex;\n  flex-direction: column;\n  cursor: pointer;\n  user-select: none;\n  outline: none;\n  flex-shrink: 0;\n}\n\n.header-left:focus {\n  box-shadow: 0 0 0 3px rgba(139, 0, 0, 0.08);\n  border-radius: 6px;\n}\n\n.header-logo {\n  display: flex;\n  align-items: baseline;\n  gap: 1px;\n}\n\n.logo-wiki {\n  font-family: 'Cormorant Garamond', Georgia, serif;\n  font-weight: 300;\n  font-style: italic;\n  font-size: 22px;\n  color: #1d546b;\n  letter-spacing: 0.5px;\n}\n\n.logo-conflicts {\n  font-family: 'Cormorant Garamond', Georgia, serif;\n  font-weight: 700;\n  font-size: 22px;\n  color: #0c3344;\n}\n\n.header-quote {\n  font-size: 20px;\n  color: #1a6483;\n  font-weight: 500;\n  letter-spacing: 0.3px;\n  font-family: Bonheur Royale;\n}\n\n/* === CENTER SECTION: SEARCH === */\n.header-center {\n  flex: 1;\n  display: flex;\n  justify-content: center;\n}\n\n.search-wrapper {\n  width: 100%;\n  max-width: 520px;\n  display: flex;\n  justify-content: center;\n}\n\n.header-search {\n  width: 100%;\n  max-width: 480px;\n  padding: 10px 18px;\n  border-radius: 24px;\n  border: 1px solid #ddd;\n  outline: none;\n  font-size: 14px;\n  background: #f8f8f8;\n  transition: box-shadow 0.18s, border-color 0.18s, background 0.18s;\n  font-family: Cormorant Garamond, serif;\n}\n\n.header-search:focus {\n  border-color: #8b0000;\n  background: #fff;\n  box-shadow: 0 4px 12px rgba(139, 0, 0, 0.08);\n}\n\n.header-search::placeholder {\n  color: #999;\n}\n\n/* === RIGHT SECTION: LANGUAGE SELECTOR === */\n.header-right {\n  position: relative;\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  flex-shrink: 0;\n}\n\n/* -------- RED LANGUAGE SELECTOR -------- */\n.lang-toggle {\n  width: 42px;\n  height: 42px;\n  border-radius: 50%;\n  border: none;\n  background: #8b0000;\n  color: #fff;\n  font-size: 18px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s ease;\n  box-shadow: 0 2px 6px rgba(139, 0, 0, 0.15);\n}\n\n.lang-toggle:hover {\n  transform: scale(1.05);\n  box-shadow: 0 4px 10px rgba(139, 0, 0, 0.2);\n}\n\n.lang-toggle:active {\n  transform: scale(0.98);\n}\n\n.lang-toggle:focus {\n  outline: 2px solid #8b0000;\n  outline-offset: 2px;\n}\n\n.lang-menu {\n  position: absolute;\n  top: calc(100% + 12px);\n  right: 0;\n  background: white;\n  padding: 12px;\n  border-radius: 12px;\n  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  opacity: 0;\n  transform: scale(0.92) translateY(-8px);\n  pointer-events: none;\n  transition: all 0.22s cubic-bezier(0.2, 0.9, 0.3, 1);\n  will-change: transform, opacity;\n  min-width: 180px;\n}\n\n.lang-menu.open {\n  opacity: 1;\n  transform: scale(1) translateY(0);\n  pointer-events: auto;\n}\n\n.lang-option {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  width: 100%;\n  padding: 10px 14px;\n  border-radius: 8px;\n  border: 1px solid #e0e0e0;\n  background: #fff;\n  cursor: pointer;\n  font-size: 14px;\n  transition: all 0.14s ease;\n  color: #333;\n  font-weight: 500;\n}\n\n.lang-option:hover {\n  background: #f8f8f8;\n  border-color: #8b0000;\n  color: #8b0000;\n  transform: translateX(4px);\n}\n\n.lang-option.active {\n  background: #8b0000;\n  border-color: #8b0000;\n  color: #fff;\n  font-weight: 600;\n  box-shadow: 0 4px 12px rgba(139, 0, 0, 0.2);\n}\n\n.flag-emoji {\n  font-size: 20px;\n  line-height: 1;\n}\n\n.lang-label {\n  flex: 1;\n  text-align: left;\n}\n\n/* -------- COLLABORATE BUTTON -------- */\n.collaborate-button {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  border: none;\n  border-radius: 9999px;\n  padding: 0.6rem 1.3rem;\n  background: linear-gradient(to right, #8b0000, #a02020);\n  color: white;\n  font-family: 'Cormorant Garamond', serif;\n  font-weight: 700;\n  font-size: 0.95rem;\n  letter-spacing: 0.5px;\n  cursor: pointer;\n  transition: all 0.2s ease-in-out;\n  box-shadow: 0 4px 6px rgba(139, 0, 0, 0.2);\n  text-decoration: none;\n}\n\n.collaborate-button:hover {\n  transform: scale(1.05);\n  box-shadow: 0 6px 12px rgba(139, 0, 0, 0.3);\n}\n\n/* -------- GREEN LANGUAGE SELECTOR -------- */\n.language-button-green {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  border: none;\n  border-radius: 9999px;\n  padding: 0.6rem 1.3rem;\n  background: linear-gradient(to right, #061b23, #0d394a);\n  color: white;\n  font-family: 'Cormorant Garamond', serif;\n  font-weight: 700;\n  font-size: 0.95rem;\n  letter-spacing: 0.5px;\n  cursor: pointer;\n  transition: all 0.2s ease-in-out;\n  box-shadow: 0 4px 6px rgba(0,0,0,0.1);\n}\n\n.language-button-green:hover {\n  transform: scale(1.05);\n}\n\n.language-dropdown {\n  display: none;\n  position: absolute;\n  top: calc(100% + 12px);\n  right: 0;\n  background: white;\n  padding: 12px;\n  border-radius: 12px;\n  flex-direction: row;\n  gap: 12px;\n  /* box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15); */\n  z-index: 2000;\n}\n\n.language-dropdown.open {\n  display: flex;\n      flex-direction: column;\n      scale: 0.9;\n      margin-top: -20px;\n}\n\n.language-flag-circle {\n  width: 55px;\n  height: 55px;\n  border-radius: 50%;\n  overflow: hidden;\n  cursor: pointer;\n  box-shadow: 0 4px 10px rgba(0,0,0,0.2);\n  transition: transform 0.2s ease;\n}\n\n.language-flag-circle:hover {\n  transform: scale(1.2);\n}\n\n.language-flag-circle.active {\n  border: 5px solid #125975;\n}\n\n.language-flag-circle img {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n/* ======================================\n   RESPONSIVE STYLING\n   ====================================== */\n@media (max-width: 860px) {\n  .country-header {\n    padding: 12px 16px;\n    gap: 12px;\n  }\n\n  .header-center {\n    display: none;\n  }\n\n  .logo-wiki,\n  .logo-conflicts {\n    font-size: 18px;\n  }\n\n  .header-quote {\n    display: none;\n  }\n\n  .lang-toggle {\n    width: 38px;\n    height: 38px;\n    font-size: 16px;\n  }\n\n  .lang-menu {\n    min-width: 160px;\n    right: -8px;\n  }\n}\n\n@media (max-width: 600px) {\n  .country-header {\n    padding: 10px 12px;\n    gap: 8px;\n  }\n\n  .lang-toggle {\n    width: 36px;\n    height: 36px;\n    font-size: 14px;\n  }\n\n  .lang-menu {\n    min-width: 140px;\n    right: -4px;\n    padding: 8px;\n  }\n\n  .lang-option {\n    padding: 8px 10px;\n    font-size: 12px;\n  }\n\n  .flag-emoji {\n    font-size: 16px;\n  }\n}\n","path":null,"size_bytes":6530,"size_tokens":null},"src/components/FloatingCountries.jsx":{"content":"\"use client\"\n\nimport { useEffect, useState } from \"react\"\nimport { useNavigate } from \"react-router-dom\"\nimport { useLanguage } from \"../context/LanguageContext\"\nimport \"./floating-countries.css\"\n\nconst FALLBACK_COUNTRIES = [\n  { code: \"palestine\", name: \"Palestina\", hasConflict: true },\n  { code: \"sahara\", name: \"SÃ¡hara Occidental\", hasConflict: true },\n  { code: \"yemen\", name: \"Yemen\", hasConflict: true },\n  { code: \"syria\", name: \"Siria\", hasConflict: true },\n]\n\nexport default function FloatingCountries({ isDropdown = false }) {\n  const navigate = useNavigate()\n  const { lang } = useLanguage()\n  const [countries, setCountries] = useState(FALLBACK_COUNTRIES) // Initialize with fallback data\n\n  useEffect(() => {\n    async function loadCountries() {\n      try {\n        const res = await fetch(`/data/${lang}/countries.json`)\n        if (res.ok) {\n          const data = await res.json()\n          setCountries(data)\n        }\n      } catch (err) {\n        console.error(\"[v0] Error loading countries, using fallback:\", err)\n      }\n    }\n    loadCountries()\n  }, [lang])\n\n  const handleCountryClick = (code) => {\n    navigate(`/country/${code}`)\n  }\n\n  if (isDropdown) {\n    const filteredCountries = countries.filter((c) => ![\"sahara\", \"israel\"].includes(c.code.toLowerCase()))\n\n    return (\n      <div className=\"country-dropdown-container\">\n        <p className=\"select-instruction\">Seleccione un conflicto para analizar:</p>\n        <div className=\"mobile-country-grid\">\n          {filteredCountries.map((c) => (\n            <div\n              key={c.code}\n              className={`mobile-country-circle ${c.hasConflict ? \"has-conflict\" : \"\"}`}\n              onClick={() => handleCountryClick(c.code)}\n            >\n              <span className=\"country-name-mobile-circle\">{c.name}</span>\n            </div>\n          ))}\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"floating-container\">\n      {countries.map((country, index) => (\n        <div\n          key={country.code}\n          className={`floating-circle ${country.hasConflict ? \"has-conflict\" : \"\"}`}\n          style={{\n            \"--index\": index,\n            \"--delay\": `${index * 0.1}s`,\n          }}\n          onClick={() => handleCountryClick(country.code)}\n          role=\"button\"\n          tabIndex={0}\n          onKeyPress={(e) => {\n            if (e.key === \"Enter\" || e.key === \" \") {\n              handleCountryClick(country.code)\n            }\n          }}\n        >\n          <span className=\"country-name\">{country.name}</span>\n        </div>\n      ))}\n    </div>\n  )\n}\n","path":null,"size_bytes":2586,"size_tokens":null},"src/layout/timeline.css":{"content":".timeline-container {\n  padding: 2rem;\n  max-width: 1000px;\n  margin: 0 auto;\n}\n\n.timeline-header {\n  text-align: center;\n  margin-bottom: 3rem;\n}\n\n.timeline-header h2 {\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 2.5rem;\n  color: #0c3344;\n  margin-bottom: 0.5rem;\n  font-weight: 600;\n}\n\n.timeline-header p {\n  font-family: 'Cormorant Garamond', serif;\n  font-style: italic;\n  color: #666;\n  font-size: 1.1rem;\n}\n\n.timeline-filters {\n  display: flex;\n  gap: 1rem;\n  justify-content: center;\n  margin-bottom: 2rem;\n  flex-wrap: wrap;\n}\n\n.timeline-filter-select {\n  padding: 0.6rem 1.2rem;\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 1rem;\n  border: 2px solid #0c3344;\n  border-radius: 4px;\n  background: white;\n  color: #0c3344;\n  cursor: pointer;\n  min-width: 150px;\n  transition: all 0.2s ease;\n}\n\n.timeline-filter-select:hover {\n  background: #f5f5f5;\n}\n\n.timeline-filter-select:focus {\n  outline: none;\n  box-shadow: 0 0 0 3px rgba(12, 51, 68, 0.2);\n}\n\n.timeline-filter-clear {\n  padding: 0.6rem 1.2rem;\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 1rem;\n  border: 2px solid #8b0000;\n  border-radius: 4px;\n  background: white;\n  color: #8b0000;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n\n.timeline-filter-clear:hover {\n  background: #8b0000;\n  color: white;\n}\n\n.timeline-empty {\n  text-align: center;\n  padding: 3rem 1rem;\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 1.2rem;\n  color: #666;\n  font-style: italic;\n}\n\n.timeline-line {\n  position: relative;\n  padding-left: 2rem;\n}\n\n.timeline-line::before {\n  content: '';\n  position: absolute;\n  left: 0;\n  top: 0;\n  bottom: 0;\n  width: 3px;\n  background: linear-gradient(to bottom, #0c3344, #1d546b);\n}\n\n.timeline-event {\n  position: relative;\n  margin-bottom: 3rem;\n  padding-left: 2rem;\n  cursor: pointer;\n  transition: transform 0.2s ease;\n}\n\n.timeline-event:hover {\n  transform: translateX(5px);\n}\n\n.timeline-event::before {\n  content: '';\n  position: absolute;\n  left: -2rem;\n  top: 0.5rem;\n  width: 14px;\n  height: 14px;\n  background: #0c3344;\n  border-radius: 50%;\n  border: 3px solid #fff;\n  box-shadow: 0 0 0 3px #0c3344;\n}\n\n.timeline-date {\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 0.9rem;\n  color: #8b0000;\n  font-weight: 600;\n  letter-spacing: 1px;\n  margin-bottom: 0.5rem;\n  text-transform: uppercase;\n}\n\n.timeline-year {\n  font-size: 2rem;\n  font-weight: 700;\n  color: #0c3344;\n  opacity: 0.3;\n  position: absolute;\n  left: -5rem;\n  top: 0;\n  font-family: 'Cormorant Garamond', serif;\n}\n\n.timeline-title {\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 1.5rem;\n  color: #0c3344;\n  font-weight: 600;\n  margin-bottom: 0.5rem;\n  line-height: 1.3;\n}\n\n.timeline-summary {\n  font-family: Georgia, serif;\n  font-size: 1rem;\n  color: #444;\n  line-height: 1.6;\n}\n\n.timeline-article {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 2rem;\n  padding: 2rem;\n  background: #fff;\n}\n\n.timeline-article-media {\n  position: relative;\n}\n\n.timeline-article-media img,\n.timeline-article-media video {\n  width: 100%;\n  height: auto;\n  object-fit: cover;\n  border-radius: 4px;\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);\n}\n\n.timeline-article-content {\n  display: flex;\n  flex-direction: column;\n}\n\n.timeline-article-date {\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 1rem;\n  color: #8b0000;\n  font-weight: 600;\n  letter-spacing: 2px;\n  text-transform: uppercase;\n  margin-bottom: 1rem;\n  padding-bottom: 0.5rem;\n  border-bottom: 2px solid #0c3344;\n}\n\n.timeline-article-title {\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 2.2rem;\n  color: #0c3344;\n  font-weight: 700;\n  line-height: 1.2;\n  margin-bottom: 1.5rem;\n}\n\n.timeline-article-text {\n  font-family: Georgia, 'Times New Roman', serif;\n  font-size: 1.05rem;\n  color: #333;\n  line-height: 1.8;\n  column-count: 1;\n  column-gap: 2rem;\n}\n\n.timeline-article-text p {\n  margin-bottom: 1rem;\n  text-align: justify;\n  text-indent: 1.5em;\n}\n\n.timeline-article-text p:first-child {\n  text-indent: 0;\n}\n\n.timeline-article-text p:first-child::first-letter {\n  font-size: 3.5rem;\n  font-family: 'Cormorant Garamond', serif;\n  font-weight: 700;\n  float: left;\n  line-height: 1;\n  margin-right: 0.5rem;\n  margin-top: 0.1rem;\n  color: #0c3344;\n}\n\n.timeline-sources {\n  margin-top: 2rem;\n  padding-top: 1rem;\n  border-top: 1px solid #ddd;\n}\n\n.timeline-sources h4 {\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 0.9rem;\n  color: #666;\n  margin-bottom: 0.5rem;\n  text-transform: uppercase;\n  letter-spacing: 1px;\n}\n\n.timeline-sources ul {\n  list-style: none;\n  padding: 0;\n  margin: 0;\n}\n\n.timeline-sources li {\n  font-size: 0.85rem;\n  color: #888;\n  font-style: italic;\n  margin-bottom: 0.25rem;\n}\n\n@media (max-width: 860px) {\n  .timeline-article {\n    grid-template-columns: 1fr;\n    gap: 1.5rem;\n    padding: 1rem;\n  }\n\n  .timeline-article-title {\n    font-size: 1.8rem;\n  }\n\n  .timeline-article-text {\n    column-count: 1;\n  }\n\n  .timeline-year {\n    display: none;\n  }\n\n  .timeline-container {\n    padding: 1rem;\n  }\n\n  .timeline-line {\n    padding-left: 1.5rem;\n  }\n\n  .timeline-event {\n    padding-left: 1.5rem;\n  }\n\n  .timeline-event::before {\n    left: -1.5rem;\n    width: 10px;\n    height: 10px;\n  }\n}\n","path":null,"size_bytes":5223,"size_tokens":null},"WorldMap.css":{"content":"/* Fixing map container to fill available space correctly */\n.map-wrapper {\n  width: 100%;\n  height: 70vh; /* Fixed height relative to viewport */\n  min-height: 500px;\n  margin: 2rem auto;\n  position: fixed;\n  margin-top: 250px;\n \n \n}\n\n.tooltip-card {\n  position: fixed; /* Fixed instead of absolute to avoid clipping */\n  transform: translate(-50%, -100%);\n  /* background:  #fdfdfd;; */\n  padding: 12px 16px;\n  /* border: 1px solid #070707; */\n  /* box-shadow: 0 4px 12px rgba(209, 204, 204, 0.15); */\n  pointer-events: none;\n  z-index: 100;\n  min-width: 150px;\n  text-align: center;\n  /* border-radius: 40px; */\n  \n}\n\n.tooltip-card h3 {\n    color: #16a34a;\n  font-size: 1.5rem;\n   font-family: Cormorant Garamond;;\n}\n","path":null,"size_bytes":720,"size_tokens":null},"src/components/MapLatinAmerica.js":{"content":"\"use client\";\n\nimport { useState } from \"react\";\nimport { ComposableMap, Geographies, Geography, Marker } from \"react-simple-maps\";\nimport \"./WorldMap.css\";\n\nconst geoUrl = \"https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json\";\n\n// ---------------------------\n// LISTA DE PAISES LATINOAMERICANOS\n// ---------------------------\nconst latinCountries = [\n  \"Brazil\",\"Argentina\",\"Colombia\",\"Chile\",\"Peru\",\"Venezuela\",\n  \"Bolivia\",\"Paraguay\",\"Uruguay\",\"Ecuador\",\n \"Trinidad and Tobago\",\n];\n\n// ---------------------------\n// DATOS DE PAISES (POPUPS)\n// ---------------------------\nconst countryData = {\n  brazil: { name: \"Brasil\", coordinates: [-47.8825, -15.7942], image: \"/brazil-rio.jpg\", description: \"El gigante sudamericano.\", hasConflict: false },\n  argentina: { name: \"Argentina\", coordinates: [-58.3816, -34.6037], image: \"/argentina-buenos-aires.jpg\", description: \"PaÃ­s austral de gran cultura.\", hasConflict: false },\n  mexico: { name: \"MÃ©xico\", coordinates: [-99.1332, 19.4326], image: \"/mexico-city.jpg\", description: \"Centro histÃ³rico y cultural.\", hasConflict: false },\n  colombia: { name: \"Colombia\", coordinates: [-74.0721, 4.711], image: \"/colombia-bogota.jpg\", description: \"PaÃ­s biodiverso en los Andes.\", hasConflict: false },\n  chile: { name: \"Chile\", coordinates: [-70.6693, -33.4489], image: \"/chile-santiago.jpg\", description: \"Entre los Andes y el PacÃ­fico.\", hasConflict: false },\n  peru: { name: \"PerÃº\", coordinates: [-77.0428, -12.0464], image: \"/peru-lima.jpg\", description: \"Cuna del Imperio Inca.\", hasConflict: false },\n  venezuela: { name: \"Venezuela\", coordinates: [-66.9036, 10.4806], image: \"/venezuela-caracas.jpg\", description: \"PaÃ­s en conflicto polÃ­tico y social.\", hasConflict: true }\n};\n\n// ---------------------------\n// COMPONENTE PRINCIPAL\n// ---------------------------\nexport default function LatinAmericaMap(){\n  const [hoveredCountry, setHoveredCountry] = useState(null);\n\n  const getCountryId = (geo) => geo.properties.name.toLowerCase().replace(/\\s+/g, \"-\");\n\n  const handleCountryClick = (countryId) => {\n    window.location.href = `/country/${countryId}`;\n  };\n\n  return (\n    <div className=\"map-wrapper\" style={{ position: \"relative\" }}>\n      <ComposableMap\n        projection=\"geoMercator\"\n        projectionConfig={{ scale: 400, center: [-65, -25] }}\n        style={{ width: \"100%\", height: \"100%\" }}\n      >\n        <Geographies geography={geoUrl}>\n          {({ geographies }) =>\n            geographies\n              .filter((geo) => latinCountries.includes(geo.properties.name))\n              .map((geo) => {\n                const countryId = getCountryId(geo);\n                const isHovered = hoveredCountry === countryId;\n\n                return (\n                  <Geography\n                    key={geo.rsmKey}\n                    geography={geo}\n                    onClick={() => handleCountryClick(countryId)}\n                    onMouseEnter={() => setHoveredCountry(countryId)}\n                    onMouseLeave={() => setHoveredCountry(null)}\n                    fill={isHovered ? \"#184a5f\" : \"#07202b\"}\n                    stroke=\"#ffffff\"\n                    strokeWidth={0.4}\n                    style={{\n                      default: { outline: \"none\", cursor: \"pointer\" },\n                      hover: { outline: \"none\", fill: \"#184a5f\" },\n                      pressed: { outline: \"none\" }\n                    }}\n                  />\n                );\n              })\n          }\n        </Geographies>\n\n        {/* MARCADORES PARA PAISES EN CONFLICTO */}\n        {Object.entries(countryData).map(([id, data]) => {\n          if (!data.hasConflict) return null;\n          return (\n            <Marker key={id} coordinates={data.coordinates}>\n              <g\n                onMouseEnter={() => setHoveredCountry(id)}\n                onMouseLeave={() => setHoveredCountry(null)}\n                style={{ cursor: \"pointer\" }}\n              >\n                <circle r=\"20\" className=\"conflict-marker-pulse\" />\n                <circle r=\"20\" className=\"conflict-marker-pulse\" style={{ animationDelay: \"0.5s\" }} />\n                <circle r=\"20\" className=\"conflict-marker-pulse\" style={{ animationDelay: \"1s\" }} />\n                <circle r=\"20\" className=\"conflict-marker-pulse\" style={{ animationDelay: \"1.5s\" }} />\n                <circle r=\"6\" fill=\"#ef4444\" stroke=\"white\" strokeWidth=\"1\" />\n              </g>\n            </Marker>\n          );\n        })}\n      </ComposableMap>\n\n      {/* POPUP CIRCULAR */}\n      {hoveredCountry && countryData[hoveredCountry] && (\n        <div\n          className=\"country-popup-circle\"\n          style={{\n            position: \"absolute\",\n            top: \"-90px\",\n            left: \"220px\",\n            width: 200,\n            height: 200,\n            borderRadius: \"50%\",\n            display: \"flex\",\n            flexDirection: \"column\",\n            alignItems: \"center\",\n            justifyContent: \"center\",\n            backgroundColor: \"#ffffffee\",\n            boxShadow: \"0 0 15px rgba(0,0,0,0.3)\",\n            padding: \"10px\",\n            textAlign: \"center\",\n          }}\n        >\n          <img\n            src={countryData[hoveredCountry].image}\n            alt={countryData[hoveredCountry].name}\n            style={{ width: \"80px\", height: \"80px\", borderRadius: \"50%\", marginBottom: \"10px\", objectFit: \"cover\" }}\n          />\n          <h3 style={{ fontSize: \"16px\", margin: 0 }}>{countryData[hoveredCountry].name}</h3>\n          <p style={{ fontSize: \"12px\", margin: 0 }}>{countryData[hoveredCountry].description}</p>\n        </div>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":5613,"size_tokens":null},"src/pages/Home.js":{"content":"\"use client\"\n\nimport \"./Home.css\"\nimport { useState, useEffect } from \"react\"\nimport { Link, useNavigate } from \"react-router-dom\"\n\nimport WorldMap from \"../components/WorldMap\"\nimport MapLatinAmerica from \"../components/MapLatinAmerica\"\nimport MapAfrica from \"../components/MapAfrica\"\nimport MapEurope from \"../components/MapEurope\"\nimport MapAsia from \"../components/MapAsia\"\n\nconst regions = [\n  {\n    name: \"Oriente Medio\",\n    countries: [\n      { id: \"palestine\", name: \"Palestina\", flag: \"/flags/pa.png\", hasConflict: true },\n      { id: \"lebanon\", name: \"LÃ­bano\", flag: \"/flags/li.png\", hasConflict: true },\n      { id: \"yemen\", name: \"Yemen\", flag: \"/flags/ye.png\", hasConflict: true },\n      { id: \"syria\", name: \"Siria\", flag: \"/flags/sy.png\", hasConflict: true },\n      { id: \"iran\", name: \"IrÃ¡n\", flag: \"/flags/ir.png\", hasConflict: true },\n      { id: \"iraq\", name: \"Irak\", flag: \"/flags/ira.png\", hasConflict: false },\n    ]\n  },\n  {\n    name: \"Ãfrica\",\n    countries: [\n      { id: \"sudan\", name: \"SudÃ¡n\", flag: \"/flags/su.png\", hasConflict: true },\n      { id: \"morocco\", name: \"Marruecos\", flag: \"/flags/ma.png\", hasConflict: false },\n      { id: \"algeria\", name: \"Argelia\", flag: \"/flags/ar.png\", hasConflict: false },\n      { id: \"libya\", name: \"Libia\", flag: \"/flags/li.png\", hasConflict: false },\n      { id: \"egypt\", name: \"Egipto\", flag: \"/flags/eg.png\", hasConflict: false },\n    ]\n  },\n  {\n    name: \"Europa\",\n    countries: [\n      { id: \"ukraine\", name: \"Ucrania\", flag: \"/flags/ukr.png\", hasConflict: true },\n    ]\n  },\n  {\n    name: \"AmÃ©rica Latina\",\n    countries: [\n      { id: \"venezuela\", name: \"Venezuela\", flag: \"/flags/ve.png\", hasConflict: true },\n    ]\n  }\n]\n\nfunction Home() {\n  const [isMobile, setIsMobile] = useState(false)\n  const [isAnimated, setIsAnimated] = useState(false)\n  const [searchTerm, setSearchTerm] = useState(\"\")\n  const [mapIndex, setMapIndex] = useState(0)\n  const navigate = useNavigate()\n\n  const maps = [\n    <WorldMap key=\"arab\" />, \n    <MapLatinAmerica key=\"latam\" />,\n    \n    <MapEurope key=\"europe\" />,\n    \n  ]\n\n  const nextMap = () => {\n    setMapIndex((prev) => (prev + 1) % maps.length)\n  }\n\n  const prevMap = () => {\n    setMapIndex((prev) => (prev - 1 + maps.length) % maps.length)\n  }\n\n  useEffect(() => {\n    const checkMobile = () => setIsMobile(window.innerWidth < 860)\n    checkMobile()\n    window.addEventListener(\"resize\", checkMobile)\n\n    const timer = setTimeout(() => setIsAnimated(true), 800)\n\n    return () => {\n      window.removeEventListener(\"resize\", checkMobile)\n      clearTimeout(timer)\n    }\n  }, [])\n\n  const filteredRegions = regions.map(region => ({\n    ...region,\n    countries: region.countries.filter(country => \n      country.name.toLowerCase().includes(searchTerm.toLowerCase())\n    )\n  })).filter(region => region.countries.length > 0)\n\n  if (isMobile) {\n    return (\n      <div className={`mobile-home ${isAnimated ? \"animated\" : \"\"}`}>\n        <Link to=\"/admin/login\" className=\"admin-button-mobile\">\n          Admin\n        </Link>\n        \n        <div className=\"mobile-home-search\">\n          <input\n            type=\"search\"\n            className=\"mobile-search-input\"\n            placeholder=\"Buscar en WikiConflicts...\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n            aria-label=\"Buscar contenido\"\n          />\n        </div>\n\n        <div className=\"mobile-brand-center\">\n          <h1 className=\"title-main\">\n            <span className=\"title-wiki\">Wiki</span>\n            <span className=\"title-conflicts\">Conflicts</span>\n          </h1>\n          <p className=\"mobile-quote\">\n            \"Y mientras el verdugo insista en escribir la historia, mi deber serÃ¡ arrancarle la pluma.\"\n          </p>\n        </div>\n        \n        <div className=\"mobile-countries-container\">\n          {filteredRegions.map((region) => (\n            <div key={region.name} className=\"mobile-region\">\n              <h3 className=\"mobile-region-title\">{region.name}</h3>\n              <div className=\"mobile-countries-grid\">\n                {region.countries.map((country) => (\n                  <div\n                    key={country.id}\n                    className={`mobile-country-circle ${country.hasConflict ? 'has-conflict' : ''}`}\n                    onClick={() => navigate(`/country/${country.id}`)}\n                    role=\"button\"\n                    tabIndex={0}\n                    onKeyDown={(e) => {\n                      if (e.key === 'Enter' || e.key === ' ') {\n                        e.preventDefault()\n                        navigate(`/country/${country.id}`)\n                      }\n                    }}\n                  >\n                    <div className=\"country-circle-inner\">\n                      <span className=\"country-circle-name\">{country.name}</span>\n                      {country.hasConflict && (\n                        <span className=\"country-conflict-badge\"></span>\n                      )}\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"home-container\">\n      <Link to=\"/admin/login\" className=\"admin-button\">\n        Admin\n      </Link>\n\n      <div className=\"title-block\">\n        <h1 className=\"title-main\">\n          <span className=\"title-wiki\">Wiki</span>\n          <span className=\"title-conflicts\">Conflicts</span>\n        </h1>\n        <h2 className=\"title-sub\">La voz de las victimas</h2>\n      </div>\n\n      {/* AQUÃ CAMBIAN LOS MAPAS, TODO IGUAL QUE ANTES */}\n      <div style={{ position: \"relative\", width: \"100%\", height: \"100%\" }}>\n        {maps[mapIndex]}\n\n        {/* FLECHA IZQUIERDA */}\n        <button\n          onClick={prevMap}\n          style={{\n            position: \"absolute\",\n            top: \"50%\",\n            left: \"20px\",\n            transform: \"translateY(-50%)\",\n            background: \"#ffffffdd\",\n            width: \"60px\",\n            height: \"60px\",\n            borderRadius: \"8px\",\n            border: \"none\",\n            fontSize: \"32px\",\n            cursor: \"pointer\",\n            boxShadow: \"0 4px 12px rgba(0,0,0,0.2)\"\n          }}\n        >\n          â—€\n        </button>\n\n        {/* FLECHA DERECHA */}\n        <button\n          onClick={nextMap}\n          style={{\n            position: \"absolute\",\n            top: \"50%\",\n            right: \"20px\",\n            transform: \"translateY(-50%)\",\n            background: \"#ffffffdd\",\n            width: \"60px\",\n            height: \"60px\",\n            borderRadius: \"8px\",\n            border: \"none\",\n            fontSize: \"32px\",\n            cursor: \"pointer\",\n            boxShadow: \"0 4px 12px rgba(0,0,0,0.2)\"\n          }}\n        >\n          â–¶\n        </button>\n      </div>\n    </div>\n  )\n}\n\nexport default Home\n","path":null,"size_bytes":6869,"size_tokens":null},"WorldMap.js":{"content":"\"use client\"\n\nimport { useState } from \"react\"\nimport { ComposableMap, Geographies, Geography } from \"react-simple-maps\"\nimport \"./WorldMap.css\"\n\nconst geoUrl = \"https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json\"\n\nconst arabCountries = [\n  \"Algeria\",\n  \"Bahrain\",\n  \"Comoros\",\n  \n  \"Egypt\",\n  \n  \"Iraq\",\n  \"Israel\",\n  \"Jordan\",\n  \"Kuwait\",\n  \"Lebanon\",\n  \"Libya\",\n  \"Mauritania\",\n  \"Morocco\",\n  \"Oman\",\n  \"Qatar\",\n  \"Saudi Arabia\",\n  // \"Somalia\",\n  \"Sudan\",\n  \"South Sudan\",\n  \"Syria\",\n  \"Tunisia\",\n  \"United Arab Emirates\",\n  \"Yemen\",\n  \"Western Sahara\",\n  \"Palestinian Territory, Occupied\",\n]\n\nconst countryData = {\n  morocco: {\n    name: \"Morocco\",\n    image: \"/morocco-atlas-mountains-medina.jpg\",\n    description: \"Ancient kingdom bridging Africa and Europe\",\n  },\n  israel: {\n    name: \"Israel & Palestine\",\n    image: \"/israel-palestine-landscape.jpg\",\n    description: \"Contested territory with complex history\",\n  },\n  algeria: {\n    name: \"Algeria\",\n    image: \"/algeria-flag-desert-landscape.jpg\",\n    description: \"Largest country in Africa with Berber and Arab heritage\",\n  },\n  egypt: { name: \"Egypt\", image: \"/egypt-pyramids-nile.jpg\", description: \"Cradle of ancient civilization\" },\n  libya: {\n    name: \"Libya\",\n    image: \"/libya-sahara-desert.jpg\",\n    description: \"Vast Saharan nation with Mediterranean coast\",\n  },\n}\n\nexport default function WorldMap() {\n  const [hoveredCountry, setHoveredCountry] = useState(null)\n  const [tooltipPos, setTooltipPos] = useState({ x: 0, y: 0 })\n  // Removed isMobile state here as it is handled by parent or CSS\n\n  const getCountryId = (geo) => {\n    const name = geo.properties.name.toLowerCase()\n    if (geo.id === \"732\" || name === \"morocco\") return \"morocco\"\n    const israelIds = [\"376\", \"275\"]\n    const israelNames = [\"israel\", \"palestine\", \"west bank\", \"gaza\"]\n    if (israelIds.includes(geo.id) || israelNames.includes(name)) return \"israel\"\n    return name.replace(/\\s+/g, \"-\")\n  }\n\n  const handleMouseEnter = (geo, event) => {\n    const countryId = getCountryId(geo)\n    setHoveredCountry(countryId)\n    const rect = event.currentTarget.getBoundingClientRect()\n    setTooltipPos({ x: rect.left + rect.width / 2, y: rect.top - 10 })\n  }\n\n  const handleMouseLeave = () => setHoveredCountry(null)\n\n  const handleCountryClick = (countryId) => {\n    const routeId = countryId === \"israel\" ? \"palestine\" : countryId\n    window.location.href = `/country/${routeId}`\n  }\n\n  return (\n    <div className=\"map-wrapper\">\n      <ComposableMap\n        projection=\"geoMercator\"\n        projectionConfig={{ scale: 1000, center: [20, 25] }} // Adjusted center/scale for Arab world\n        style={{ width: \"100%\", height: \"100%\" }}\n      >\n        <Geographies geography={geoUrl}>\n          {({ geographies }) =>\n            geographies\n              .filter((geo) => arabCountries.includes(geo.properties.name) || geo.id === \"732\" || geo.id === \"275\")\n              .map((geo) => {\n                const countryId = getCountryId(geo)\n                const isHovered = hoveredCountry === countryId\n\n                return (\n                  <Geography\n                    key={geo.rsmKey}\n                    geography={geo}\n                    onMouseEnter={(e) => handleMouseEnter(geo, e)}\n                    onMouseLeave={handleMouseLeave}\n                    onClick={() => handleCountryClick(countryId)}\n                    fill={isHovered ? \"#920c0cff\" : \"#c8c8c8\"} // Wikipedia-like colors\n                    stroke=\"#FFFFFF\"\n                    strokeWidth={0.5}\n                    style={{\n                      default: { outline: \"none\", cursor: \"pointer\" },\n                      hover: { outline: \"none\", fill: \"#920c0cff\" },\n                      pressed: { outline: \"none\" },\n                    }}\n                  />\n                )\n              })\n          }\n        </Geographies>\n      </ComposableMap>\n\n      {hoveredCountry && (\n        <div\n          className=\"tooltip-card\"\n          style={{\n            top: tooltipPos.y,\n            left: tooltipPos.x,\n          }}\n        >\n          <h3>{countryData[hoveredCountry]?.name || hoveredCountry}</h3>\n          {/* Simplified tooltip for cleaner look */}\n        </div>\n      )}\n    </div>\n  )\n}\n","path":null,"size_bytes":4246,"size_tokens":null},"src/components/MapEurope.js":{"content":"// src/components/MapEurope.js\n\"use client\"\n\nimport React, { useState } from \"react\"\nimport { ComposableMap, Geographies, Geography, Marker } from \"react-simple-maps\"\nimport { geoCentroid } from \"d3-geo\"\nimport \"./WorldMap.css\"\nconst geoUrl = \"https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json\"\n\n// Lista completa de paÃ­ses europeos (nombres tal como aparecen en world-atlas)\nconst europeCountries = [\n  \"Andorra\",\"Belarus\",\"Belgium\",\n \"France\",\n  \"Germany\",\"Greece\",\"Ireland\",\"Italy\",\n \n  \"Netherlands\",\"Poland\",\"Portugal\",\"Spain\",\n  \"Switzerland\",\"Ukraine\",\"United Kingdom\",\"Vatican\"\n]\n\n// PaÃ­ses que mostrarÃ¡n el marcador de conflicto (normalizados, sin espacios, sin acentos)\n// Puedes aÃ±adir mÃ¡s aquÃ­ (ej: \"venezuela\", \"democraticrepublicofthecongo\")\nconst CONFLICTS_NORMALIZED = new Set([\"ukraine\"])\n\nfunction normalizeForFilename(name) {\n  if (!name) return \"\"\n  // 1) quitar diacrÃ­ticos\n  const noDiacritics = name.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\")\n  // 2) conservar sÃ³lo letras y nÃºmeros, eliminar espacios y sÃ­mbolos\n  const alnum = noDiacritics.replace(/[^0-9a-zA-Z]/g, \"\")\n  // 3) minÃºsculas\n  return alnum.toLowerCase()\n}\n\nfunction getCountryIdFromGeo(geo) {\n  const name = (geo.properties.name || \"\").toLowerCase()\n  if (geo.id === \"732\" || name === \"morocco\" || name === \"western sahara\") return \"morocco\"\n  const israelIds = [\"376\", \"275\"]\n  const israelNames = [\"israel\", \"palestine\", \"west bank\", \"gaza\"]\n  if (israelIds.includes(geo.id) || israelNames.includes(name)) return \"palestine\"\n  if (name === \"saudi arabia\") return \"saudi\"\n  if (name === \"united arab emirates\") return \"uae\"\n  return name.replace(/\\s+/g, \"-\")\n}\n\nexport default function MapEurope() {\n  const [hoveredCountry, setHoveredCountry] = useState(null) // id normalizado con guiones (country-id)\n  const [hoveredPlainName, setHoveredPlainName] = useState(null) // nombre tal cual del geo.properties.name\n\n  const handleCountryClick = (countryId) => {\n    const routeId = countryId === \"israel\" ? \"palestine\" : countryId\n    window.location.href = `/country/${routeId}`\n  }\n\n  const imagePathFromPlainName = (plainName) => {\n    const filename = normalizeForFilename(plainName) + \".png\"\n    const rawPath = `/ImÃ¡genes de PaÃ­s/${filename}`\n    return encodeURI(rawPath)\n  }\n\n  return (\n    <div className=\"map-wrapper\" style={{ position: \"relative\" }}>\n      <ComposableMap\n        projection=\"geoMercator\"\n        // centro y escala que muestran bien Europa\n        projectionConfig={{ scale: 800, center: [10, 50] }}\n        style={{ width: \"100%\", height: \"100%\" }}\n      >\n        <Geographies geography={geoUrl}>\n          {({ geographies }) =>\n            geographies\n              .filter((geo) => geo.properties && europeCountries.includes(geo.properties.name))\n              .map((geo) => {\n                const countryId = getCountryIdFromGeo(geo)\n                const isHovered = hoveredCountry === countryId\n                const fill = isHovered ? \"#6e7b4e46\" : \"#000000ff\"\n\n                return (\n                  <React.Fragment key={geo.rsmKey}>\n                    <Geography\n                      geography={geo}\n                      onClick={() => handleCountryClick(countryId)}\n                      onMouseEnter={() => {\n                        setHoveredCountry(countryId)\n                        setHoveredPlainName(geo.properties.name)\n                      }}\n                      onMouseLeave={() => {\n                        setHoveredCountry(null)\n                        setHoveredPlainName(null)\n                      }}\n                     fill={isHovered ? \"#184a5f\" : \"#07202b\"}\n                      stroke=\"#ffffffff\"\n                      strokeWidth={0.5}\n                      style={{\n                        default: { outline: \"none\", cursor: \"pointer\" },\n                        hover: { outline: \"none\", fill: \"#184a5f\" },\n                        pressed: { outline: \"none\" },\n                      }}\n                    />\n\n                    {/* Marker de conflicto: si el nombre normalizado (sin espacios ni acentos) estÃ¡ en CONFLICTS_NORMALIZED */}\n                    {CONFLICTS_NORMALIZED.has((geo.properties.name || \"\").normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").replace(/[^0-9a-zA-Z]/g, \"\").toLowerCase()) ? (\n                      (() => {\n                        const centroid = geoCentroid(geo)\n                        // centroid = [lng, lat] o [NaN, NaN] en casos muy pequeÃ±os; comprobamos\n                        if (!centroid || isNaN(centroid[0]) || isNaN(centroid[1])) return null\n                        return (\n                          <Marker key={`m-${geo.rsmKey}`} coordinates={centroid}>\n                            <g\n                              onMouseEnter={() => {\n                                setHoveredCountry(countryId)\n                                setHoveredPlainName(geo.properties.name)\n                              }}\n                              onMouseLeave={() => {\n                                setHoveredCountry(null)\n                                setHoveredPlainName(null)\n                              }}\n                              style={{ cursor: \"pointer\" }}\n                            >\n                              <circle r=\"20\" className=\"conflict-marker-pulse\" />\n                              <circle r=\"20\" className=\"conflict-marker-pulse\" style={{ animationDelay: \"0.5s\" }} />\n                              <circle r=\"20\" className=\"conflict-marker-pulse\" style={{ animationDelay: \"1s\" }} />\n                              <circle r=\"20\" className=\"conflict-marker-pulse\" style={{ animationDelay: \"1.5s\" }} />\n                              <circle r=\"6\" fill=\"#ef4444\" stroke=\"white\" strokeWidth=\"1\" />\n                            </g>\n                          </Marker>\n                        )\n                      })()\n                    ) : null}\n                  </React.Fragment>\n                )\n              })\n          }\n        </Geographies>\n      </ComposableMap>\n\n      {/* POPUP CIRCULAR - idÃ©ntico al de tu WorldMap */}\n      {hoveredPlainName && (\n        (() => {\n          const displayName = hoveredPlainName\n          const imageSrc = imagePathFromPlainName(displayName)\n\n          return (\n            <div\n              className=\"country-popup-circle\"\n              style={{\n                position: \"absolute\",\n                top: \"-90px\",\n                left: \"320px\",\n                width: 200,\n                height: 200,\n                borderRadius: \"50%\",\n                display: \"flex\",\n                flexDirection: \"column\",\n                alignItems: \"center\",\n                justifyContent: \"center\",\n                backgroundColor: \"#ffffffee\",\n                boxShadow: \"0 0 15px rgba(0,0,0,0.3)\",\n                padding: \"10px\",\n                textAlign: \"center\",\n                pointerEvents: \"none\",\n              }}\n            >\n              <img\n                src={imageSrc}\n                alt={displayName}\n                style={{ width: \"80px\", height: \"80px\", borderRadius: \"50%\", marginBottom: \"10px\", objectFit: \"cover\" }}\n                onError={(e) => {\n                  e.currentTarget.onerror = null\n                  e.currentTarget.src = encodeURI(\"/ImÃ¡genes de PaÃ­s/placeholder.png\")\n                }}\n              />\n              <h3 style={{ fontSize: \"16px\", margin: 0 }}>{displayName}</h3>\n              <p style={{ fontSize: \"12px\", margin: 0 }}>InformaciÃ³n disponible prÃ³ximamente.</p>\n            </div>\n          )\n        })()\n      )}\n    </div>\n  )\n}\n","path":null,"size_bytes":7617,"size_tokens":null},"replit.md":{"content":"# WikiConflicts - Interactive Conflict Documentation Platform\n\n## Overview\nWikiConflicts is a React-based web application that provides interactive documentation and visualization of global conflicts. The application features an interactive world map with detailed country-specific information including testimonies, media galleries, analyst perspectives, and terminology databases.\n\n## Project Architecture\n\n### Technology Stack\n- **Frontend Framework**: React 18.2.0\n- **Build Tool**: Create React App (react-scripts 5.0.1)\n- **Routing**: React Router DOM v6.20.0\n- **Mapping Library**: react-simple-maps v3.0.0\n- **Language**: JavaScript/TypeScript\n\n### Project Structure\n```\nâ”œâ”€â”€ public/\nâ”‚   â”œâ”€â”€ data/           # Country-specific conflict data (JSON)\nâ”‚   â”‚   â”œâ”€â”€ es/         # Spanish language data\nâ”‚   â”‚   â”‚   â”œâ”€â”€ palestine/  # Palestine conflict data\nâ”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ testimonies/  # Witness testimonies\nâ”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ analysts/     # Expert analysis\nâ”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ media/        # Images and videos\nâ”‚   â”‚   â”‚   â”‚   â””â”€â”€ meta.json\nâ”‚   â”‚   â”‚   â”œâ”€â”€ morocco/\nâ”‚   â”‚   â”‚   â”œâ”€â”€ libya/\nâ”‚   â”‚   â”‚   â”œâ”€â”€ algeria/\nâ”‚   â”‚   â”‚   â””â”€â”€ terminology/  # Conflict terminology database\nâ”‚   â”œâ”€â”€ flags/          # Country flag images\nâ”‚   â”œâ”€â”€ imagenes/       # General images\nâ”‚   â””â”€â”€ index.html\nâ”œâ”€â”€ src/\nâ”‚   â”œâ”€â”€ components/     # Reusable UI components\nâ”‚   â”‚   â”œâ”€â”€ WorldMap.js         # Main interactive map\nâ”‚   â”‚   â”œâ”€â”€ MapAfrica.js        # Africa region map\nâ”‚   â”‚   â”œâ”€â”€ MapAsia.js          # Asia region map\nâ”‚   â”‚   â”œâ”€â”€ MapEurope.js        # Europe region map\nâ”‚   â”‚   â”œâ”€â”€ MapLatinAmerica.js  # Latin America map\nâ”‚   â”‚   â”œâ”€â”€ FloatingCountries.jsx\nâ”‚   â”‚   â”œâ”€â”€ MobileMenu.jsx\nâ”‚   â”‚   â””â”€â”€ MobileNavigation.jsx\nâ”‚   â”œâ”€â”€ context/\nâ”‚   â”‚   â””â”€â”€ LanguageContext.js  # Multi-language support\nâ”‚   â”œâ”€â”€ layout/\nâ”‚   â”‚   â”œâ”€â”€ CountryLayout.jsx   # Country page layout\nâ”‚   â”‚   â”œâ”€â”€ CountryHeader.jsx\nâ”‚   â”‚   â”œâ”€â”€ CountryContent.jsx\nâ”‚   â”‚   â”œâ”€â”€ CountrySidebar.jsx\nâ”‚   â”‚   â””â”€â”€ MediaGallery.jsx\nâ”‚   â”œâ”€â”€ pages/\nâ”‚   â”‚   â”œâ”€â”€ Home.js             # Homepage with world map\nâ”‚   â”‚   â””â”€â”€ Country.js          # Country detail page\nâ”‚   â”œâ”€â”€ utils/\nâ”‚   â”‚   â””â”€â”€ dataLoader.js       # Data loading utilities\nâ”‚   â””â”€â”€ App.js\nâ””â”€â”€ package.json\n```\n\n### Key Features\n1. **Interactive World Map**: Browse conflicts by clicking on different regions/countries\n2. **Multi-language Support**: Content available in multiple languages (Spanish data present)\n3. **Rich Content Types**:\n   - Witness testimonies with detailed accounts\n   - Analyst perspectives and expert commentary\n   - Media galleries (images and videos)\n   - Terminology database with key concepts, organizations, and figures\n4. **Mobile-Responsive**: Dedicated mobile navigation and menu components\n\n## Replit Configuration\n\n### Environment Variables (Development)\n- `PORT=5000` - Server port\n- `HOST=0.0.0.0` - Bind to all network interfaces\n- `DANGEROUSLY_DISABLE_HOST_CHECK=true` - Allow Replit proxy access\n- `WDS_SOCKET_PORT=0` - WebSocket configuration for HMR\n\n### Workflow\n- **Name**: Start application\n- **Command**: `npm start`\n- **Port**: 5000 (webview)\n- **Type**: Frontend development server\n\n## Development\n\n### Running Locally\nThe application runs automatically via the configured workflow. The development server will:\n- Start on port 5000\n- Hot reload on file changes\n- Display ESLint warnings in the console\n\n### Build for Production\n```bash\nnpm run build\n```\nCreates an optimized production build in the `/build` folder.\n\n### Known ESLint Warnings\nThe codebase has some non-critical ESLint warnings:\n- Unused variables in map components\n- React Hook dependency warnings\nThese do not affect functionality.\n\n## Data Structure\n\n### Country Data Format\nEach country has its own folder under `/public/data/es/` with:\n- `meta.json` - Country metadata\n- `description.json` - Country description\n- `testimonies/` - Witness testimony files\n- `analysts/` - Expert analysis files\n- `media/` - Image and video metadata\n\n### Adding New Countries\n1. Create a new folder under `/public/data/es/[country-name]/`\n2. Add required JSON files following the palestine folder structure\n3. Update the map components to include the new country\n\n## Recent Changes\n- **2024-12-02**: Fototeca API Routes Fixed\n  - Corrected API routes to follow `/countries/:countryCode/fototeca` convention\n  - Updated FototecaEditor.js to use the correct API endpoints\n  - All CRUD operations now work correctly in CMS\n\n- **2024-12-02**: Complete CMS Implementation\n  - Added Express.js backend server on port 3001 for CMS functionality\n  - Implemented username/password authentication system (JSON-based, no database)\n  - Created admin panel with WikiConflicts editorial design style\n  - Built comprehensive content editors: Timeline, Testimonies, Analysts, Media\n  - Added file upload system for images and videos with security protections\n  - Implemented granular permission system (create/edit/delete per user)\n  - Added country-based access control for editors\n  - Security improvements: auto-generated JWT secrets, path traversal protection, random initial passwords\n  - Map hover effects with elevation and shadow already implemented\n\n- **2024-12-02**: Major feature additions\n  - Added Timeline section with newspaper-style layout showing chronological events\n  - Added Resistance section for \"Guardianes\" stories (same structure as Testimonios)\n  - Added Collaborate button in header linking to PayPal donations\n  - Added social media icons in footer (Twitter, Instagram, Telegram, YouTube)\n  - Improved map design: cleaner, more professional look, subtle hover effects\n  - Updated translations in 4 languages (es, en, ar, eu)\n  - Configured new section order: Description â†’ Timeline â†’ Testimonios â†’ Resistencia â†’ Fototeca\n\n- **2024-12-02**: Initial Replit environment setup\n  - Installed all dependencies\n  - Configured environment variables for Replit proxy\n  - Set up workflow on port 5000\n  - Verified application runs successfully\n\n## CMS Architecture\n\n### Backend (Express.js - Port 3001)\n```\nserver/\nâ”œâ”€â”€ index.js              # Main server entry point\nâ”œâ”€â”€ middleware/\nâ”‚   â””â”€â”€ auth.js           # JWT authentication & permissions\nâ”œâ”€â”€ routes/\nâ”‚   â”œâ”€â”€ auth.js           # Login/logout endpoints\nâ”‚   â”œâ”€â”€ cms.js            # Country/section CRUD operations\nâ”‚   â””â”€â”€ upload.js         # Image/video upload handling\nâ””â”€â”€ data/\n    â”œâ”€â”€ users.json        # User accounts (JSON storage)\n    â”œâ”€â”€ pending-changes.json  # Changes awaiting approval\n    â””â”€â”€ jwt-secret.key    # Auto-generated JWT secret\n```\n\n### Admin Panel (React)\n```\nsrc/admin/\nâ”œâ”€â”€ AdminLogin.js         # Login page\nâ”œâ”€â”€ AdminDashboard.js     # Main dashboard\nâ”œâ”€â”€ AdminCountry.js       # Country content editor\nâ”œâ”€â”€ AdminUsers.js         # User management\nâ”œâ”€â”€ AdminPending.js       # Pending approvals\nâ””â”€â”€ components/\n    â”œâ”€â”€ TimelineEditor.js\n    â”œâ”€â”€ TestimoniesEditor.js\n    â”œâ”€â”€ AnalystsEditor.js\n    â””â”€â”€ MediaEditor.js\n```\n\n### Authentication & Permissions\n- **Roles**: admin, editor\n- **Permissions per user**: canCreate, canEdit, canDelete, requiresApproval\n- **Country access**: Specific countries or 'all'\n- **JWT tokens**: Auto-generated secrets, stored securely\n\n### Security Features\n- JWT secrets auto-generated on first run\n- Path traversal protection on file deletion\n- Random initial admin password (shown in logs)\n- CORS configured for development\n\n## Deployment\nThis application requires both frontend and backend:\n- **Frontend**: React app on port 5000\n- **Backend**: Express.js API on port 3001\n- **Storage**: JSON files (no database required)\n- Use `npm start` to run both servers concurrently\n\n## Notes\n- Multi-language support (es, en, ar, eu)\n- Data stored as JSON files in `/public/data/` and `/server/data/`\n- CMS panel accessible at `/admin/login`\n- Initial admin credentials shown in server logs on first run\n","path":null,"size_bytes":8332,"size_tokens":null},"src/pages/Home.css":{"content":"/* Fixed home container to prevent scrolling and improve responsiveness */\n.home-container {\n  text-align: center;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  min-height: calc(100vh - 100px);\n  /* padding: 40px 20px; */\n  background: #ffffff;\n}\n\n.title-block {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  \n}\n\n.title-main {\n  \n  font-size: 72px;\n  /* margin: 0 0 12px 0; */\n  font-weight: 700;\n  color: #1a1a1a;\n  letter-spacing: -1px;\n  line-height: 1.1;\n  display: flex;\n  align-items: baseline;\n  gap: 8px;\n  justify-content: center;\n  margin: 62px 0 0px 0;\n}\n\n/* Wiki light weight (300) + Conflicts bold (700) */\n.title-wiki {\n  font-weight: 100;\n  font-style: italic;\n  color: #1d546b;\n  font-family: Cormorant Garamond;\n}\n\n.title-conflicts {\n  font-weight: 800;\n  color: #0c3344;\n  font-family: Cormorant Garamond;\n}\n\n.title-sub {\n  font-size: 35px;\n  font-weight: 200;\n  margin: 0;\n   color: #0c3344;\n  letter-spacing: 0.8px;\n  font-family: Bonheur Royale;\n}\n\n.quote {\n  margin-top: 20px;\n  font-style: italic;\n  font-size: 18px;\n  color: #16a34a;\n  font-weight: 500;\n  max-width: 620px;\n  line-height: 1.7;\n font-family: Cormorant Garamond;\n}\n\n/* Responsive design */\n@media (max-width: 1024px) {\n  .home-container {\n    padding: 30px 20px;\n    min-height: auto;\n    max-height: none;\n    overflow-y: auto;\n    justify-content: flex-start;\n    padding-top: 40px;\n  }\n\n  .title-main {\n    font-size: 56px;\n  }\n\n  .title-sub {\n    font-size: 16px;\n  }\n\n  .quote {\n    font-size: 15px;\n    margin-bottom: 40px;\n  }\n\n  .title-block {\n    margin-bottom: 40px;\n  }\n}\n\n/* Mobile-first adjustment for floating countries view */\n@media (max-width: 860px) {\n  .home-container {\n    padding: 20px 15px;\n    justify-content: flex-start;\n    padding-top: 40px;\n    overflow-y: auto;\n    max-height: 100vh;\n  }\n\n  .title-block {\n    margin-bottom: 30px;\n  }\n\n  .mobile-home {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    min-height: 100vh;\n    padding: 2rem;\n    background-color: #f8f9fa;\n  }\n\n  .mobile-brand-center {\n    text-align: center;\n    margin-bottom: 2rem;\n    transition: transform 0.5s ease;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 12px;\n  }\n\n  .mobile-brand-center .title-main {\n    font-size: 3.5rem;\n    margin-bottom: 0;\n  }\n\n  /* Style for mobile quote */\n  .mobile-quote {\n    font-family: Georgia, \"Times New Roman\", serif;\n    font-style: italic;\n    font-size: 14px;\n    color: #8b0000;\n    text-align: center;\n    max-width: 85%;\n    line-height: 1.4;\n    margin: 0;\n    opacity: 0.9;\n  }\n\n  .mobile-country-selector {\n    width: 100%;\n    max-width: 350px;\n    opacity: 0;\n    transform: translateY(20px);\n    transition: opacity 0.5s ease, transform 0.5s ease;\n  }\n\n  .mobile-country-selector.visible {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n@media (max-width: 768px) {\n  .home-container {\n    padding: 20px 15px;\n    justify-content: flex-start;\n    padding-top: 60px;\n  }\n\n  .title-block {\n    margin-bottom: 35px;\n  }\n\n  .title-main {\n    font-size: 44px;\n    gap: 6px;\n    margin-bottom: 10px;\n  }\n\n  .title-sub {\n    font-size: 14px;\n    letter-spacing: 0.5px;\n  }\n\n  .quote {\n    font-size: 14px;\n    margin-top: 18px;\n  }\n}\n\n@media (max-width: 480px) {\n  .home-container {\n    padding: 15px 12px;\n    padding-top: 40px;\n    justify-content: flex-start;\n  }\n\n  .title-block {\n    margin-bottom: 25px;\n  }\n\n  .title-main {\n    font-size: 36px;\n    margin-bottom: 6px;\n    gap: 4px;\n  }\n\n  .title-sub {\n    font-size: 13px;\n    letter-spacing: 0.3px;\n  }\n\n  .quote {\n    font-size: 13px;\n    margin-top: 12px;\n    max-width: 100%;\n  }\n}\n\n/* Mobile Home specific styles for animation */\n.mobile-home {\n  min-height: 100vh;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: flex-start;\n  transition: all 0.8s ease-in-out;\n  background: white;\n  position: relative;\n  overflow-y: auto;\n  padding-top: 70px;\n}\n\n/* Added mobile search bar at top of home page */\n.mobile-home-search {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  padding: 12px 16px;\n  background: #fff;\n  border-bottom: 1px solid #e0e0e0;\n  z-index: 1000;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\n}\n\n.mobile-search-input {\n  width: 100%;\n  padding: 10px 16px;\n  border: 1px solid #ccc;\n  border-radius: 20px;\n  font-size: 14px;\n  outline: none;\n  background: #f8f8f8;\n  transition: border-color 0.2s, box-shadow 0.2s;\n  font-family: inherit;\n}\n\n.mobile-search-input:focus {\n  border-color: #8b0000;\n  box-shadow: 0 0 0 3px rgba(139, 0, 0, 0.1);\n  background: #fff;\n}\n\n.mobile-search-input::placeholder {\n  color: #999;\n}\n\n.mobile-home.animated {\n  justify-content: flex-start;\n}\n\n.mobile-brand-center {\n  text-align: center;\n  transition: transform 0.5s ease;\n  margin-top: 10px;\n  margin-bottom: 20px;\n}\n\n.mobile-home.animated .mobile-brand-center {\n  transform: scale(0.85);\n}\n\n.mobile-country-selector {\n  opacity: 0;\n  transform: translateY(20px);\n  transition: opacity 0.5s ease 0.8s, transform 0.5s ease 0.8s;\n  width: 100%;\n  padding: 20px;\n}\n\n.mobile-country-selector.visible {\n  opacity: 1;\n  transform: translateY(0);\n}\n\n.admin-button {\n  position: fixed;\n  top: 20px;\n  right: 20px;\n  background: transparent;\n  color: #0c3344;\n  border: 1px solid #0c3344;\n  padding: 8px 20px;\n  font-size: 14px;\n  font-family: 'Cormorant Garamond', serif;\n  font-weight: 600;\n  text-decoration: none;\n  border-radius: 4px;\n  z-index: 100;\n  transition: all 0.2s ease;\n}\n\n.admin-button:hover {\n  background: #0c3344;\n  color: white;\n}\n\n.admin-button-mobile {\n  position: fixed;\n  top: 70px;\n  right: 16px;\n  background: transparent;\n  color: #0c3344;\n  border: 1px solid #0c3344;\n  padding: 6px 14px;\n  font-size: 12px;\n  font-family: 'Cormorant Garamond', serif;\n  font-weight: 600;\n  text-decoration: none;\n  border-radius: 4px;\n  z-index: 100;\n  transition: all 0.2s ease;\n}\n\n.admin-button-mobile:hover {\n  background: #0c3344;\n  color: white;\n}\n\n.mobile-countries-container {\n  width: 100%;\n  padding: 0 16px 40px;\n  overflow-y: auto;\n  flex: 1;\n}\n\n.mobile-region {\n  margin-bottom: 24px;\n}\n\n.mobile-region-title {\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 18px;\n  font-weight: 600;\n  color: #0c3344;\n  margin-bottom: 12px;\n  padding-bottom: 8px;\n  border-bottom: 1px solid #e0e0e0;\n  letter-spacing: 0.5px;\n}\n\n.mobile-countries-grid {\n  display: grid;\n  grid-template-columns: repeat(3, 1fr);\n  gap: 12px;\n}\n\n.mobile-country-circle {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  aspect-ratio: 1;\n  background: linear-gradient(145deg, #0c3344, #1d546b);\n  border-radius: 50%;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  position: relative;\n  box-shadow: 0 4px 12px rgba(12, 51, 68, 0.25);\n}\n\n.mobile-country-circle:hover,\n.mobile-country-circle:focus {\n  transform: scale(1.05);\n  box-shadow: 0 6px 20px rgba(12, 51, 68, 0.35);\n}\n\n.mobile-country-circle.has-conflict {\n  background: linear-gradient(145deg, #8b0000, #a52a2a);\n  box-shadow: 0 4px 12px rgba(139, 0, 0, 0.3);\n}\n\n.mobile-country-circle.has-conflict:hover,\n.mobile-country-circle.has-conflict:focus {\n  box-shadow: 0 6px 20px rgba(139, 0, 0, 0.4);\n}\n\n.country-circle-inner {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 8px;\n  text-align: center;\n}\n\n.country-circle-name {\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 11px;\n  font-weight: 600;\n  color: white;\n  line-height: 1.2;\n  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);\n}\n\n.country-conflict-badge {\n  position: absolute;\n  top: 4px;\n  right: 4px;\n  width: 8px;\n  height: 8px;\n  background: #ff4444;\n  border-radius: 50%;\n  border: 2px solid white;\n  animation: pulse-badge 2s infinite;\n}\n\n@keyframes pulse-badge {\n  0%, 100% {\n    transform: scale(1);\n    opacity: 1;\n  }\n  50% {\n    transform: scale(1.2);\n    opacity: 0.8;\n  }\n}\n\n@media (max-width: 380px) {\n  .mobile-countries-grid {\n    grid-template-columns: repeat(2, 1fr);\n    gap: 10px;\n  }\n  \n  .country-circle-name {\n    font-size: 12px;\n  }\n}\n","path":null,"size_bytes":8185,"size_tokens":null},"src/components/MapAsia.js":{"content":"\"use client\"\n\nimport { useState } from \"react\"\nimport { ComposableMap, Geographies, Geography, Marker } from \"react-simple-maps\"\nimport \"./WorldMap.css\"\n\nconst geoUrl = \"https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json\"\n\n// ---------------------------\n// LISTA DE PAISES ASIA (excluye Turkey, Iran y paÃ­ses Ã¡rabes)\n// ---------------------------\nconst asiaCountries = [\n  \"China\",\"India\",\"Japan\",\"South Korea\",\"Indonesia\",\"Pakistan\",\"Bangladesh\",\"Philippines\"\n]\n\n// ---------------------------\n// DATOS DE PAISES (POPUPS)\n// ---------------------------\nconst countryData = {\n  china: { name: \"China\", coordinates: [116.4074, 39.9042], image: \"/china-beijing.jpg\", description: \"La naciÃ³n mÃ¡s poblada del mundo.\", hasConflict: false },\n  india: { name: \"India\", coordinates: [77.209, 28.6139], image: \"/india-delhi.jpg\", description: \"Gigante del sur de Asia.\", hasConflict: false },\n  japan: { name: \"JapÃ³n\", coordinates: [139.6917, 35.6895], image: \"/japan-tokyo.jpg\", description: \"Islas tecnolÃ³gicas del PacÃ­fico.\", hasConflict: false },\n  south_korea: { name: \"Corea del Sur\", coordinates: [126.978, 37.5665], image: \"/korea-seoul.jpg\", description: \"Potencia tecnolÃ³gica asiÃ¡tica.\", hasConflict: false },\n  indonesia: { name: \"Indonesia\", coordinates: [106.8456, -6.2088], image: \"/indonesia-jakarta.jpg\", description: \"ArchipiÃ©lago mÃ¡s grande del mundo.\", hasConflict: false },\n}\n\n// ---------------------------\n// COMPONENTE\n// ---------------------------\nexport default function MapAsia() {\n  const [hoveredCountry, setHoveredCountry] = useState(null)\n\n  const getCountryId = (geo) => {\n    const name = geo.properties.name.toLowerCase()\n    if (geo.id === \"732\" || name === \"morocco\" || name === \"western sahara\") return \"morocco\"\n    const israelIds = [\"376\", \"275\"]\n    const israelNames = [\"israel\", \"palestine\", \"west bank\", \"gaza\"]\n    if (israelIds.includes(geo.id) || israelNames.includes(name)) return \"palestine\"\n    if (name === \"saudi arabia\") return \"saudi\"\n    if (name === \"united arab emirates\") return \"uae\"\n    return name.replace(/\\s+/g, \"-\")\n  }\n\n  const handleCountryClick = (countryId) => {\n    const routeId = countryId === \"israel\" ? \"palestine\" : countryId\n    window.location.href = `/country/${routeId}`\n  }\n\n  return (\n    <div className=\"map-wrapper\" style={{ position: \"relative\" }}>\n      <ComposableMap\n        projection=\"geoMercator\"\n        projectionConfig={{ scale: 550, center: [100, 35] }}\n        style={{ width: \"100%\", height: \"105%\" }}\n      >\n        <Geographies geography={geoUrl}>\n          {({ geographies }) =>\n            geographies\n              .filter((geo) => asiaCountries.includes(geo.properties.name))\n              .map((geo) => {\n                const countryId = getCountryId(geo)\n                const isHovered = hoveredCountry === countryId\n                return (\n                  <Geography\n                    key={geo.rsmKey}\n                    geography={geo}\n                    onClick={() => handleCountryClick(countryId)}\n                    onMouseEnter={() => setHoveredCountry(countryId)}\n                    onMouseLeave={() => setHoveredCountry(null)}\n                    fill={isHovered ? \"#6e7b4e46\" : \"#000000ff\"}\n                    stroke=\"#e6c55b\"\n                    strokeWidth={0.5}\n                    style={{\n                      default: { outline: \"none\", cursor: \"pointer\" },\n                      hover: { outline: \"none\", fill: \"#6e7b4e46\" },\n                      pressed: { outline: \"none\" },\n                    }}\n                  />\n                )\n              })\n          }\n        </Geographies>\n\n        {/* MARKERS DE CONFLICTO */}\n        {Object.entries(countryData).map(([id, data]) => {\n          if (!data.hasConflict) return null\n          return (\n            <Marker key={id} coordinates={data.coordinates}>\n              <g onMouseEnter={() => setHoveredCountry(id)} onMouseLeave={() => setHoveredCountry(null)} style={{ cursor: \"pointer\" }}>\n                <circle r=\"20\" className=\"conflict-marker-pulse\" />\n                <circle r=\"20\" className=\"conflict-marker-pulse\" style={{ animationDelay: \"0.5s\" }} />\n                <circle r=\"20\" className=\"conflict-marker-pulse\" style={{ animationDelay: \"1s\" }} />\n                <circle r=\"20\" className=\"conflict-marker-pulse\" style={{ animationDelay: \"1.5s\" }} />\n                <circle r=\"6\" fill=\"#ef4444\" stroke=\"white\" strokeWidth=\"1\" />\n              </g>\n            </Marker>\n          )\n        })}\n      </ComposableMap>\n\n      {/* POPUP CIRCULAR */}\n      {hoveredCountry && countryData[hoveredCountry] && (\n        <div\n          className=\"country-popup-circle\"\n          style={{\n            position: \"absolute\",\n            top: \"-90px\",\n            left: \"320px\",\n            width: 200,\n            height: 200,\n            borderRadius: \"50%\",\n            display: \"flex\",\n            flexDirection: \"column\",\n            alignItems: \"center\",\n            justifyContent: \"center\",\n            backgroundColor: \"#ffffffee\",\n            boxShadow: \"0 0 15px rgba(0,0,0,0.3)\",\n            padding: \"10px\",\n            textAlign: \"center\",\n          }}\n        >\n          <img src={countryData[hoveredCountry].image} alt={countryData[hoveredCountry].name} style={{ width: \"80px\", height: \"80px\", borderRadius: \"50%\", marginBottom: \"10px\", objectFit: \"cover\" }} />\n          <h3 style={{ fontSize: \"16px\", margin: 0 }}>{countryData[hoveredCountry].name}</h3>\n          <p style={{ fontSize: \"12px\", margin: 0 }}>{countryData[hoveredCountry].description}</p>\n        </div>\n      )}\n    </div>\n  )\n}\n","path":null,"size_bytes":5625,"size_tokens":null},"src/layout/CountryContent.jsx":{"content":"\"use client\"\n\nimport { useEffect, useState } from \"react\"\nimport { useLanguage } from \"../context/LanguageContext\"\nimport \"./country-content.css\"\nimport \"./timeline.css\"\nimport MediaGallery from \"./MediaGallery\"\n\nexport default function CountryContent({ countryCode, section, searchTerm = \"\" }) {\n  const { lang, t } = useLanguage()\n  const [loading, setLoading] = useState(true)\n  const [view, setView] = useState(\"index\")\n  const [items, setItems] = useState([])\n  const [selectedItem, setSelectedItem] = useState(null)\n  const [selectedLetter, setSelectedLetter] = useState(null)\n  const [availableLetters, setAvailableLetters] = useState([])\n  const [currentCategory, setCurrentCategory] = useState(null)\n  const [analysesIndex, setAnalysesIndex] = useState(null)\n  const [globalTerminologyResults, setGlobalTerminologyResults] = useState([])\n  const [isGlobalSearching, setIsGlobalSearching] = useState(false)\n  const [isChaptersMenuOpen, setIsChaptersMenuOpen] = useState(false)\n  const [filterYear, setFilterYear] = useState(\"\")\n  const [filterMonth, setFilterMonth] = useState(\"\")\n\n  const months = [\n    { value: 1, label: \"Enero\" },\n    { value: 2, label: \"Febrero\" },\n    { value: 3, label: \"Marzo\" },\n    { value: 4, label: \"Abril\" },\n    { value: 5, label: \"Mayo\" },\n    { value: 6, label: \"Junio\" },\n    { value: 7, label: \"Julio\" },\n    { value: 8, label: \"Agosto\" },\n    { value: 9, label: \"Septiembre\" },\n    { value: 10, label: \"Octubre\" },\n    { value: 11, label: \"Noviembre\" },\n    { value: 12, label: \"Diciembre\" }\n  ]\n\n  useEffect(() => {\n    if (searchTerm.trim().length > 0) {\n      if (section.startsWith(\"terminology-\")) {\n        performGlobalTerminologySearch(searchTerm)\n      }\n      // Search is now applied via filteredItems for other sections\n    } else {\n      setGlobalTerminologyResults([])\n      setIsGlobalSearching(false)\n    }\n  }, [searchTerm, section, lang])\n\n  async function performGlobalTerminologySearch(term) {\n    setIsGlobalSearching(true)\n    const categories = [\"personajes\", \"organizaciones\", \"conceptos\"]\n    const allLetters = \"abcdefghijklmnopqrstuvwxyz\".split(\"\")\n    let allResults = []\n\n    try {\n      for (const category of categories) {\n        for (const letter of allLetters) {\n          try {\n            const res = await fetch(`/data/${lang}/terminology/${category}/${letter}.json`)\n            if (res.ok) {\n              const json = await res.json()\n              const filtered = (json.items || []).filter((item) => {\n                const searchLower = term.toLowerCase()\n                return (\n                  item.name?.toLowerCase().includes(searchLower) ||\n                  item.title?.toLowerCase().includes(searchLower) ||\n                  item.content?.toLowerCase().includes(searchLower)\n                )\n              })\n              allResults = [...allResults, ...filtered.map((item) => ({ ...item, category, letter }))]\n            }\n          } catch {\n            // Skip missing files\n          }\n        }\n      }\n      setGlobalTerminologyResults(allResults)\n    } catch (err) {\n      console.error(\"[v0] Error in global terminology search:\", err)\n    }\n    setIsGlobalSearching(false)\n  }\n\n  useEffect(() => {\n    loadSection()\n  }, [section, countryCode, lang])\n\n  async function loadSection() {\n    setLoading(true)\n    setView(\"index\")\n    setSelectedItem(null)\n    setSelectedLetter(null)\n    setItems([])\n    setAnalysesIndex(null)\n    setGlobalTerminologyResults([])\n    setIsGlobalSearching(false)\n    setFilterYear(\"\")\n    setFilterMonth(\"\")\n\n    try {\n      if (section.startsWith(\"terminology-\")) {\n        const category = section.replace(\"terminology-\", \"\")\n        setCurrentCategory(category)\n        const res = await fetch(`/data/${lang}/terminology.index.json`)\n        const json = await res.json()\n        const categoryData = json.categories.find((c) => c.id === category)\n        if (categoryData) setAvailableLetters(categoryData.letters.map((l) => l.toUpperCase()))\n        setView(\"letters\")\n      } else if ([\"testimonies\", \"analysts\", \"genocides\"].includes(section)) {\n        const res = await fetch(`/data/${lang}/${countryCode}/${section}.index.json`)\n        const json = res.ok ? await res.json() : { items: [] }\n        setItems(json.items || [])\n        setView(json.items?.length ? \"grid\" : \"empty\")\n      } else if (section === \"resistance\") {\n        const res = await fetch(`/data/${lang}/${countryCode}/resistance/resistance.index.json`)\n        const json = res.ok ? await res.json() : { items: [] }\n        setItems(json.items || [])\n        setView(json.items?.length ? \"grid\" : \"empty\")\n      } else if (section === \"timeline\") {\n        const res = await fetch(`/data/${lang}/${countryCode}/timeline/timeline.index.json`)\n        const json = res.ok ? await res.json() : { items: [] }\n        setItems(json.items || [])\n        setView(json.items?.length ? \"timeline\" : \"empty\")\n      } else if (section === \"fototeca\" || section === \"fototeca-photos\" || section === \"fototeca-videos\") {\n        const res = await fetch(`/data/${lang}/${countryCode}/fototeca/fototeca.index.json`)\n        const json = res.ok ? await res.json() : { items: [] }\n        let mediaItems = json.items || []\n        \n        if (section === \"fototeca-photos\") {\n          mediaItems = mediaItems.filter(item => item.type === 'image')\n        } else if (section === \"fototeca-videos\") {\n          mediaItems = mediaItems.filter(item => item.type === 'video')\n        }\n        \n        setItems(mediaItems)\n        setView(mediaItems.length ? \"fototeca\" : \"empty\")\n      } else if ([\"media-gallery-images\", \"media-gallery-videos\"].includes(section)) {\n        let mediaItems = []\n\n        if (section === \"media-gallery-images\") {\n          const resImages = await fetch(`/data/${lang}/${countryCode}/media/images.json`)\n          const imagesJson = resImages.ok ? await resImages.json() : { images: [] }\n          mediaItems = (imagesJson.images || []).map((img) => ({\n            ...img,\n            url: img.url || img.image || \"/placeholder.svg\",\n            type: \"image\",\n          }))\n        } else if (section === \"media-gallery-videos\") {\n          const resVideos = await fetch(`/data/${lang}/${countryCode}/media/videos.json`)\n          const videosJson = resVideos.ok ? await resVideos.json() : { videos: [] }\n          mediaItems = (videosJson.videos || []).map((vid) => ({\n            ...vid,\n            url: vid.url || vid.video,\n            type: \"video\",\n          }))\n        }\n\n        if (mediaItems.length > 0) {\n          setItems(mediaItems)\n          setView(\"media-gallery\")\n        } else {\n          setView(\"empty\")\n        }\n      } else if (section === \"description\") {\n        const res = await fetch(`/data/${lang}/${countryCode}/description.json`)\n        if (!res.ok) {\n          setView(\"empty\")\n        } else {\n          const json = await res.json()\n          if (json.chapters) {\n            setItems(json.chapters)\n            setSelectedItem(json.chapters[0] || null)\n            setView(\"chapter-index\")\n          } else {\n            setSelectedItem(json)\n            setView(\"article\")\n          }\n        }\n      } else if (section === \"velum\") {\n        const res = await fetch(`/data/${lang}/velum/velum.index.json`)\n        const json = res.ok ? await res.json() : { items: [] }\n        setItems(json.items || [])\n        setView(json.items?.length ? \"velum-grid\" : \"empty\")\n      }\n    } catch (err) {\n      console.error(\"[v0] Error loading section:\", err)\n      setView(\"empty\")\n    }\n\n    setLoading(false)\n  }\n\n  async function showItemsForLetter(letter) {\n    setSelectedLetter(letter)\n    try {\n      const res = await fetch(`/data/${lang}/terminology/${currentCategory}/${letter.toLowerCase()}.json`)\n      const json = res.ok ? await res.json() : { items: [] }\n      setItems(json.items || [])\n      setView(\"grid\")\n    } catch {\n      setItems([])\n      setView(\"grid\")\n    }\n  }\n\n  async function loadItemDetail(item) {\n    try {\n      if (section.startsWith(\"terminology-\")) {\n        const category = item.category || section.split(\"-\")[1]\n        const letter = item.letter || item.name?.charAt(0).toLowerCase()\n\n        try {\n          const res = await fetch(`/data/${lang}/terminology/${category}/${letter}.json`)\n          if (res.ok) {\n            const json = await res.json()\n            const fullItem = json.items?.find((i) => i.id === item.id || i.name === item.name)\n            if (fullItem) {\n              setSelectedItem({ ...fullItem, category })\n            } else {\n              setSelectedItem({ ...item, category })\n            }\n          } else {\n            setSelectedItem({ ...item, category })\n          }\n        } catch {\n          setSelectedItem({ ...item, category })\n        }\n\n        setView(\"article-with-letters\")\n        return\n      }\n\n      let path = \"\"\n      if (section === \"testimonies\") path = `/data/${lang}/${countryCode}/testimonies/${item.id}.json`\n      else if (section === \"analysts\") path = `/data/${lang}/${countryCode}/analysts/${item.id}.json`\n      else if (section === \"genocides\") path = `/data/${lang}/${countryCode}/genocides/${item.id}.json`\n      else if (section === \"resistance\") path = `/data/${lang}/${countryCode}/resistance/${item.id}.json`\n\n      if (path) {\n        const res = await fetch(path)\n\n        if (res.ok) {\n          const json = await res.json()\n\n          if (json.analyses && Array.isArray(json.analyses)) {\n  // Caso ANALYSTS (mÃºltiples anÃ¡lisis)\n  setAnalysesIndex({ ...json, type: \"analysis\" })\n  setView(\"analyses-index\")\n} else if (json.testimonies && Array.isArray(json.testimonies)) {\n  // Caso TESTIMONIES (mÃºltiples testimonios por persona)\n  setAnalysesIndex({ ...json, type: \"testimony\" })\n  setView(\"analyses-index\")\n} else {\n  // Caso normal (artÃ­culo Ãºnico)\n  setSelectedItem(json)\n  setView(\"article\")\n}\n\n        }\n      }\n    } catch (err) {\n      console.error(\"[v0] Error loading item:\", err)\n    }\n  }\n\n  async function loadSpecificAnalysis(analysisId) {\n    try {\n      const isTestimony = analysesIndex?.type === \"testimony\"\n      const isResistance = section === \"resistance\"\n      let baseFolder = \"analysts\"\n      if (isTestimony) baseFolder = \"testimonies\"\n      if (isResistance) baseFolder = \"resistance\"\n\n      const path = `/data/${lang}/${countryCode}/${baseFolder}/${analysesIndex.id}/${analysisId}.json`\n\n      const res = await fetch(path)\n      if (res.ok) {\n        const json = await res.json()\n        setSelectedItem(json)\n        setView(\"article\")\n      }\n    } catch (err) {\n      console.error(\"[v0] Error loading specific analysis:\", err)\n    }\n  }\n\n  async function loadTimelineDetail(item) {\n    try {\n      const path = `/data/${lang}/${countryCode}/timeline/${item.id}.json`\n      const res = await fetch(path)\n      if (res.ok) {\n        const json = await res.json()\n        setSelectedItem(json)\n        setView(\"timeline-article\")\n      }\n    } catch (err) {\n      console.error(\"[v0] Error loading timeline item:\", err)\n    }\n  }\n\n  async function loadVelumArticle(article) {\n    try {\n      const path = `/data/${lang}/velum/${article.id}.json`\n      const res = await fetch(path)\n      if (res.ok) {\n        const json = await res.json()\n        setSelectedItem(json)\n        setView(\"velum-article\")\n      }\n    } catch (err) {\n      console.error(\"[v0] Error loading VELUM article:\", err)\n    }\n  }\n\n  const filteredItems = items.filter((item) => {\n    if (!searchTerm) return true\n    const searchLower = searchTerm.toLowerCase()\n    return (\n      item.name?.toLowerCase().includes(searchLower) ||\n      item.title?.toLowerCase().includes(searchLower) ||\n      item.content?.toLowerCase().includes(searchLower) ||\n      item.shortDescription?.toLowerCase().includes(searchLower) ||\n      item.description?.toLowerCase().includes(searchLower) ||\n      item.bio?.toLowerCase().includes(searchLower) ||\n      item.summary?.toLowerCase().includes(searchLower) ||\n      item.paragraphs?.some((p) => p.toLowerCase().includes(searchLower))\n    )\n  })\n\n  if (loading) return <div className=\"content-loading\">{t(\"loading\")}</div>\n  if (view === \"empty\") return <div className=\"content-inner\">{t(\"no-content\")}</div>\n\n  const showAlphabetBar =\n    section.startsWith(\"terminology-\") && (view === \"letters\" || view === \"article-with-letters\" || view === \"grid\")\n\n  if (showAlphabetBar) {\n    const allLetters = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\".split(\"\")\n\n    return (\n      <div className=\"content-inner\">\n        <h2 className=\"section-header\">\n          {t(\"terminology\")} -{\" \"}\n          {currentCategory === \"personajes\"\n            ? t(\"characters\")\n            : currentCategory === \"organizaciones\"\n              ? t(\"organizations\")\n              : t(\"concepts\")}\n        </h2>\n\n        {/* Alphabet bar always visible in terminology */}\n        <div className=\"alphabet-bar\">\n          {allLetters.map((letter) => {\n            const hasContent = availableLetters.includes(letter)\n            return (\n              <span\n                key={letter}\n                className={`letter ${hasContent ? \"has-content\" : \"no-content\"} ${selectedLetter === letter ? \"active\" : \"\"}`}\n                onClick={() => {\n                  if (hasContent) {\n                    showItemsForLetter(letter)\n                    setSelectedItem(null)\n                  }\n                }}\n                role={hasContent ? \"button\" : undefined}\n                tabIndex={hasContent ? 0 : -1}\n                style={{ cursor: hasContent ? \"pointer\" : \"default\" }}\n                onKeyDown={(e) => {\n                  if (hasContent && (e.key === \"Enter\" || e.key === \" \")) {\n                    e.preventDefault()\n                    showItemsForLetter(letter)\n                    setSelectedItem(null)\n                  }\n                }}\n              >\n                {letter}\n              </span>\n            )\n          })}\n        </div>\n\n        {searchTerm && isGlobalSearching && (\n          <div className=\"search-results-info\">{t(\"searching-global-terminology\")}</div>\n        )}\n\n        {searchTerm && !isGlobalSearching && globalTerminologyResults.length > 0 && (\n          <div>\n            <div className=\"search-results-info\">\n              {globalTerminologyResults.length} {t(\"results-found\")} \"{searchTerm}\"\n            </div>\n            <div className=\"items-grid\">\n              {globalTerminologyResults.map((item, idx) => (\n                <div\n                  key={`${item.id}-${idx}`}\n                  className=\"item-card\"\n                  onClick={() => loadItemDetail(item)}\n                  onKeyDown={(e) => {\n                    if (e.key === \"Enter\" || e.key === \" \") {\n                      e.preventDefault()\n                      loadItemDetail(item)\n                    }\n                  }}\n                  role=\"button\"\n                  tabIndex={0}\n                  style={{ cursor: \"pointer\" }}\n                >\n                  <div className=\"item-icon\">\n                    <img src={item.image || \"/placeholder.svg?height=80&width=80\"} alt={item.name} />\n                  </div>\n                  <div className=\"item-name\">{item.name}</div>\n                  <div className=\"item-category\">\n                    {item.category === \"personajes\"\n                      ? t(\"characters\")\n                      : item.category === \"organizaciones\"\n                        ? t(\"organizations\")\n                        : t(\"concepts\")}\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n        )}\n\n        {searchTerm && !isGlobalSearching && globalTerminologyResults.length === 0 && (\n          <div className=\"no-results\">\n            {t(\"no-results-found\")} \"{searchTerm}\" {t(\"in-global-terminology\")}.\n          </div>\n        )}\n\n        {/* Show letter content grid when not searching and a letter is selected */}\n        {!searchTerm && view === \"grid\" && selectedLetter && (\n          <div className=\"items-grid\">\n            {filteredItems.map((item) => (\n              <div\n                key={item.id}\n                className=\"item-card\"\n                onClick={() => loadItemDetail(item)}\n                onKeyDown={(e) => {\n                  if (e.key === \"Enter\" || e.key === \" \") {\n                    e.preventDefault()\n                    loadItemDetail(item)\n                  }\n                }}\n                role=\"button\"\n                tabIndex={0}\n                style={{ cursor: \"pointer\" }}\n              >\n                <div className=\"item-icon\">\n                  <img src={item.image || \"/placeholder.svg?height=80&width=80\"} alt={item.name} />\n                </div>\n                <div className=\"item-name\">{item.name}</div>\n              </div>\n            ))}\n          </div>\n        )}\n\n        {/* Show article with letters visible */}\n        {view === \"article-with-letters\" && selectedItem && (\n          <article className=\"article-content\">\n            <button\n              className=\"back-button\"\n              onClick={() => {\n                setSelectedItem(null)\n                setView(\"grid\")\n              }}\n            >\n              {t(\"back-button\")}\n            </button>\n            <h1 className=\"article-title\">{selectedItem.title || selectedItem.name}</h1>\n            <div className=\"article-body\">\n              {selectedItem.image && (\n                <div className=\"article-media\">\n                  <img\n                    src={selectedItem.image || \"/placeholder.svg\"}\n                    alt={selectedItem.title || selectedItem.name}\n                    className=\"article-image\"\n                  />\n                </div>\n              )}\n              {selectedItem.video && (\n                <div className=\"article-media\">\n                  <video src={selectedItem.video} controls className=\"article-video\" />\n                </div>\n              )}\n              <div className=\"article-text\">\n                {selectedItem.content && <p>{selectedItem.content}</p>}\n                {selectedItem.paragraphs && selectedItem.paragraphs.map((p, i) => <p key={i}>{p}</p>)}\n              </div>\n            </div>\n          </article>\n        )}\n      </div>\n    )\n  }\n\n  if (view === \"analyses-index\" && analysesIndex) {\n    const itemsList = analysesIndex.type === \"testimony\" \n      ? analysesIndex.testimonies \n      : (analysesIndex.entries || analysesIndex.analyses)\n    const hasMultipleItems = itemsList && itemsList.length > 1\n\n    return (\n      <div className=\"content-inner\">\n        <button className=\"back-button\" onClick={() => loadSection()}>\n          {t(\"back-button\")}\n        </button>\n        <div className=\"analyst-header\">\n          {analysesIndex.image && (\n            <img src={analysesIndex.image || \"/placeholder.svg\"} alt={analysesIndex.name} className=\"analyst-photo\" />\n          )}\n          <div className=\"analyst-info\">\n            <h1 className=\"analyst-name\">{analysesIndex.name}</h1>\n            {analysesIndex.bio && <p className=\"analyst-bio\">{analysesIndex.bio}</p>}\n          </div>\n        </div>\n        <h2 className=\"analyses-list-title\">\n          {analysesIndex.type === \"testimony\"\n            ? t(\"available-testimonies\")\n            : section === \"resistance\" \n              ? (t(\"resistance-entries\") || \"Entradas de resistencia\")\n              : t(\"available-analyses\")}\n        </h2>\n\n        <div className={`analyses-list ${hasMultipleItems ? \"timeline-style\" : \"\"}`}>\n          {itemsList?.map((analysis, index) => (\n            <div\n              key={analysis.id}\n              className={`analysis-card ${hasMultipleItems ? \"timeline-card\" : \"\"}`}\n              onClick={() => loadSpecificAnalysis(analysis.id)}\n              onKeyDown={(e) => {\n                if (e.key === \"Enter\" || e.key === \" \") {\n                  e.preventDefault()\n                  loadSpecificAnalysis(analysis.id)\n                }\n              }}\n              role=\"button\"\n              tabIndex={0}\n              style={{ cursor: \"pointer\" }}\n            >\n              {hasMultipleItems && <div className=\"timeline-dot\"></div>}\n              <div className=\"analysis-card-content\">\n                <h3 className=\"analysis-title\">{analysis.title}</h3>\n                {analysis.date && <p className=\"analysis-date\">{analysis.date}</p>}\n                {analysis.summary && <p className=\"analysis-summary\">{analysis.summary}</p>}\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n    )\n  }\n\n  if (section === \"description\" && view === \"chapter-index\") {\n    return (\n      <div className=\"description-wrapper\">\n        <div className=\"chapters-menu-sticky\">\n          <h2 className=\"section-header-inline\">{t(\"conflict-description\")}</h2>\n          <div className=\"chapters-nav-container\">\n            <button className=\"chapters-hamburger-btn\" onClick={() => setIsChaptersMenuOpen(!isChaptersMenuOpen)}>\n              <span>â˜°</span> <span>ÃNDICE DE SECCIONES</span>\n            </button>\n            {isChaptersMenuOpen && (\n              <div className=\"chapters-dropdown-menu\">\n                {filteredItems.map((ch) => (\n                  <div\n                    key={ch.id}\n                    className={`chapter-dropdown-item ${selectedItem?.id === ch.id ? \"active\" : \"\"}`}\n                    onClick={() => {\n                      setSelectedItem(ch)\n                      setIsChaptersMenuOpen(false)\n                    }}\n                  >\n                    {ch.title}\n                  </div>\n                ))}\n              </div>\n            )}\n            <div className=\"chapters-horizontal-menu desktop-only\">\n              {filteredItems.map((ch) => (\n                <div\n                  key={ch.id}\n                  className={`chapter-tab ${selectedItem?.id === ch.id ? \"active\" : \"\"}`}\n                  onClick={() => setSelectedItem(ch)}\n                  onKeyDown={(e) => {\n                    if (e.key === \"Enter\" || e.key === \" \") {\n                      e.preventDefault()\n                      setSelectedItem(ch)\n                    }\n                  }}\n                  role=\"button\"\n                  tabIndex={0}\n                  style={{ cursor: \"pointer\" }}\n                >\n                  {ch.title}\n                </div>\n              ))}\n            </div>\n          </div>\n        </div>\n        {searchTerm && filteredItems.length < items.length && (\n          <div className=\"search-results-info\" style={{ padding: \"1rem\" }}>\n            {t(\"showing-results\")} {filteredItems.length} {t(\"of\")} {items.length} {t(\"for-search-term\")} \"{searchTerm}\"\n          </div>\n        )}\n        {searchTerm && filteredItems.length === 0 && (\n          <div className=\"no-results\" style={{ padding: \"1rem\" }}>\n            {t(\"no-results-found\")} \"{searchTerm}\"\n          </div>\n        )}\n        <div className=\"chapter-content-scrollable\">\n          {selectedItem && (\n            <article className=\"article-content\">\n              <h1 className=\"article-title\">{selectedItem.title}</h1>\n              <div className=\"article-body\">\n                {selectedItem.image && (\n                  <div className=\"article-media\">\n                    <img\n                      src={selectedItem.image || \"/placeholder.svg\"}\n                      alt={selectedItem.title || selectedItem.name}\n                      className=\"article-image\"\n                    />\n                  </div>\n                )}\n                {selectedItem.video && (\n                  <div className=\"article-media\">\n                    <video src={selectedItem.video} controls className=\"article-video\" />\n                  </div>\n                )}\n                <div className=\"article-text\">\n                  {selectedItem.content && <p>{selectedItem.content}</p>}\n                  {selectedItem.paragraphs && selectedItem.paragraphs.map((p, i) => <p key={i}>{p}</p>)}\n                </div>\n              </div>\n            </article>\n          )}\n        </div>\n      </div>\n    )\n  }\n\n  if (view === \"media-gallery\") {\n    return (\n      <div className=\"content-inner\">\n        <h2 className=\"section-header\">{t(\"media-gallery\")}</h2>\n        {searchTerm && (\n          <div className=\"search-results-info\">\n            {t(\"showing-results\")} {filteredItems.length} {t(\"of\")} {items.length} {t(\"for-search-term\")} \"{searchTerm}\"\n          </div>\n        )}\n        <MediaGallery items={filteredItems} />\n        {filteredItems.length === 0 && searchTerm && (\n          <div className=\"no-results\">\n            {t(\"no-results-found\")} \"{searchTerm}\"\n          </div>\n        )}\n      </div>\n    )\n  }\n\n  if (view === \"grid\") {\n    return (\n      <div className=\"content-inner\">\n        {searchTerm && (\n          <div className=\"search-results-info\">\n            {t(\"showing-results\")} {filteredItems.length} {t(\"of\")} {items.length} {t(\"for-search-term\")} \"{searchTerm}\"\n          </div>\n        )}\n        <div className=\"items-grid\">\n          {filteredItems.map((item) => (\n            <div\n              key={item.id}\n              className=\"item-card\"\n              onClick={() => loadItemDetail(item)}\n              onKeyDown={(e) => {\n                if (e.key === \"Enter\" || e.key === \" \") {\n                  e.preventDefault()\n                  loadItemDetail(item)\n                }\n              }}\n              role=\"button\"\n              tabIndex={0}\n              style={{ cursor: \"pointer\" }}\n            >\n              <div className=\"item-icon\">\n                <img src={item.image || \"/placeholder.svg?height=80&width=80\"} alt={item.name} />\n              </div>\n              <div className=\"item-name\">{item.name}</div>\n            </div>\n          ))}\n        </div>\n        {filteredItems.length === 0 && searchTerm && (\n          <div className=\"no-results\">\n            {t(\"no-results-found\")} \"{searchTerm}\"\n          </div>\n        )}\n      </div>\n    )\n  }\n\n  if (view === \"article\" && selectedItem) {\n    const isArabic = lang === \"ar\"\n    const textClasses = `article-text ${isArabic ? 'article-text-arabic' : ''}`\n    const titleClasses = `article-title ${isArabic ? 'amiri-font' : ''}`\n\n    const renderMediaGallery = (media) => {\n      if (!media || media.length === 0) return null\n      return (\n        <div className=\"entry-media-gallery\">\n          {media.map((item, idx) => {\n            const mediaType = item.type || (item.url?.match(/\\.(mp4|webm|ogg)/i) ? 'video' : item.url?.match(/\\.(mp3|wav|ogg)/i) ? 'audio' : 'image')\n            return (\n              <div key={idx} className=\"entry-media-item\">\n                {mediaType === 'video' && (\n                  <>\n                    <video src={item.url} controls />\n                    <span className=\"entry-media-type\">ðŸ“¹</span>\n                  </>\n                )}\n                {mediaType === 'audio' && (\n                  <div className=\"audio-player-container\">\n                    <audio src={item.url} controls />\n                    <span className=\"audio-player-label\">{item.caption || 'Audio'}</span>\n                  </div>\n                )}\n                {mediaType === 'image' && (\n                  <>\n                    <img src={item.url} alt={item.caption || 'Media'} />\n                    <span className=\"entry-media-type\">ðŸ“·</span>\n                  </>\n                )}\n                {item.caption && mediaType !== 'audio' && (\n                  <div className=\"entry-media-caption\">{item.caption}</div>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      )\n    }\n\n    return (\n      <div className=\"content-inner\" dir={isArabic ? 'rtl' : 'ltr'} lang={isArabic ? 'ar' : lang}>\n        <button\n          className=\"back-button\"\n          onClick={() => {\n            if (analysesIndex) {\n              setView(\"analyses-index\")\n            } else {\n              loadSection()\n            }\n          }}\n        >\n          {t(\"back-button\")}\n        </button>\n        <article className=\"article-content\">\n          <h1 className={titleClasses}>{selectedItem.title || selectedItem.name}</h1>\n          <div className=\"article-body\">\n            {selectedItem.image && (\n              <div className=\"article-media\">\n                <img\n                  src={selectedItem.image || \"/placeholder.svg\"}\n                  alt={selectedItem.title || selectedItem.name}\n                  className=\"article-image\"\n                />\n              </div>\n            )}\n            {selectedItem.video && (\n              <div className=\"article-media\">\n                <video src={selectedItem.video} controls className=\"article-video\" />\n              </div>\n            )}\n            {selectedItem.media && renderMediaGallery(selectedItem.media)}\n            <div className={textClasses}>\n              {selectedItem.content && <p>{selectedItem.content}</p>}\n              {selectedItem.paragraphs && selectedItem.paragraphs.map((p, i) => <p key={i}>{p}</p>)}\n            </div>\n          </div>\n        </article>\n      </div>\n    )\n  }\n\n  if (view === \"timeline\") {\n    const years = [...new Set(items.map(i => i.year).filter(Boolean))].sort((a, b) => b - a)\n    \n    const timelineFiltered = items.filter(item => {\n      if (filterYear && item.year !== parseInt(filterYear)) return false\n      if (filterMonth && item.month !== parseInt(filterMonth)) return false\n      if (searchTerm) {\n        const searchLower = searchTerm.toLowerCase()\n        return (\n          item.title?.toLowerCase().includes(searchLower) ||\n          item.summary?.toLowerCase().includes(searchLower) ||\n          item.date?.toLowerCase().includes(searchLower)\n        )\n      }\n      return true\n    })\n\n    return (\n      <div className=\"timeline-container\">\n        <div className=\"timeline-header\">\n          <h2>{t(\"timeline\")}</h2>\n          <p>{t(\"timeline-subtitle\")}</p>\n        </div>\n        <div className=\"timeline-filters\">\n          <select \n            value={filterYear} \n            onChange={(e) => setFilterYear(e.target.value)}\n            className=\"timeline-filter-select\"\n          >\n            <option value=\"\">{t(\"all-years\") || \"Todos los aÃ±os\"}</option>\n            {years.map(y => (\n              <option key={y} value={y}>{y}</option>\n            ))}\n          </select>\n          <select \n            value={filterMonth} \n            onChange={(e) => setFilterMonth(e.target.value)}\n            className=\"timeline-filter-select\"\n          >\n            <option value=\"\">{t(\"all-months\") || \"Todos los meses\"}</option>\n            {months.map(m => (\n              <option key={m.value} value={m.value}>{m.label}</option>\n            ))}\n          </select>\n          {(filterYear || filterMonth) && (\n            <button \n              className=\"timeline-filter-clear\"\n              onClick={() => { setFilterYear(\"\"); setFilterMonth(\"\"); }}\n            >\n              {t(\"clear-filters\") || \"Limpiar filtros\"}\n            </button>\n          )}\n        </div>\n        {timelineFiltered.length === 0 ? (\n          <div className=\"timeline-empty\">\n            {t(\"no-events-found\") || \"No se encontraron eventos con los filtros seleccionados\"}\n          </div>\n        ) : (\n          <div className=\"timeline-line\">\n            {timelineFiltered.map((item) => (\n              <div\n                key={item.id}\n                className=\"timeline-event\"\n                onClick={() => loadTimelineDetail(item)}\n                onKeyDown={(e) => {\n                  if (e.key === \"Enter\" || e.key === \" \") {\n                    e.preventDefault()\n                    loadTimelineDetail(item)\n                  }\n                }}\n                role=\"button\"\n                tabIndex={0}\n              >\n                <div className=\"timeline-date\">{item.date}</div>\n                <div className=\"timeline-title\">{item.title}</div>\n                <div className=\"timeline-summary\">{item.summary}</div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    )\n  }\n\n  if (view === \"timeline-article\" && selectedItem) {\n    return (\n      <div className=\"content-inner\">\n        <button className=\"back-button\" onClick={() => loadSection()}>\n          {t(\"back-button\")}\n        </button>\n        <div className=\"timeline-article\">\n          <div className=\"timeline-article-media\">\n            {selectedItem.image && (\n              <img src={selectedItem.image} alt={selectedItem.title} />\n            )}\n            {selectedItem.video && (\n              <video src={selectedItem.video} controls />\n            )}\n          </div>\n          <div className=\"timeline-article-content\">\n            <div className=\"timeline-article-date\">{selectedItem.date}</div>\n            <h1 className=\"timeline-article-title\">{selectedItem.title}</h1>\n            <div className=\"timeline-article-text\">\n              {selectedItem.paragraphs && selectedItem.paragraphs.map((p, i) => (\n                <p key={i}>{p}</p>\n              ))}\n            </div>\n            {selectedItem.sources && (\n              <div className=\"timeline-sources\">\n                <h4>{t(\"sources\")}</h4>\n                <ul>\n                  {selectedItem.sources.map((source, i) => (\n                    <li key={i}>{source}</li>\n                  ))}\n                </ul>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  if (view === \"fototeca\") {\n    const fototecaTitle = section === \"fototeca-photos\" ? (t(\"photos\") || \"Fotos\") \n                        : section === \"fototeca-videos\" ? (t(\"videos\") || \"Videos\") \n                        : (t(\"fototeca\") || \"Fototeca\")\n    const fototecaSubtitle = section === \"fototeca-photos\" ? (t(\"photos-subtitle\") || \"GalerÃ­a fotogrÃ¡fica del conflicto\") \n                           : section === \"fototeca-videos\" ? (t(\"videos-subtitle\") || \"Archivo audiovisual del conflicto\") \n                           : (t(\"fototeca-subtitle\") || \"Archivo visual del conflicto\")\n    return (\n      <div className=\"fototeca-container\">\n        <div className=\"fototeca-header\">\n          <h2>{fototecaTitle}</h2>\n          <p>{fototecaSubtitle}</p>\n        </div>\n        <div className=\"fototeca-grid\">\n          {items.map((item) => (\n            <div\n              key={item.id}\n              className={`fototeca-item ${item.type}`}\n              onClick={() => {\n                setSelectedItem(item)\n                setView(\"fototeca-detail\")\n              }}\n              role=\"button\"\n              tabIndex={0}\n              onKeyDown={(e) => {\n                if (e.key === \"Enter\" || e.key === \" \") {\n                  e.preventDefault()\n                  setSelectedItem(item)\n                  setView(\"fototeca-detail\")\n                }\n              }}\n            >\n              <div className=\"fototeca-media\">\n                {item.type === \"image\" ? (\n                  <img src={item.url} alt={item.title} />\n                ) : (\n                  <div className=\"fototeca-video-thumb\">\n                    <video src={item.url} />\n                    <div className=\"play-overlay\">â–¶</div>\n                  </div>\n                )}\n              </div>\n              <div className=\"fototeca-info\">\n                <span className=\"fototeca-date\">{item.date}</span>\n                <h3 className=\"fototeca-title\">{item.title}</h3>\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n    )\n  }\n\n  if (view === \"fototeca-detail\" && selectedItem) {\n    return (\n      <div className=\"content-inner\">\n        <button className=\"back-button\" onClick={() => setView(\"fototeca\")}>\n          {t(\"back-button\")}\n        </button>\n        <div className=\"fototeca-detail\">\n          <div className=\"fototeca-detail-media\">\n            {selectedItem.type === \"image\" ? (\n              <img src={selectedItem.url} alt={selectedItem.title} />\n            ) : (\n              <video src={selectedItem.url} controls autoPlay />\n            )}\n          </div>\n          <div className=\"fototeca-detail-info\">\n            <span className=\"fototeca-detail-date\">{selectedItem.date}</span>\n            <h1 className=\"fototeca-detail-title\">{selectedItem.title}</h1>\n            {selectedItem.description && (\n              <p className=\"fototeca-detail-description\">{selectedItem.description}</p>\n            )}\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  if (view === \"velum-grid\") {\n    return (\n      <div className=\"content-inner velum-section\">\n        <div className=\"velum-header\">\n          <h2>{t(\"velum-title\")}</h2>\n          <p className=\"velum-subtitle\">{t(\"velum-subtitle\") || \"Investigaciones y micro-tesis academicas\"}</p>\n        </div>\n        {items.length === 0 ? (\n          <div className=\"velum-empty\">{t(\"velum-no-articles\")}</div>\n        ) : (\n          <div className=\"velum-articles-grid\">\n            {items.map((article) => (\n              <div\n                key={article.id}\n                className=\"velum-article-card\"\n                onClick={() => loadVelumArticle(article)}\n                onKeyDown={(e) => {\n                  if (e.key === \"Enter\" || e.key === \" \") {\n                    e.preventDefault()\n                    loadVelumArticle(article)\n                  }\n                }}\n                role=\"button\"\n                tabIndex={0}\n              >\n                <div className=\"velum-card-meta\">\n                  <span className=\"velum-card-date\">{article.date}</span>\n                  {article.author && <span className=\"velum-card-author\">{article.author}</span>}\n                </div>\n                <h3 className=\"velum-card-title\">{article.title}</h3>\n                {article.abstract && (\n                  <p className=\"velum-card-abstract\">{article.abstract.substring(0, 180)}...</p>\n                )}\n                {article.keywords && article.keywords.length > 0 && (\n                  <div className=\"velum-card-keywords\">\n                    {article.keywords.slice(0, 3).map((kw, i) => (\n                      <span key={i} className=\"velum-keyword-tag\">{kw}</span>\n                    ))}\n                  </div>\n                )}\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    )\n  }\n\n  if (view === \"velum-article\" && selectedItem) {\n    const isArabic = lang === \"ar\"\n\n    return (\n      <div className=\"content-inner velum-article-view\" dir={isArabic ? 'rtl' : 'ltr'} lang={isArabic ? 'ar' : lang}>\n        <button className=\"back-button\" onClick={() => loadSection()}>\n          {t(\"back-button\")}\n        </button>\n        <article className=\"velum-full-article\">\n          <header className=\"velum-article-header\">\n            <h1 className={`velum-article-title ${isArabic ? 'amiri-font' : ''}`}>{selectedItem.title}</h1>\n            <div className=\"velum-article-meta\">\n              {selectedItem.authorImage && (\n                <img src={selectedItem.authorImage} alt={selectedItem.author} className=\"velum-author-image\" />\n              )}\n              <div className=\"velum-meta-text\">\n                {selectedItem.author && <span className=\"velum-author-name\">{selectedItem.author}</span>}\n                {selectedItem.date && <span className=\"velum-article-date\">{selectedItem.date}</span>}\n              </div>\n            </div>\n            {selectedItem.keywords && selectedItem.keywords.length > 0 && (\n              <div className=\"velum-article-keywords\">\n                <span className=\"velum-keywords-label\">{t(\"velum-keywords\")}:</span>\n                {selectedItem.keywords.map((kw, i) => (\n                  <span key={i} className=\"velum-keyword-pill\">{kw}</span>\n                ))}\n              </div>\n            )}\n          </header>\n\n          {selectedItem.abstract && (\n            <div className=\"velum-abstract-section\">\n              <h2>{t(\"velum-abstract\")}</h2>\n              <p className={`velum-abstract-text ${isArabic ? 'amiri-font' : ''}`}>{selectedItem.abstract}</p>\n            </div>\n          )}\n\n          {selectedItem.sections && selectedItem.sections.length > 0 && (\n            <div className=\"velum-content-sections\">\n              {selectedItem.sections.map((section, i) => (\n                <section key={i} className=\"velum-section-block\">\n                  {section.title && <h2 className=\"velum-section-title\">{section.title}</h2>}\n                  <div className={`velum-section-content ${isArabic ? 'amiri-font' : ''}`}>\n                    {section.content.split('\\n').map((para, j) => (\n                      <p key={j}>{para}</p>\n                    ))}\n                  </div>\n                </section>\n              ))}\n            </div>\n          )}\n\n          {selectedItem.bibliography && selectedItem.bibliography.length > 0 && (\n            <div className=\"velum-bibliography\">\n              <h2>{t(\"velum-bibliography\")}</h2>\n              <ul className=\"velum-bibliography-list\">\n                {selectedItem.bibliography.map((ref, i) => (\n                  <li key={i}>{ref}</li>\n                ))}\n              </ul>\n            </div>\n          )}\n        </article>\n      </div>\n    )\n  }\n}\n","path":null,"size_bytes":41257,"size_tokens":null},"README.md":{"content":"# Getting Started with Create React App\n\nThis project was bootstrapped with [Create React App](https://github.com/facebook/create-react-app).\n\n## Available Scripts\n\nIn the project directory, you can run:\n\n### `npm start`\n\nRuns the app in the development mode.\\\nOpen [http://localhost:3000](http://localhost:3000) to view it in your browser.\n\nThe page will reload when you make changes.\\\nYou may also see any lint errors in the console.\n\n### `npm test`\n\nLaunches the test runner in the interactive watch mode.\\\nSee the section about [running tests](https://facebook.github.io/create-react-app/docs/running-tests) for more information.\n\n### `npm run build`\n\nBuilds the app for production to the `build` folder.\\\nIt correctly bundles React in production mode and optimizes the build for the best performance.\n\nThe build is minified and the filenames include the hashes.\\\nYour app is ready to be deployed!\n\nSee the section about [deployment](https://facebook.github.io/create-react-app/docs/deployment) for more information.\n\n### `npm run eject`\n\n**Note: this is a one-way operation. Once you `eject`, you can't go back!**\n\nIf you aren't satisfied with the build tool and configuration choices, you can `eject` at any time. This command will remove the single build dependency from your project.\n\nInstead, it will copy all the configuration files and the transitive dependencies (webpack, Babel, ESLint, etc) right into your project so you have full control over them. All of the commands except `eject` will still work, but they will point to the copied scripts so you can tweak them. At this point you're on your own.\n\nYou don't have to ever use `eject`. The curated feature set is suitable for small and middle deployments, and you shouldn't feel obligated to use this feature. However we understand that this tool wouldn't be useful if you couldn't customize it when you are ready for it.\n\n## Learn More\n\nYou can learn more in the [Create React App documentation](https://facebook.github.io/create-react-app/docs/getting-started).\n\nTo learn React, check out the [React documentation](https://reactjs.org/).\n\n### Code Splitting\n\nThis section has moved here: [https://facebook.github.io/create-react-app/docs/code-splitting](https://facebook.github.io/create-react-app/docs/code-splitting)\n\n### Analyzing the Bundle Size\n\nThis section has moved here: [https://facebook.github.io/create-react-app/docs/analyzing-the-bundle-size](https://facebook.github.io/create-react-app/docs/analyzing-the-bundle-size)\n\n### Making a Progressive Web App\n\nThis section has moved here: [https://facebook.github.io/create-react-app/docs/making-a-progressive-web-app](https://facebook.github.io/create-react-app/docs/making-a-progressive-web-app)\n\n### Advanced Configuration\n\nThis section has moved here: [https://facebook.github.io/create-react-app/docs/advanced-configuration](https://facebook.github.io/create-react-app/docs/advanced-configuration)\n\n### Deployment\n\nThis section has moved here: [https://facebook.github.io/create-react-app/docs/deployment](https://facebook.github.io/create-react-app/docs/deployment)\n\n### `npm run build` fails to minify\n\nThis section has moved here: [https://facebook.github.io/create-react-app/docs/troubleshooting#npm-run-build-fails-to-minify](https://facebook.github.io/create-react-app/docs/troubleshooting#npm-run-build-fails-to-minify)\n","path":null,"size_bytes":3359,"size_tokens":null},"src/pages/Country.js":{"content":"import React from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport CountryLayout from \"../layout/CountryLayout\";\n\nexport default function Country() {\n  const { slug } = useParams();\n\n  return (\n    <CountryLayout>\n      <h2>{slug.toUpperCase()}</h2>\n      <p>AquÃ­ cargaremos las secciones dinÃ¡micas.</p>\n    </CountryLayout>\n  );\n}\n","path":null,"size_bytes":347,"size_tokens":null},"src/components/MapAfrica.js":{"content":"// src/components/MapAfrica.js\n\"use client\"\n\nimport React, { useState } from \"react\"\nimport { ComposableMap, Geographies, Geography, Marker } from \"react-simple-maps\"\nimport \"./WorldMap.css\"\n\nconst geoUrl = \"https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json\"\n\n// Lista de paÃ­ses en conflicto (puedes aÃ±adir mÃ¡s ids normalizados mÃ¡s abajo)\nconst CONFLICTS_NORMALIZED = new Set([\n  \"democraticrepublicofthecongo\", // Congo-Kinshasa (ejemplo)\n  // aÃ±ade aquÃ­ mÃ¡s paÃ­ses normalizados si deseas marcadores de conflicto\n])\n\n// Normaliza el nombre del paÃ­s para convertirlo en filename \"nombrejunto\" sin acentos\nfunction normalizeForFilename(name) {\n  if (!name) return \"\"\n  // 1) pasar a NFD y eliminar diacrÃ­ticos\n  const noDiacritics = name.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\")\n  // 2) eliminar caracteres no alfanumÃ©ricos\n  const alnum = noDiacritics.replace(/[^0-9a-zA-Z]/g, \"\")\n  // 3) pasar a minÃºsculas\n  return alnum.toLowerCase()\n}\n\n// Normalizaciones y mapeo de ids (igual que tu WorldMap original)\nfunction getCountryIdFromGeo(geo) {\n  const name = (geo.properties.name || \"\").toLowerCase()\n  if (geo.id === \"732\" || name === \"morocco\" || name === \"western sahara\") return \"morocco\"\n  const israelIds = [\"376\", \"275\"]\n  const israelNames = [\"israel\", \"palestine\", \"west bank\", \"gaza\"]\n  if (israelIds.includes(geo.id) || israelNames.includes(name)) return \"palestine\"\n  if (name === \"saudi arabia\") return \"saudi\"\n  if (name === \"united arab emirates\") return \"uae\"\n  return name.replace(/\\s+/g, \"-\")\n}\n\nexport default function MapAfrica() {\n  const [hoveredCountry, setHoveredCountry] = useState(null)\n  const [hoveredPlainName, setHoveredPlainName] = useState(null)\n\n  const handleCountryClick = (countryId) => {\n    const routeId = countryId === \"israel\" ? \"palestine\" : countryId\n    window.location.href = `/country/${routeId}`\n  }\n\n  // Construye ruta de imagen dentro de public (carpeta: \"ImÃ¡genes de PaÃ­s\")\n  const imagePathFromPlainName = (plainName) => {\n    const filename = normalizeForFilename(plainName) + \".png\" // \"southafrica.png\"\n    const rawPath = `/ImÃ¡genes de PaÃ­s/${filename}`\n    return encodeURI(rawPath) // maneja espacios y caracteres\n  }\n\n  return (\n    <div className=\"map-wrapper\" style={{ position: \"relative\" }}>\n      <ComposableMap\n        projection=\"geoMercator\"\n        projectionConfig={{ scale: 360, center: [20, 0] }}\n        style={{ width: \"100%\", height: \"105%\" }}\n      >\n        <Geographies geography={geoUrl}>\n          {({ geographies }) =>\n            geographies\n              .filter((geo) => {\n                // incluir TODOS los paÃ­ses cuyo continente sea Ãfrica\n                return geo.properties && geo.properties.continent === \"Africa\"\n              })\n              .map((geo) => {\n                const countryId = getCountryIdFromGeo(geo)\n                const isHovered = hoveredCountry === countryId\n                const fill = isHovered ? \"#6e7b4e46\" : \"#000000ff\"\n\n                return (\n                  <Geography\n                    key={geo.rsmKey}\n                    geography={geo}\n                    onClick={() => handleCountryClick(countryId)}\n                    onMouseEnter={() => {\n                      setHoveredCountry(countryId)\n                      setHoveredPlainName(geo.properties.name)\n                    }}\n                    onMouseLeave={() => {\n                      setHoveredCountry(null)\n                      setHoveredPlainName(null)\n                    }}\n                    fill={fill}\n                    stroke=\"#ffffffff\"\n                    strokeWidth={0.5}\n                    style={{\n                      default: { outline: \"none\", cursor: \"pointer\" },\n                      hover: { outline: \"none\", fill: \"#6e7b4e46\" },\n                      pressed: { outline: \"none\" },\n                    }}\n                  />\n                )\n              })\n          }\n        </Geographies>\n\n        {/* MARCADORES DE CONFLICTO:\n            Mostramos marcadores solo si el nombre normalizado del paÃ­s estÃ¡ en CONFLICTS_NORMALIZED.\n            Usamos centroid approximate by projecting coordinates from geo if needed, but para simplicidad\n            intentamos usar country centroids provided by the topology if accessible (react-simple-maps doesn't\n            give them directly here). Como alternativa liviana, usamos lat/lng aproximados si los tuvieras.\n            AquÃ­ dejamos la lÃ³gica para que marque si corresponde. */}\n        {/** NOTA: Si quieres marcadores exactos, aÃ±ade un objeto countryData con coordinates para cada paÃ­s. **/}\n        {/* No aÃ±adimos markers automÃ¡ticos sin coordenadas fiables para todos los paÃ­ses para evitar errores visuales */}\n      </ComposableMap>\n\n      {/* POPUP CIRCULAR (idÃ©ntico al de tu WorldMap) */}\n      {hoveredPlainName && (\n        (() => {\n          const displayName = hoveredPlainName\n          const imageSrc = imagePathFromPlainName(displayName)\n\n          return (\n            <div\n              className=\"country-popup-circle\"\n              style={{\n                position: \"absolute\",\n                top: \"-90px\",\n                left: \"320px\",\n                width: 200,\n                height: 200,\n                borderRadius: \"50%\",\n                display: \"flex\",\n                flexDirection: \"column\",\n                alignItems: \"center\",\n                justifyContent: \"center\",\n                backgroundColor: \"#ffffffee\",\n                boxShadow: \"0 0 15px rgba(0,0,0,0.3)\",\n                padding: \"10px\",\n                textAlign: \"center\",\n                pointerEvents: \"none\",\n              }}\n            >\n              <img\n                src={imageSrc}\n                alt={displayName}\n                style={{ width: \"80px\", height: \"80px\", borderRadius: \"50%\", marginBottom: \"10px\", objectFit: \"cover\" }}\n                onError={(e) => {\n                  e.currentTarget.onerror = null\n                  // fallback: si no existe la imagen, mostramos un placeholder que debes poner en public\n                  e.currentTarget.src = encodeURI(\"/ImÃ¡genes de PaÃ­s/placeholder.png\")\n                }}\n              />\n              <h3 style={{ fontSize: \"16px\", margin: 0 }}>{displayName}</h3>\n              <p style={{ fontSize: \"12px\", margin: 0 }}>InformaciÃ³n disponible prÃ³ximamente.</p>\n            </div>\n          )\n        })()\n      )}\n    </div>\n  )\n}\n","path":null,"size_bytes":6441,"size_tokens":null},"src/components/mobile-menu.css":{"content":"/* Update mobile menu overlay styles */\n.mobile-menu-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100vh;\n  background: white;\n  z-index: 2000;\n  display: flex;\n  flex-direction: column;\n  animation: slideIn 0.3s ease-out;\n}\n\n@keyframes slideIn {\n  from {\n    transform: translateX(100%);\n  }\n  to {\n    transform: translateX(0);\n  }\n}\n\n/* Update header styles */\n.mobile-menu-header {\n  padding: 16px 20px;\n  border-bottom: 1px solid #eee;\n  display: flex;\n  align-items: center;\n  gap: 16px;\n  background: #f8f9fa;\n  justify-content: flex-start; /* Ensure alignment */\n}\n\n.close-button {\n  background: none;\n  border: none;\n  font-size: 1.5rem;\n  cursor: pointer;\n  padding: 4px 8px;\n}\n\n.menu-title {\n  margin: 0;\n  font-size: 1.2rem;\n  font-weight: bold;\n  border-bottom: none; /* Remove global h2 border if inherited */\n  padding-bottom: 0;\n}\n\n.mobile-menu-content {\n  padding: 24px; /* Increased padding */\n  overflow-y: auto;\n  background: #fff;\n}\n\n.menu-item {\n  display: block;\n  width: 100%;\n  text-align: left;\n  padding: 16px 0; /* Larger touch targets */\n  background: none;\n  border: none;\n  font-size: 1.15rem;\n  border-bottom: 1px solid #f0f0f0;\n  cursor: pointer;\n  color: var(--wiki-black);\n  font-family: var(--wiki-font-serif); /* Changed to serif */\n  transition: color 0.2s;\n}\n\n.menu-item:active {\n  background-color: #f9f9f9;\n  color: var(--wiki-red);\n}\n\n.menu-item.home-link {\n  font-weight: bold;\n  color: var(--wiki-black);\n}\n\n.menu-item.section-link {\n  color: var(--wiki-link);\n  padding-left: 10px;\n}\n\n.menu-section-title {\n  margin-top: 32px;\n  margin-bottom: 16px;\n  font-size: 0.85rem;\n  color: var(--wiki-red); /* Use brand red */\n  text-transform: uppercase;\n  letter-spacing: 1.5px;\n  font-weight: 700;\n  font-family: var(--wiki-font-sans);\n  border-bottom: 2px solid #eee;\n  padding-bottom: 8px;\n}\n\n.menu-sections-list {\n  display: flex;\n  flex-direction: column;\n  gap: 0;\n}\n\n.menu-media-group {\n  display: flex;\n  flex-direction: column;\n}\n","path":null,"size_bytes":2006,"size_tokens":null},"src/reportWebVitals.js":{"content":"const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","path":null,"size_bytes":362,"size_tokens":null},"src/components/MobileMenu.jsx":{"content":"\"use client\"\n\nimport \"./mobile-menu.css\"\n\nexport default function MobileMenu({ countryName, sections, onClose, onSelectSection, onHome, isGlobal = false }) {\n  return (\n    <div className=\"mobile-menu-overlay\">\n      <div className=\"mobile-menu-header\">\n        <button className=\"close-button\" onClick={onClose}>\n          âœ•\n        </button>\n        <h2 className=\"menu-title\">MenÃº</h2>\n      </div>\n\n      <div className=\"mobile-menu-content\">\n        <button className=\"menu-item home-link\" onClick={onHome}>\n          Inicio\n        </button>\n\n        <div className=\"menu-divider\"></div>\n\n        {isGlobal ? (\n          <h3 className=\"menu-section-title\">Secciones Globales</h3>\n        ) : (\n          <h3 className=\"menu-section-title\">Secciones de {countryName}</h3>\n        )}\n\n        <div className=\"menu-sections-list\">\n          <button className=\"menu-item section-link\" onClick={() => onSelectSection(\"terminology-conceptos\")}>\n            TerminologÃ­a\n          </button>\n\n          {sections && sections.length > 0 ? (\n            sections.map((section) => {\n              if (section.id === \"media-gallery\") {\n                return (\n                  <div key=\"media-group\" className=\"menu-media-group\">\n                    <button className=\"menu-item section-link\" onClick={() => onSelectSection(\"media-gallery-images\")}>\n                      Fotos\n                    </button>\n                    <button className=\"menu-item section-link\" onClick={() => onSelectSection(\"media-gallery-videos\")}>\n                      VÃ­deos\n                    </button>\n                  </div>\n                )\n              }\n              if (section.id.startsWith(\"terminology\")) return null\n\n              return (\n                <button key={section.id} className=\"menu-item section-link\" onClick={() => onSelectSection(section.id)}>\n                  {section.title || section.name || section.label}\n                </button>\n              )\n            })\n          ) : (\n            <div className=\"menu-fallback\">\n              <button className=\"menu-item section-link\" onClick={() => onSelectSection(\"description\")}>\n                DescripciÃ³n del conflicto\n              </button>\n              <button className=\"menu-item section-link\" onClick={() => onSelectSection(\"testimonies\")}>\n                Testimonios\n              </button>\n              <button className=\"menu-item section-link\" onClick={() => onSelectSection(\"analysts\")}>\n                AnÃ¡lisis\n              </button>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  )\n}\n","path":null,"size_bytes":2602,"size_tokens":null},"src/layout/CountryLayout.jsx":{"content":"\"use client\"\n\nimport { useEffect, useState } from \"react\"\nimport { useParams, useNavigate } from \"react-router-dom\"\nimport { useLanguage } from \"../context/LanguageContext\"\n\nimport CountryHeader from \"./CountryHeader\"\nimport CountrySidebar from \"./CountrySidebar\"\nimport CountryContent from \"./CountryContent\"\nimport MobileMenu from \"../components/MobileMenu\"\n\nimport \"./country-layout.css\"\n\nexport default function CountryLayout() {\n  const { code } = useParams()\n  const navigate = useNavigate()\n  const { lang } = useLanguage()\n  const [meta, setMeta] = useState(null)\n  const [currentSection, setCurrentSection] = useState(null)\n  const [currentCategory, setCurrentCategory] = useState(null)\n  const [loading, setLoading] = useState(true)\n  const [searchTerm, setSearchTerm] = useState(\"\")\n  const [isMobile, setIsMobile] = useState(false)\n  const [isMenuOpen, setIsMenuOpen] = useState(false)\n\n  useEffect(() => {\n    const checkMobile = () => setIsMobile(window.innerWidth < 860)\n    checkMobile()\n    window.addEventListener(\"resize\", checkMobile)\n    return () => window.removeEventListener(\"resize\", checkMobile)\n  }, [])\n\n  useEffect(() => {\n    async function loadMeta() {\n      try {\n        const url = `/data/${lang}/${code}/meta.json`\n        const res = await fetch(url)\n        if (!res.ok) {\n          const minimalMeta = {\n            name: code.charAt(0).toUpperCase() + code.slice(1),\n            sections: [\n              { id: \"description\", title: \"DescripciÃ³n del conflicto\", label: \"DescripciÃ³n del conflicto\" },\n              { id: \"testimonies\", title: \"Testimonios\", label: \"Testimonios\" },\n              { id: \"analysts\", title: \"AnÃ¡lisis\", label: \"AnÃ¡lisis\" },\n              { id: \"media-gallery\", title: \"Fototeca\", label: \"Fototeca\" },\n            ],\n          }\n          setMeta(minimalMeta)\n          setCurrentSection(\"description\")\n          setLoading(false)\n          return\n        }\n\n        const json = await res.json()\n        setMeta(json)\n\n        if (isMobile) {\n          setCurrentSection(\"description\")\n        } else {\n          let firstSection = json.sections?.find((s) => s.id === \"description\") || json.sections?.[0]\n          if (firstSection?.id === \"media-gallery\") {\n            firstSection = { ...firstSection, id: \"media-gallery-images\" }\n          }\n          setCurrentSection(firstSection?.id || \"description\")\n        }\n      } catch (err) {\n        console.error(\"[v0] Error loading meta.json:\", err)\n        const minimalMeta = {\n          name: code.charAt(0).toUpperCase() + code.slice(1),\n          sections: [\n            { id: \"description\", title: \"DescripciÃ³n del conflicto\", label: \"DescripciÃ³n del conflicto\" },\n            { id: \"testimonies\", title: \"Testimonios\", label: \"Testimonios\" },\n            { id: \"analysts\", title: \"AnÃ¡lisis\", label: \"AnÃ¡lisis\" },\n            { id: \"media-gallery\", title: \"Fototeca\", label: \"Fototeca\" },\n          ],\n        }\n        setMeta(minimalMeta)\n        setCurrentSection(\"description\")\n      }\n      setLoading(false)\n    }\n\n    loadMeta()\n  }, [code, lang, isMobile])\n\n  function handleSelect(sectionId) {\n    setCurrentSection(sectionId)\n    setCurrentCategory(null)\n    setSearchTerm(\"\")\n  }\n\n  function handleSelectCategory(categoryId) {\n    setCurrentCategory(categoryId)\n  }\n\n  function handleSearch(term) {\n    setSearchTerm(term)\n  }\n\n  function handleBackMobile() {\n    if (currentCategory) {\n      setCurrentCategory(null)\n    } else if (currentSection !== \"description\") {\n      setCurrentSection(\"description\")\n    } else {\n      navigate(\"/\")\n    }\n  }\n\n  if (loading) return <div className=\"country-loading\">Cargando paÃ­s {code}...</div>\n  if (!meta) return <div className=\"country-loading\">No se encontraron datos para {code}</div>\n\n  if (isMobile && meta) {\n    return (\n      <div className=\"country-layout mobile-wiki-mode\">\n        {/* Mobile Specific Header */}\n        <div className=\"mobile-wiki-header\">\n          <div className=\"mobile-header-top\">\n            <div className=\"mobile-logo-large\" onClick={() => navigate(\"/\")}>\n              <span className=\"logo-wiki\">Wiki</span>\n              <span className=\"logo-conflicts\">Conflicts</span>\n            </div>\n\n            <button className=\"mobile-menu-toggle-btn\" onClick={() => setIsMenuOpen(true)}>\n              <div className=\"hamburger-box\">\n                <span className=\"hamburger-inner\"></span>\n              </div>\n              <span className=\"menu-label\">MenÃº</span>\n            </button>\n          </div>\n\n          <div className=\"mobile-search-bar\">\n            <input\n              type=\"search\"\n              className=\"mobile-search-input\"\n              placeholder=\"Buscar en WikiConflicts...\"\n              value={searchTerm}\n              onChange={(e) => handleSearch(e.target.value)}\n              aria-label=\"Buscar contenido\"\n            />\n          </div>\n\n          <h1 className=\"mobile-country-title\">{meta.name}</h1>\n        </div>\n\n        {/* Menu Overlay */}\n        {isMenuOpen && (\n          <MobileMenu\n            countryName={meta.name}\n            sections={meta.sections}\n            onClose={() => setIsMenuOpen(false)}\n            onSelectSection={(sectionId) => {\n              handleSelect(sectionId)\n              setIsMenuOpen(false)\n            }}\n            onHome={() => navigate(\"/\")}\n          />\n        )}\n\n        {/* Content Area */}\n        <div className=\"country-content-wrapper mobile-content-padding\">\n          {currentSection ? (\n            <CountryContent\n              countryCode={code}\n              section={currentSection}\n              searchTerm={searchTerm}\n              openMenu={setIsMenuOpen}\n            />\n          ) : (\n            <div className=\"select-prompt\">Seleccione una secciÃ³n del menÃº para comenzar.</div>\n          )}\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"country-layout\">\n      <CountryHeader onHomeClick={() => navigate(\"/\")} onSearch={handleSearch} />\n\n      <div className=\"country-body\">\n        {!isMobile && (\n          <CountrySidebar\n            countryName={meta.name}\n            sections={meta.sections}\n            currentSection={currentSection}\n            onSelectSection={handleSelect}\n          />\n        )}\n\n        <div className=\"country-content-wrapper\">\n          {currentSection ? (\n            <CountryContent countryCode={code} section={currentSection} searchTerm={searchTerm} />\n          ) : (\n            <div>Seleccione una secciÃ³n</div>\n          )}\n        </div>\n      </div>\n\n      <footer className=\"country-footer\">\n        <div className=\"footer-social\">\n          <a href=\"https://twitter.com/wikiconflicts\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"social-icon\" aria-label=\"Twitter\">\n            <svg viewBox=\"0 0 24 24\" width=\"20\" height=\"20\" fill=\"currentColor\">\n              <path d=\"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z\"/>\n            </svg>\n          </a>\n          <a href=\"https://instagram.com/wikiconflicts\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"social-icon\" aria-label=\"Instagram\">\n            <svg viewBox=\"0 0 24 24\" width=\"20\" height=\"20\" fill=\"currentColor\">\n              <path d=\"M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z\"/>\n            </svg>\n          </a>\n          <a href=\"https://t.me/wikiconflicts\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"social-icon\" aria-label=\"Telegram\">\n            <svg viewBox=\"0 0 24 24\" width=\"20\" height=\"20\" fill=\"currentColor\">\n              <path d=\"M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z\"/>\n            </svg>\n          </a>\n          <a href=\"https://youtube.com/@wikiconflicts\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"social-icon\" aria-label=\"YouTube\">\n            <svg viewBox=\"0 0 24 24\" width=\"20\" height=\"20\" fill=\"currentColor\">\n              <path d=\"M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z\"/>\n            </svg>\n          </a>\n        </div>\n        <p>Â© {new Date().getFullYear()} WikiConflicts â€” Todos los derechos reservados</p>\n      </footer>\n    </div>\n  )\n}\n","path":null,"size_bytes":10113,"size_tokens":null},"src/components/ContinentData.js":{"content":"// ContinentData.js\n// Datos por continente con imÃ¡genes realistas (placeholders) y conflictos\n\nexport const latinAmericaData = {\n  brazil: { name: \"Brasil\", coordinates: [-47.8825, -15.7942], image: \"/brazil-rio.jpg\", description: \"El gigante sudamericano.\", hasConflict: false },\n  argentina: { name: \"Argentina\", coordinates: [-58.3816, -34.6037], image: \"/argentina-buenos-aires.jpg\", description: \"PaÃ­s austral de gran cultura.\", hasConflict: false },\n  mexico: { name: \"MÃ©xico\", coordinates: [-99.1332, 19.4326], image: \"/mexico-city.jpg\", description: \"Centro histÃ³rico y cultural de AmÃ©rica del Norte.\", hasConflict: false },\n  colombia: { name: \"Colombia\", coordinates: [-74.0721, 4.7110], image: \"/colombia-bogota.jpg\", description: \"PaÃ­s biodiverso en el corazÃ³n de los Andes.\", hasConflict: false },\n  chile: { name: \"Chile\", coordinates: [-70.6693, -33.4489], image: \"/chile-santiago.jpg\", description: \"Largo paÃ­s entre los Andes y el PacÃ­fico.\", hasConflict: false },\n  peru: { name: \"PerÃº\", coordinates: [-77.0428, -12.0464], image: \"/peru-lima.jpg\", description: \"Cuna del Imperio Inca.\", hasConflict: false },\n  venezuela: { name: \"Venezuela\", coordinates: [-66.9036, 10.4806], image: \"/venezuela-caracas.jpg\", description: \"PaÃ­s petrolero con historia compleja.\", hasConflict: true }, // conflicto\n};\n\nexport const africaData = {\n  nigeria: { name: \"Nigeria\", coordinates: [3.3792, 6.5244], image: \"/nigeria-lagos.jpg\", description: \"La mayor economÃ­a africana.\", hasConflict: false },\n  south_africa: { name: \"SudÃ¡frica\", coordinates: [18.4241, -33.9249], image: \"/south-africa-cape-town.jpg\", description: \"PaÃ­s diverso en la punta del continente.\", hasConflict: false },\n  egypt: { name: \"Egipto\", coordinates: [31.2357, 30.0444], image: \"/egypt-pyramids.jpg\", description: \"Cuna de la civilizaciÃ³n del Nilo.\", hasConflict: false },\n  algeria_non_arab: { name: \"Argelia (No duplicar Magreb Ã¡rabe)\", coordinates: [3.0588, 36.7538], image: \"/algeria.jpg\", description: \"PaÃ­s del norte de Ãfrica.\", hasConflict: false },\n  ethiopia: { name: \"EtiopÃ­a\", coordinates: [38.7578, 9.0319], image: \"/ethiopia-addis.jpg\", description: \"Antigua civilizaciÃ³n del Cuerno de Ãfrica.\", hasConflict: false },\n  kenya: { name: \"Kenia\", coordinates: [36.8219, -1.2921], image: \"/kenya-nairobi.jpg\", description: \"Centro econÃ³mico del Ãfrica Oriental.\", hasConflict: false },\n};\n\nexport const europeData = {\n  spain: { name: \"EspaÃ±a\", coordinates: [-3.7038, 40.4168], image: \"/spain-madrid.jpg\", description: \"PaÃ­s ibÃ©rico de gran historia.\", hasConflict: false },\n  france: { name: \"Francia\", coordinates: [2.3522, 48.8566], image: \"/france-paris.jpg\", description: \"Centro cultural europeo.\", hasConflict: false },\n  germany: { name: \"Alemania\", coordinates: [13.405, 52.52], image: \"/germany-berlin.jpg\", description: \"Potencia econÃ³mica europea.\", hasConflict: false },\n  uk: { name: \"Reino Unido\", coordinates: [-0.1276, 51.5074], image: \"/uk-london.jpg\", description: \"Islas britÃ¡nicas con historia global.\", hasConflict: false },\n  italy: { name: \"Italia\", coordinates: [12.4964, 41.9028], image: \"/italy-rome.jpg\", description: \"Cuna del Imperio Romano.\", hasConflict: false },\n  poland: { name: \"Polonia\", coordinates: [21.0122, 52.2297], image: \"/poland-warsaw.jpg\", description: \"PaÃ­s clave en Europa del Este.\", hasConflict: false },\n  ukraine: { name: \"Ucrania\", coordinates: [30.5234, 50.4501], image: \"/ukraine-kyiv.jpg\", description: \"PaÃ­s en conflicto activo.\", hasConflict: true },\n};\n\nexport const asiaData = {\n  china: { name: \"China\", coordinates: [116.4074, 39.9042], image: \"/china-beijing.jpg\", description: \"La naciÃ³n mÃ¡s poblada del mundo.\", hasConflict: false },\n  india: { name: \"India\", coordinates: [77.209, 28.6139], image: \"/india-delhi.jpg\", description: \"Gigante del sur de Asia.\", hasConflict: false },\n  japan: { name: \"JapÃ³n\", coordinates: [139.6917, 35.6895], image: \"/japan-tokyo.jpg\", description: \"Islas tecnolÃ³gicas del PacÃ­fico.\", hasConflict: false },\n  south_korea: { name: \"Corea del Sur\", coordinates: [126.978, 37.5665], image: \"/korea-seoul.jpg\", description: \"Potencia tecnolÃ³gica asiÃ¡tica.\", hasConflict: false },\n  indonesia: { name: \"Indonesia\", coordinates: [106.8456, -6.2088], image: \"/indonesia-jakarta.jpg\", description: \"ArchipiÃ©lago mÃ¡s grande del mundo.\", hasConflict: false },\n  pakistan: { name: \"PakistÃ¡n\", coordinates: [73.0479, 33.6844], image: \"/pakistan-islamabad.jpg\", description: \"PaÃ­s estratÃ©gico del sur de Asia.\", hasConflict: false },\n};\n","path":null,"size_bytes":4557,"size_tokens":null},"src/components/WorldMap.js":{"content":"\"use client\"\n\nimport { useState } from \"react\"\nimport { ComposableMap, Geographies, Geography, Marker } from \"react-simple-maps\"\nimport \"./WorldMap.css\"\n\n\nconst geoUrl = \"https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json\"\n\n// ---------------------------\n// LISTA DE PAISES ÃRABES + TurquÃ­a e IrÃ¡n\n// ---------------------------\nconst arabCountries = [\n  \"Algeria\", \"Bahrain\", \"Comoros\", \"Egypt\", \"Iraq\", \"Israel\", \"Jordan\",\n  \"Kuwait\", \"Lebanon\", \"Libya\", \"Mauritania\", \"Morocco\", \"Oman\", \"Qatar\",\n  \"Saudi Arabia\", \"Sudan\", \"South Sudan\", \"Syria\", \"Tunisia\",\n  \"United Arab Emirates\", \"Yemen\", \"Western Sahara\",\n  \"Palestinian Territory, Occupied\",\n]\n\nconst extraArab = [\"Turkey\", \"Iran\"]\n\nconst regionFilters = arabCountries.concat(extraArab)\n\n// ---------------------------\n// DATOS DE PAISES\n// ---------------------------\nconst countryData = {\n  morocco: { \n    name: \"Marruecos\", \n    coordinates: [-6.8498, 34.0209], \n    image: \"/flags/ma.png\", \n    hasConflict: false \n  },\n  palestine: { \n    name: \"Palestina\", \n    coordinates: [35.2, 31.9], \n    image: \"/flags/pa.png\", \n    hasConflict: true \n  },\n  lebanon: { \n    name: \"LÃ­bano\", \n    coordinates: [35.5018, 33.8886], \n    image: \"/flags/li.png\", \n    hasConflict: true\n  },\n  yemen: { \n    name: \"Yemen\", \n    coordinates: [44.2075, 15.3694], \n    image: \"/flags/ye.png\", \n    hasConflict: true \n  },\n  turkey: { \n    name: \"TurquÃ­a\", \n    coordinates: [32.8597, 39.9334], \n    image: \"/flags/tu.png\", \n    hasConflict: false \n  },\n  iran: { \n    name: \"IrÃ¡n\", \n    coordinates: [51.3890, 35.6892], \n    image: \"/flags/ir.png\", \n    hasConflict: true \n  },\n  algeria: { \n    name: \"Argelia\", \n    coordinates: [3.0588, 36.7538], \n    image: \"/flags/ar.png\", \n    hasConflict: false \n  },\n  egypt: { \n    name: \"Egipto\", \n    coordinates: [31.2357, 30.0444], \n    image: \"/flags/eg.png\", \n    hasConflict: false\n  },\n  sudan: { \n    name: \"SudÃ¡n\", \n    coordinates: [32.5599, 15.5007], \n    image: \"/flags/su.png\", \n    hasConflict: true \n  },\n  saudi: { \n    name: \"Arabia Saudita\", \n    coordinates: [46.6753, 24.7136], \n    image: \"/flags/ara.png\", \n    hasConflict: false \n  },\n  uae: { \n    name: \"Emiratos Ãrabes Unidos\", \n    coordinates: [54.3705, 24.4539], \n    image: \"/flags/em.png\", \n    hasConflict: false \n  },\n  qatar: { \n    name: \"qatar\", \n    coordinates: [51.531, 25.2854], \n    image: \"/flags/qa.png\", \n    hasConflict: false \n  },\n  bahrain: { \n    name: \"BarÃ©in\", \n    coordinates: [50.5577, 26.0667], \n    image: \"/flags/ba.png\", \n    hasConflict: false \n  },\n  jordan: { \n    name: \"Jordania\", \n    coordinates: [35.9456, 31.9454], \n    image: \"/flags/jo.png\", \n    hasConflict: false \n  },\n  iraq: { \n    name: \"Irak\", \n    coordinates: [44.3661, 33.3152], \n    image: \"/flags/ira.png\", \n    hasConflict: false\n  },\n  kuwait: { \n    name: \"Kuwait\", \n    coordinates: [47.9774, 29.3759], \n    image: \"/flags/ku.png\", \n    hasConflict: false \n  },\n  libya: { \n    name: \"Libia\", \n    coordinates: [13.1913, 32.8872], \n    image: \"/flags/li.png\", \n    hasConflict: true\n  },\n  tunisia: { \n    name: \"TÃºnez\", \n    coordinates: [10.1815, 36.8065], \n    image: \"/flags/tun.png\", \n    hasConflict: false \n  },\n  oman: { \n    name: \"OmÃ¡n\", \n    coordinates: [58.4059, 23.588], \n    image: \"/flags/om.png\", \n    hasConflict: false \n  },\n  mauritania: { \n    name: \"Mauritania\", \n    coordinates: [-15.9785, 18.0735], \n    image: \"/flags/mau.png\", \n    hasConflict: false \n  },\n  comoros: { \n    name: \"Comoras\", \n    coordinates: [43.2418, -11.7172], \n    image: \"/flags/co.png\", \n    hasConflict: false \n  },\n  syria: { \n    name: \"Siria\",\n    coordinates: [38.9968, 34.8021], \n    image: \"/flags/si.png\", \n    hasConflict:true\n  },\n}\n\n// ---------------------------\n// COMPONENTE\n// ---------------------------\nexport default function WorldMap() {\n  const [hoveredCountry, setHoveredCountry] = useState(null)\n\n  const getCountryId = (geo) => {\n    const name = geo.properties.name.toLowerCase()\n    if (geo.id === \"732\" || name === \"morocco\" || name === \"western sahara\") return \"morocco\"\n    const israelIds = [\"376\", \"275\"]\n    const israelNames = [\"israel\", \"palestine\", \"west bank\", \"gaza\"]\n    if (israelIds.includes(geo.id) || israelNames.includes(name)) return \"palestine\"\n    if (name === \"saudi arabia\") return \"saudi\"\n    if (name === \"united arab emirates\") return \"uae\"\n    return name.replace(/\\s+/g, \"-\")\n  }\n\n  const handleCountryClick = (countryId) => {\n    const routeId = countryId === \"israel\" ? \"palestine\" : countryId\n    window.location.href = `/country/${routeId}`\n  }\n\n  return (\n    <div className=\"map-wrapper\" style={{ position: \"relative\" }}>\n      <ComposableMap\n        projection=\"geoMercator\"\n        projectionConfig={{ scale: 700, center: [25, 28] }}\n        style={{ width: \"100%\", height: \"105%\" }}\n      >\n        <Geographies geography={geoUrl}>\n          {({ geographies }) =>\n            geographies\n              .filter((geo) => regionFilters.includes(geo.properties.name) || geo.id === \"732\" || geo.id === \"275\")\n              .map((geo) => {\n                const countryId = getCountryId(geo)\n                const isLifted = hoveredCountry === countryId\n\n                return (\n                  <Geography\n  key={geo.rsmKey}\n  geography={geo}\n  onClick={() => handleCountryClick(countryId)}\n  onMouseEnter={() => setHoveredCountry(countryId)}\n  onMouseLeave={() => setHoveredCountry(null)}\n  className={`${isLifted ? \"country-lifted\" : \"\"} ${countryData[countryId]?.hasConflict ? \"conflict-country\" : \"\"}`}\n  fill={isLifted ? \"#1E4350\" : \"#0C1E28\"}\nstroke=\"#F2F5F7\"\n  strokeWidth={0.5}\n  style={{\n    default: { outline: \"none\", cursor: \"pointer\" },\n    hover: { outline: \"none\" },\n    pressed: { outline: \"none\" },\n  }}\n/>\n                )\n              })\n          }\n        </Geographies>\n\n        {/* SOLO MARCADORES EN CONFLICTO */}\n        {Object.entries(countryData).map(([id, data]) => {\n          if (!data.hasConflict) return null\n          return (\n           <Marker key={id} coordinates={data.coordinates}>\n  <g\n    className=\"conflict-marker-group\"\n    aria-label={`${data.name} â€” posible zona de conflicto`}\n    role=\"img\"\n  >\n    <circle className=\"conflict-wave\" />\n    <circle className=\"conflict-wave\" />\n    <circle className=\"conflict-wave\" />\n  </g>\n</Marker>\n\n          )\n        })}\n      </ComposableMap>\n\n      {/* POPUP CIRCULAR FIJO ARRIBA-IZQUIERDA */}\n      {hoveredCountry && countryData[hoveredCountry] && (\n        <div\n          className=\"country-popup-circle\"\n          \n           \n        >\n          <img\n            src={countryData[hoveredCountry].image}\n            alt={countryData[hoveredCountry].name}\n            style={{ width: \"80px\", height: \"80px\", borderRadius: \"50%\", marginBottom: \"10px\", objectFit: \"cover\" }}\n          />\n          <h3 style={{ fontSize: \"16px\", margin: 0 }}>{countryData[hoveredCountry].name}</h3>\n          <p style={{ fontSize: \"12px\", margin: 0 }}>{countryData[hoveredCountry].description}</p>\n        </div>\n      )}\n    </div>\n  )\n}\n","path":null,"size_bytes":7073,"size_tokens":null},"src/App.css":{"content":"@import url(\"https://fonts.googleapis.com/css2?family=Dancing+Script&family=Gloock&display=swap\");\n@import url(\"https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300..700;1,300..700&display=swap\");\n@import url(\"https://fonts.googleapis.com/css2?family=Waterfall&display=swap\");\n@import url('https://fonts.googleapis.com/css2?family=Aref+Ruqaa:wght@400;700&display=swap');\n@import url('https://fonts.googleapis.com/css2?family=Waterfall&display=swap');\n@import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400..900&family=Poiret+One&family=Raleway:ital,wght@0,100..900;1,100..900&display=swap');\n@import url('https://fonts.googleapis.com/css2?family=Amiri+Quran&family=Amiri:ital,wght@0,400;0,700;1,400;1,700&display=swap');\n@import url('https://fonts.googleapis.com/css2?family=Caveat:wght@400..700&family=Poiret+One&family=Raleway:ital,wght@0,100..900;1,100..900&display=swap');\n@import url('https://fonts.googleapis.com/css2?family=Bonheur+Royale&family=Corinthia:wght@400;700&family=Cormorant+Upright:wght@300;400;500;600;700&family=Ephesis&display=swap');\n\n\n\n\n:root {\n  /* Updated typography variables for a more professional look */\n  --wiki-font-serif: \"Playfair Display\", \"Linux Libertine\", \"Georgia\", serif;\n  --wiki-font-sans: \"Merriweather Sans\", \"Helvetica Neue\", sans-serif;\n  --wiki-black: #1a1a1a;\n  --wiki-gray: #54595d;\n  --wiki-border: #a2a9b1;\n  --wiki-link: #3366cc;\n  --wiki-red: #181616; /* Darker red for professional look */\n  --wiki-bg: #fcfcfc; /* Slightly off-white for paper feel */\n  --wiki-bg-secondary: #f8f9fa;\n}\n\nbody {\n  margin: 0;\n  font-family: var(--wiki-font-sans);\n  color: var(--wiki-black);\n  background-color: var(--wiki-bg);\n  -webkit-font-smoothing: antialiased;\n  line-height: 1.6;\n}\n\nh1,\nh2,\nh3,\nh4,\nh5,\nh6 {\n  /* Enforcing serif font for headings */\n  font-family: var(--wiki-font-serif);\n  font-weight: 600;\n  color: var(--wiki-black);\n  margin-bottom: 0.6em;\n  line-height: 1.3;\n  border-bottom: none; /* Reset default border */\n}\n\na {\n  color: var(--wiki-link);\n  text-decoration: none;\n}\n\na:hover {\n  text-decoration: underline;\n}\n\n.app-container {\n  width: 100%;\n  min-height: 100vh;\n  display: flex;\n  flex-direction: column;\n  /* Remove fixed height to allow content to flow naturally */\n}\n\n/* Updated footer styles */\n.country-footer {\n  background: #ffffff;\n  border-top: 0px solid #e0e0e0;\n  padding: 8px 0;\n  text-align: center;\n  font-size: 12px;\n  color: #888;\n  flex-shrink: 0;\n  height: 25px;\n}\n\n.footer-line {\n  display: none; /* Removed thick line */\n}\n\n.home-container {\n  /* Remove height constraint to prevent scrolling */\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n}\n","path":null,"size_bytes":2719,"size_tokens":null},"src/layout/CountrySidebar.jsx":{"content":"\"use client\"\n\nimport { useState } from \"react\"\nimport { useLanguage } from \"../context/LanguageContext\"\nimport \"./country-sidebar.css\"\n\nexport default function CountrySidebar({ countryName, sections, currentSection, onSelectSection }) {\n  const [openTermino, setOpenTermino] = useState(true)\n  const [openVelum, setOpenVelum] = useState(true)\n  const { t } = useLanguage()\n\n  const toggleTerminologia = () => setOpenTermino((v) => !v)\n  const toggleVelum = () => setOpenVelum((v) => !v)\n\n  return (\n    <aside className=\"country-sidebar\">\n      <div className=\"sidebar-inner\">\n        {/* VELUM */}\n        <div className=\"sidebar-block velum-block\">\n          <div\n            className=\"sidebar-title velum-title\"\n            onClick={toggleVelum}\n            onKeyDown={(e) => {\n              if (e.key === \"Enter\" || e.key === \" \") {\n                e.preventDefault()\n                toggleVelum()\n              }\n            }}\n            aria-expanded={openVelum}\n            role=\"button\"\n            tabIndex={0}\n          >\n            <span>VELUM</span>\n            <span className={`arrow ${openVelum ? \"open\" : \"\"}`}>â–¼</span>\n          </div>\n\n          {openVelum && (\n            <div className=\"velum-submenu\">\n              <div\n                className={`velum-item ${currentSection === \"velum\" ? \"active\" : \"\"}`}\n                onClick={() => onSelectSection(\"velum\")}\n                onKeyDown={(e) => {\n                  if (e.key === \"Enter\" || e.key === \" \") {\n                    e.preventDefault()\n                    onSelectSection(\"velum\")\n                  }\n                }}\n                role=\"button\"\n                tabIndex={0}\n              >\n                {t(\"velum-articles\")}\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* TERMINOLOGÃA */}\n        <div className=\"sidebar-block\">\n          <div\n            className=\"sidebar-title\"\n            onClick={toggleTerminologia}\n            onKeyDown={(e) => {\n              if (e.key === \"Enter\" || e.key === \" \") {\n                e.preventDefault()\n                toggleTerminologia()\n              }\n            }}\n            aria-expanded={openTermino}\n            role=\"button\"\n            tabIndex={0}\n          >\n            <span>{t(\"Terminologia\")}</span>\n            <span className={`arrow ${openTermino ? \"open\" : \"\"}`}>â–¼</span>\n          </div>\n\n          {openTermino && (\n            <div className=\"termino-submenu\">\n              <div\n                className={`termino-item ${currentSection === \"terminology-personajes\" ? \"active\" : \"\"}`}\n                onClick={() => onSelectSection(\"terminology-personajes\")}\n                onKeyDown={(e) => {\n                  if (e.key === \"Enter\" || e.key === \" \") {\n                    e.preventDefault()\n                    onSelectSection(\"terminology-personajes\")\n                  }\n                }}\n                role=\"button\"\n                tabIndex={0}\n              >\n                {t(\"characters\")}\n              </div>\n              <div\n                className={`termino-item ${currentSection === \"terminology-organizaciones\" ? \"active\" : \"\"}`}\n                onClick={() => onSelectSection(\"terminology-organizaciones\")}\n                onKeyDown={(e) => {\n                  if (e.key === \"Enter\" || e.key === \" \") {\n                    e.preventDefault()\n                    onSelectSection(\"terminology-organizaciones\")\n                  }\n                }}\n                role=\"button\"\n                tabIndex={0}\n              >\n                {t(\"organizations\")}\n              </div>\n              <div\n                className={`termino-item ${currentSection === \"terminology-conceptos\" ? \"active\" : \"\"}`}\n                onClick={() => onSelectSection(\"terminology-conceptos\")}\n                onKeyDown={(e) => {\n                  if (e.key === \"Enter\" || e.key === \" \") {\n                    e.preventDefault()\n                    onSelectSection(\"terminology-conceptos\")\n                  }\n                }}\n                role=\"button\"\n                tabIndex={0}\n              >\n                {t(\"concepts\")}\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* COUNTRY NAME */}\n        <div className=\"sidebar-country-name\">{countryName || \"PaÃ­s\"}</div>\n\n        {/* DESCRIPCIÃ“N DEL CONFLICTO */}\n        {sections.some((s) => s.id === \"description\") && (\n          <div className=\"sidebar-block\">\n            <div\n              className={`sidebar-section-item ${currentSection === \"description\" ? \"active\" : \"\"}`}\n              onClick={() => onSelectSection(\"description\")}\n              onKeyDown={(e) => {\n                if (e.key === \"Enter\" || e.key === \" \") {\n                  e.preventDefault()\n                  onSelectSection(\"description\")\n                }\n              }}\n              role=\"button\"\n              tabIndex={0}\n            >\n              {t(\"conflict-description\")}\n            </div>\n          </div>\n        )}\n\n        {/* OTRAS SECCIONES */}\n        {sections\n          .filter((s) => s.id !== \"description\")\n          .map((sec) => (\n            <div className=\"sidebar-block\" key={sec.id}>\n              <div className=\"sidebar-section-title\">{sec.label}</div>\n              <div className=\"sidebar-section-list\">\n                {sec.id === \"media-gallery\" || sec.id === \"fototeca\" ? (\n                  <>\n                    <div\n                      className={`sidebar-section-item ${currentSection === \"fototeca-photos\" || currentSection === \"media-gallery-images\" ? \"active\" : \"\"}`}\n                      onClick={() => onSelectSection(sec.id === \"fototeca\" ? \"fototeca-photos\" : \"media-gallery-images\")}\n                      onKeyDown={(e) => {\n                        if (e.key === \"Enter\" || e.key === \" \") {\n                          e.preventDefault()\n                          onSelectSection(sec.id === \"fototeca\" ? \"fototeca-photos\" : \"media-gallery-images\")\n                        }\n                      }}\n                      role=\"button\"\n                      tabIndex={0}\n                    >\n                      {t(\"photos\")}\n                    </div>\n                    <div\n                      className={`sidebar-section-item ${currentSection === \"fototeca-videos\" || currentSection === \"media-gallery-videos\" ? \"active\" : \"\"}`}\n                      onClick={() => onSelectSection(sec.id === \"fototeca\" ? \"fototeca-videos\" : \"media-gallery-videos\")}\n                      onKeyDown={(e) => {\n                        if (e.key === \"Enter\" || e.key === \" \") {\n                          e.preventDefault()\n                          onSelectSection(sec.id === \"fototeca\" ? \"fototeca-videos\" : \"media-gallery-videos\")\n                        }\n                      }}\n                      role=\"button\"\n                      tabIndex={0}\n                    >\n                      {t(\"videos\")}\n                    </div>\n                  </>\n                ) : (\n                  <div\n                    className={`sidebar-section-item ${currentSection === sec.id ? \"active\" : \"\"}`}\n                    onClick={() => onSelectSection(sec.id)}\n                    onKeyDown={(e) => {\n                      if (e.key === \"Enter\" || e.key === \" \") {\n                        e.preventDefault()\n                        onSelectSection(sec.id)\n                      }\n                    }}\n                    role=\"button\"\n                    tabIndex={0}\n                  >\n                    Ver {sec.label.toLowerCase()}\n                  </div>\n                )}\n              </div>\n            </div>\n          ))}\n      </div>\n    </aside>\n  )\n}\n","path":null,"size_bytes":7708,"size_tokens":null},"src/layout/country-sidebar.css":{"content":"/* VELUM Sidebar Styles */\n.velum-block {\n  background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);\n  border-radius: 6px;\n  padding: 8px;\n  margin-bottom: 8px;\n  border-left: 3px solid #1a6483;\n}\n\n.velum-title {\n  color: #1a6483 !important;\n  font-size: 18px !important;\n}\n\n.velum-submenu {\n  margin-top: 8px;\n  display: flex;\n  flex-direction: column;\n  gap: 0;\n  animation: slideDown 0.25s cubic-bezier(0.2, 0.8, 0.2, 1);\n}\n\n.velum-item {\n  font-size: 14px;\n  padding: 6px 12px;\n  cursor: pointer;\n  color: #07202bff;\n  transition: all 0.2s ease;\n  border-radius: 4px;\n  margin-left: 0;\n  background: transparent;\n  font-family: Georgia, \"Times New Roman\", serif;\n}\n\n.velum-item:hover {\n  background: rgba(26, 100, 131, 0.1);\n  color: #1a6483;\n}\n\n.velum-item.active {\n  background: rgba(26, 100, 131, 0.15);\n  color: #1a6483;\n  font-weight: 600;\n}\n\n/* Complete redesign with minimalista aesthetic and improved responsiveness */\n.country-sidebar {\n  width: 220px; /* Reduced from 280px */\n  min-width:170px;\n\n  padding: 0px 30px; /* Reduced padding */\n  overflow-y: auto;\n  position: relative;\n  scrollbar-width: none;\n  scale: 0.9;\n \n  /* Fix height calculation to ensure sidebar doesn't get cut off by footer */\n\n  z-index: 70;\n  border: 1px solid #07202bff;\n   \n      border-radius: 5px;\n}\n\n.sidebar-inner {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n}\n\n/* Minimalista section title styling */\n.sidebar-title {\n  font-size: 22px;\n  font-weight: 700;\n  cursor: pointer;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 10px 0;\n  user-select: none;\n  color: #07202bff;\n  text-transform: none;\n  letter-spacing: 0.6px;\n  transition: color 0.2s ease;\n  border: none;\n  background: none;\nfont-family: Cormorant Garamond, serif;\n}\n\n.sidebar-title:hover {\n  color: #1a6483  ;\n}\n\n/* .sidebar-title:focus {\n  outline: 2px solid #8b0000;\n  outline-offset: 2px;\n} */\n\n.arrow {\n  transition: transform 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);\n  font-size: 12px;\n  color: #999;\n}\n\n.arrow.open {\n  transform: rotate(180deg);\n}\n\n/* Smooth submenu animation */\n.termino-submenu {\n  margin-top: 8px;\n  display: flex;\n  flex-direction: column;\n  gap: 0;\n  animation: slideDown 0.25s cubic-bezier(0.2, 0.8, 0.2, 1);\n}\n\n@keyframes slideDown {\n  from {\n    opacity: 0;\n    max-height: 0;\n    transform: translateY(-4px);\n  }\n  to {\n    opacity: 1;\n    max-height: 500px;\n    transform: translateY(0);\n  }\n}\n\n/* Minimalista menu items */\n.termino-item {\n  font-size: 16px;\n  padding: 2px 20px;\n  cursor: pointer;\n  color: #07202bff;\n  transition: all 0.2s ease;\n  /* border-left: 2px solid transparent; */\n  border-radius: 0;\n  margin-left: 0;\n  background: transparent;\n font-family: Georgia, \"Times New Roman\", serif;\n  \n}\n\n.termino-item:hover {\n  background: transparent;\n  border-left: 1px solid #1a6483 ;\n  color: #1a6483  ;\n  padding-left: 12px; /* Adjusted to match new padding */\n  font-weight: bold;\n}\n\n.termino-item.active {\n  background: #fafafa;\n  border-left: 1px solid #0d2e3c ;\n  color: #1a6483 ;\n  font-weight: 600;\n  padding-left: 12px; /* Adjusted to match new padding */\n   font-weight: bold;\n}\n\n/* Country name with minimalista styling */\n.sidebar-country-name {\n  font-size: 30px; /* Reduced from 26px */\n  font-weight: 400; /* Lighter weight looks more elegant */\n  margin: 12px 0 16px 0; /* Reduced margin */\n  color: #1a6483;\n  font-family: var(--wiki-font-serif);\n  line-height: 1.2;\n  padding-bottom: 16px;\n  border-bottom: 1px solid #1a6483;\n  word-wrap: break-word;\n}\n\n/* Section headers */\n.sidebar-section-title {\n   font-size: 22px;\n  font-weight: 700;\n  cursor: pointer;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  /* padding: 10px 0; */\n  user-select: none;\n  color: #0d2e3c;\n  text-transform: none;\n  letter-spacing: 0.6px;\n  transition: color 0.2s ease;\n  border: none;\n  background: none;\n  font-family: Cormorant Garamond, serif;\n}\n\n/* Section list */\n.sidebar-section-list {\n  display: flex;\n  flex-direction: column;\n  gap: 0;\n}\n\n.sidebar-section-item {\n   \n  font-size: 16px;\n  padding: 2px 20px;\n  cursor: pointer;\n  color: #0d2e3c;\n  transition: all 0.2s ease;\n  /* border-left: 2px solid transparent; */\n  border-radius: 0;\n  margin-left: 0;\n  background: transparent;\n  font-family: Georgia, \"Times New Roman\", serif;\n  /* font-style: italic; */\n\n}\n\n.sidebar-section-item:hover {\n  background: transparent;\n  border-left: 1px solid #0d2e3c;\n  color: #1a6483 ;\n  padding-left: 12px; /* Adjusted to match new padding */\n   font-weight: bold;\n}\n\n.sidebar-section-item.active {\n  \n  border-left: 1px solid #0d2e3c;\n  color: #1a6483;\n  font-weight: 600;\n  padding-left: 12px; /* Adjusted to match new padding */\n   font-weight: bold;\n}\n\n/* Responsive: Hide sidebar on tablets and below */\n@media (max-width: 1024px) {\n  .country-sidebar {\n    width: 220px;\n    min-width: 220px;\n    padding: 16px 12px;\n  }\n\n  .sidebar-country-name {\n    font-size: 20px;\n  }\n\n  .sidebar-title {\n    font-size: 12px;\n  }\n\n  .termino-item,\n  .sidebar-section-item {\n    font-size: 12px; /* Already updated globally to 12px */\n    padding: 7px 10px;\n  }\n\n  .termino-item:hover,\n  .sidebar-section-item:hover {\n    padding-left: 12px;\n  }\n\n  .termino-item.active,\n  .sidebar-section-item.active {\n    padding-left: 12px;\n  }\n}\n\n@media (max-width: 860px) {\n  .country-sidebar {\n    display: none;\n  }\n}\n","path":null,"size_bytes":5387,"size_tokens":null},"src/components/WorldMap.css":{"content":"/* Fixing map container to fill available space correctly */\n.map-wrapper {\n  width: 100%;\n  height: 70vh;\n  min-height: 500px;\n  position: fixed;\n \n}\n\n/* Removed tooltip-card styles as it's no longer used */\n\n/* Fixed backslash and double semicolon syntax errors */\n.tooltip-card h3 {\n  color: #16a34a;\n  font-size: 1.5rem;\n  font-family: Cormorant Garamond;\n}\n\n/* Adding pulsating circle animation for conflict zones */\n@keyframes pulsate {\n  0% {\n    transform: scale(0.2);\n    opacity: 1;\n  }\n  100% {\n    transform: scale(1.5);\n    opacity: 0;\n  }\n}\n\n.conflict-marker {\n  position: absolute;\n  pointer-events: none;\n  z-index: 50;\n}\n\n.conflict-marker-pin {\n  position: absolute;\n  width: 12px;\n  height: 12px;\n  background: #ef4444;\n  border-radius: 50%;\n  transform: translate(-50%, -50%);\n  cursor: pointer;\n  pointer-events: all;\n  z-index: 52;\n  box-shadow: 0 2px 8px rgba(239, 68, 68, 0.6);\n}\n\n.conflict-marker-pin:hover {\n  background: #dc2626;\n  transform: translate(-50%, -50%) scale(1.2);\n}\n\n.conflict-marker-pulse {\n  position: absolute;\n  width: 40px;\n  height: 40px;\n  border: 2px solid #ef4444;\n  border-radius: 50%;\n  transform: translate(-50%, -50%);\n  animation: pulsate 2.5s ease-out infinite;\n  pointer-events: none;\n}\n\n.conflict-marker-pulse:nth-child(2) {\n  animation-delay: 0.5s;\n}\n\n.conflict-marker-pulse:nth-child(3) {\n  animation-delay: 1s;\n}\n\n.conflict-marker-pulse:nth-child(4) {\n  animation-delay: 1.5s;\n}\n\n/* Updated styles for teardrop pin markers */\n.capital-marker-pin {\n  transition: transform 0.2s ease, fill 0.2s ease;\n  filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));\n}\n\n.capital-marker-pin:hover {\n  transform: scale(1.15);\n  filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.4));\n}\n\n/* Updated popup to show on hover without close button */\n.country-popup {\n  background: #ffffff;\n  border-radius: 12px;\n  max-width: 400px;\n  width: 90%;\n  overflow: hidden;\n  position: fixed;\n  transform: translate(-50%, 0);\n  animation: slideUp 0.3s ease;\n  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);\n  z-index: 1000;\n  pointer-events: none;\n}\n\n@keyframes slideUp {\n  from {\n    transform: translate(-50%, 20px);\n    opacity: 0;\n  }\n  to {\n    transform: translate(-50%, 0);\n    opacity: 1;\n  }\n}\n\n.country-popup-image {\n  width: 100%;\n  height: 250px;\n  object-fit: cover;\n}\n\n.country-popup-content {\n  padding: 24px;\n}\n\n.country-popup-title {\n  font-size: 28px;\n  font-weight: bold;\n  color: #1f2937;\n  margin: 0 0 12px 0;\n  font-family: \"Cormorant Garamond\", serif;\n}\n\n.country-popup-description {\n  font-size: 16px;\n  color: #6b7280;\n  line-height: 1.6;\n  margin: 0;\n}\n/* --- EFECTO PAÃS SE LEVANTA SUAVEMENTE --- */\n.country-lift {\n  transition: transform 0.25s ease, filter 0.25s ease;\n}\n\n.country-lift:hover {\n  transform: translateY(4px);\n  filter: drop-shadow(0 0 6px rgba(212, 203, 203, 0.25));\n}\n\n\n/* --- EFECTO SUTIL PARA PAÃSES EN CONFLICTO --- */\n.conflict-country {\n  filter: brightness(1.1);\n  transition: filter 0.3s ease;\n}\n.country-lifted {\n  transform: translateY(-4px);\n  filter: drop-shadow(0 0 6px rgba(0,0,0,0.25));\n  transition: transform 0.25s ease, filter 0.25s ease;\n}\n/* Ondas de conflicto elegantes */\n.conflict-wave {\n  fill: none;\n  stroke: #8b0000;\n  stroke-width: 1.5;\n  opacity: 0;\n  animation: conflictPulse 3s ease-out infinite;\n  transform-origin: center;\n}\n\n.conflict-wave:nth-child(1) { animation-delay: 0s; }\n.conflict-wave:nth-child(2) { animation-delay: 1s; }\n.conflict-wave:nth-child(3) { animation-delay: 2s; }\n\n@keyframes conflictPulse {\n  0% {\n    r: 0;\n    opacity: 0.5;\n  }\n  100% {\n    r: 30px;\n    opacity: 0;\n  }\n}\n\n/* Hover: elevacion suave sin vibracion */\n.conflict-marker-group {\n  pointer-events: all;\n  transform-origin: center;\n  transition: transform 0.2s ease, filter 0.2s ease;\n}\n\n.conflict-marker-group:hover {\n  transform: translateY(-3px) scale(1.05);\n  filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.2));\n}\n.country-popup-circle {\n  position: absolute;\n  top: -90px;\n  left: 320px;\n  width: 180px;\n  height: 180px;\n  border-radius: 50%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  background: rgba(255, 255, 255, 0.95);\n  backdrop-filter: blur(10px);\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);\n  padding: 15px;\n  text-align: center;\n  font-family: 'Cormorant Garamond', serif;\n  border: 1px solid rgba(0, 0, 0, 0.05);\n}\n","path":null,"size_bytes":4369,"size_tokens":null},"src/components/mobile-navigation.css":{"content":".mobile-navigation {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n  padding: 1rem;\n  background: #fafafa;\n  border-top: 1px solid #e0e0e0;\n  max-height: 400px;\n  overflow-y: auto;\n}\n\n.back-button {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0.75rem;\n  background: white;\n  border: 1px solid #e0e0e0;\n  border-radius: 6px;\n  cursor: pointer;\n  font-size: 0.875rem;\n  font-weight: 500;\n  color: #333;\n  transition: all 0.2s ease;\n}\n\n.back-button:hover {\n  background: #f5f5f5;\n  border-color: #8b0000;\n}\n\n.back-icon {\n  font-size: 1.2rem;\n}\n\n.sections-list {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n\n.section-item {\n  border: 1px solid #e0e0e0;\n  border-radius: 6px;\n  overflow: hidden;\n  background: white;\n}\n\n.section-header {\n  width: 100%;\n  padding: 0.75rem;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  background: white;\n  border: none;\n  cursor: pointer;\n  font-size: 0.875rem;\n  font-weight: 600;\n  color: #333;\n  transition: all 0.2s ease;\n}\n\n.section-header:hover {\n  background: #f9f9f9;\n}\n\n.section-header.expanded {\n  background: #f0f0f0;\n  border-bottom: 2px solid #8b0000;\n}\n\n.section-toggle {\n  font-size: 1.2rem;\n  color: #8b0000;\n}\n\n.categories-list {\n  display: flex;\n  flex-direction: column;\n  background: #fafafa;\n  border-top: 1px solid #e0e0e0;\n}\n\n.category-item {\n  padding: 0.75rem 1rem;\n  border: none;\n  background: transparent;\n  text-align: left;\n  cursor: pointer;\n  font-size: 0.8rem;\n  color: #666;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  transition: all 0.2s ease;\n}\n\n.category-item:hover {\n  background: white;\n  color: #8b0000;\n  padding-left: 1.25rem;\n}\n\n.category-arrow {\n  color: #8b0000;\n  font-size: 0.9rem;\n}\n\n.section-name {\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n\n.category-name {\n  flex: 1;\n}\n\n/* Scrollbar styling */\n.mobile-navigation::-webkit-scrollbar {\n  width: 6px;\n}\n\n.mobile-navigation::-webkit-scrollbar-track {\n  background: transparent;\n}\n\n.mobile-navigation::-webkit-scrollbar-thumb {\n  background: #ddd;\n  border-radius: 3px;\n}\n\n.mobile-navigation::-webkit-scrollbar-thumb:hover {\n  background: #999;\n}\n","path":null,"size_bytes":2198,"size_tokens":null},"src/components/MobileNavigation.jsx":{"content":"\"use client\"\nimport \"./mobile-navigation.css\"\n\nexport default function MobileNavigation() {\n  return null\n}\n","path":null,"size_bytes":108,"size_tokens":null},"src/layout/MediaGallery.jsx":{"content":"\"use client\"\n\nimport { useState } from \"react\"\nimport \"./media-gallery.css\"\n\nexport default function MediaGallery({ items }) {\n  const [selectedIndex, setSelectedIndex] = useState(null)\n\n  if (!items || items.length === 0) {\n    return (\n      <div className=\"media-empty\">\n        <p>No hay contenido multimedia disponible en esta secciÃ³n.</p>\n      </div>\n    )\n  }\n\n  const openItem = (index) => {\n    setSelectedIndex(index)\n    document.body.style.overflow = \"hidden\"\n  }\n\n  const closeItem = () => {\n    setSelectedIndex(null)\n    document.body.style.overflow = \"auto\"\n  }\n\n  const prevItem = () => setSelectedIndex((prev) => (prev === 0 ? items.length - 1 : prev - 1))\n  const nextItem = () => setSelectedIndex((prev) => (prev === items.length - 1 ? 0 : prev + 1))\n\n  const handleKeyDown = (e) => {\n    if (selectedIndex === null) return\n    if (e.key === \"ArrowLeft\") prevItem()\n    if (e.key === \"ArrowRight\") nextItem()\n    if (e.key === \"Escape\") closeItem()\n  }\n\n  return (\n    <div className=\"media-gallery\" onKeyDown={handleKeyDown} role=\"region\" aria-label=\"Media gallery\">\n      {/* GRID DE MINIATURAS */}\n      <div className=\"media-grid\">\n        {items.map((item, index) => (\n          <div\n            key={item.id}\n            className=\"media-card\"\n            onClick={() => openItem(index)}\n            onKeyDown={(e) => {\n              if (e.key === \"Enter\" || e.key === \" \") {\n                e.preventDefault()\n                openItem(index)\n              }\n            }}\n            role=\"button\"\n            tabIndex={0}\n            aria-label={`Open ${item.title}`}\n          >\n            {item.type === \"image\" && (\n              <img\n                src={item.url || \"/placeholder.svg\"}\n                alt={item.title}\n                className=\"media-thumb\"\n                onError={(e) => {\n                  e.target.src = \"/placeholder.svg?height=200&width=300&text=Imagen+no+disponible\"\n                }}\n              />\n            )}\n            {item.type === \"video\" && <video src={item.url} className=\"media-thumb\" muted preload=\"metadata\" />}\n            <div className=\"media-title\">{item.title}</div>\n          </div>\n        ))}\n      </div>\n\n      {/* MODAL DE DETALLE */}\n      {selectedIndex !== null && (\n        <div className=\"media-modal\" onClick={closeItem} role=\"dialog\" aria-modal=\"true\">\n          <button className=\"media-close\" onClick={closeItem} aria-label=\"Close media viewer\" title=\"Close (Esc)\">\n            Ã—\n          </button>\n          <button\n            className=\"media-prev\"\n            onClick={(e) => {\n              e.stopPropagation()\n              prevItem()\n            }}\n            aria-label=\"Previous item\"\n            title=\"Previous (Arrow Left)\"\n          >\n            â€¹\n          </button>\n          <button\n            className=\"media-next\"\n            onClick={(e) => {\n              e.stopPropagation()\n              nextItem()\n            }}\n            aria-label=\"Next item\"\n            title=\"Next (Arrow Right)\"\n          >\n            â€º\n          </button>\n\n          <div className=\"media-detail-content\" onClick={(e) => e.stopPropagation()}>\n            {items[selectedIndex].type === \"image\" && (\n              <img\n                src={items[selectedIndex].url || \"/placeholder.svg\"}\n                alt={items[selectedIndex].title}\n                className=\"media-full\"\n                onError={(e) => {\n                  e.target.src = \"/placeholder.svg?height=600&width=800&text=Imagen+no+disponible\"\n                }}\n              />\n            )}\n            {items[selectedIndex].type === \"video\" && (\n              <video className=\"media-full\" controls>\n                <source src={items[selectedIndex].url} type=\"video/mp4\" />\n              </video>\n            )}\n            <h3 className=\"media-detail-title\">{items[selectedIndex].title}</h3>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n","path":null,"size_bytes":3932,"size_tokens":null},"src/context/LanguageContext.js":{"content":"\"use client\"\n\nimport { createContext, useState, useContext, useEffect } from \"react\"\n\nconst LanguageContext = createContext()\n\nconst translations = {\n  es: {\n    \"search-placeholder\": \"Buscar en WikiConflicts...\",\n    language: \"Language\",\n    collaborate: \"Colaborar\",\n    characters: \"Personajes\",\n    organizations: \"Organizaciones\",\n    concepts: \"Conceptos\",\n    ukraine: \"Ukraine\",\n    \"conflict-description\": \"Descripcion del conflicto\",\n    \"see-testimonies\": \"Ver testimonios\",\n    \"see-analysis\": \"Ver analisis\",\n    photos: \"Fotos\",\n    videos: \"Videos\",\n    \"no-content\": \"No hay contenido disponible para esta seccion.\",\n    footer: \"Â© 2025 WikiConflicts â€” Todos los derechos reservados\",\n    timeline: \"Cronologia\",\n    \"timeline-subtitle\": \"Principales acontecimientos del conflicto\",\n    resistance: \"Resistencia\",\n    guardians: \"Guardianes\",\n    victims: \"Victimas\",\n    sources: \"Fuentes\",\n    \"back-button\": \"Volver\",\n    loading: \"Cargando...\",\n    \"available-testimonies\": \"Testimonios disponibles\",\n    \"available-analyses\": \"Analisis disponibles\",\n    \"velum-articles\": \"Ver investigaciones\",\n    \"velum-title\": \"Micro-tesis e Investigaciones\",\n    \"velum-abstract\": \"Resumen\",\n    \"velum-keywords\": \"Palabras clave\",\n    \"velum-sections\": \"Secciones\",\n    \"velum-bibliography\": \"Bibliografia\",\n    \"velum-no-articles\": \"No hay articulos disponibles\",\n    Terminologia: \"Terminologia\",\n  },\n  en: {\n    \"search-placeholder\": \"Search WikiConflicts...\",\n    language: \"Language\",\n    collaborate: \"Collaborate\",\n    characters: \"Characters\",\n    organizations: \"Organizations\",\n    concepts: \"Concepts\",\n    ukraine: \"Ukraine\",\n    \"conflict-description\": \"Conflict Description\",\n    \"see-testimonies\": \"See testimonies\",\n    \"see-analysis\": \"See analysis\",\n    photos: \"Photos\",\n    videos: \"Videos\",\n    \"no-content\": \"No content available for this section.\",\n    footer: \"Â© 2025 WikiConflicts â€” All rights reserved\",\n    timeline: \"Timeline\",\n    \"timeline-subtitle\": \"Major events of the conflict\",\n    resistance: \"Resistance\",\n    guardians: \"Guardians\",\n    victims: \"Victims\",\n    sources: \"Sources\",\n    \"back-button\": \"Back\",\n    loading: \"Loading...\",\n    \"available-testimonies\": \"Available testimonies\",\n    \"available-analyses\": \"Available analyses\",\n    \"velum-articles\": \"View research\",\n    \"velum-title\": \"Micro-theses and Research\",\n    \"velum-abstract\": \"Abstract\",\n    \"velum-keywords\": \"Keywords\",\n    \"velum-sections\": \"Sections\",\n    \"velum-bibliography\": \"Bibliography\",\n    \"velum-no-articles\": \"No articles available\",\n    Terminologia: \"Terminology\",\n  },\n  ar: {\n    \"search-placeholder\": \"Ø§Ø¨Ø­Ø« ÙÙŠ ÙˆÙŠÙƒÙŠ ÙƒÙˆÙ†ÙÙ„ÙŠÙƒØªØ³...\",\n    language: \"Ø§Ù„Ù„ØºØ©\",\n    collaborate: \"ØªØ¹Ø§ÙˆÙ†\",\n    characters: \"Ø§Ù„Ø´Ø®ØµÙŠØ§Øª\",\n    organizations: \"Ø§Ù„Ù…Ù†Ø¸Ù…Ø§Øª\",\n    concepts: \"Ø§Ù„Ù…ÙØ§Ù‡ÙŠÙ…\",\n    ukraine: \"Ø£ÙˆÙƒØ±Ø§Ù†ÙŠØ§\",\n    \"conflict-description\": \"ÙˆØµÙ Ø§Ù„Ù†Ø²Ø§Ø¹\",\n    \"see-testimonies\": \"Ø¹Ø±Ø¶ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª\",\n    \"see-analysis\": \"Ø¹Ø±Ø¶ Ø§Ù„ØªØ­Ù„ÙŠÙ„\",\n    photos: \"Ø§Ù„ØµÙˆØ±\",\n    videos: \"Ù…Ù‚Ø§Ø·Ø¹ ÙÙŠØ¯ÙŠÙˆ\",\n    \"no-content\": \"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­ØªÙˆÙŠØ§Øª Ù…ØªØ§Ø­Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù….\",\n    footer: \"Â© 2025 WikiConflicts â€” Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©\",\n    timeline: \"Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ\",\n    \"timeline-subtitle\": \"Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ù„Ù†Ø²Ø§Ø¹\",\n    resistance: \"Ø§Ù„Ù…Ù‚Ø§ÙˆÙ…Ø©\",\n    guardians: \"Ø§Ù„Ø­Ø±Ø§Ø³\",\n    victims: \"Ø§Ù„Ø¶Ø­Ø§ÙŠØ§\",\n    sources: \"Ø§Ù„Ù…ØµØ§Ø¯Ø±\",\n    \"back-button\": \"Ø±Ø¬ÙˆØ¹\",\n    loading: \"Ø¬Ø§Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„...\",\n    \"available-testimonies\": \"Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©\",\n    \"available-analyses\": \"Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©\",\n    \"velum-articles\": \"Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ø­ÙˆØ«\",\n    \"velum-title\": \"Ø±Ø³Ø§Ø¦Ù„ Ù…ØµØºØ±Ø© ÙˆØ¨Ø­ÙˆØ«\",\n    \"velum-abstract\": \"Ù…Ù„Ø®Øµ\",\n    \"velum-keywords\": \"Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ©\",\n    \"velum-sections\": \"Ø§Ù„Ø£Ù‚Ø³Ø§Ù…\",\n    \"velum-bibliography\": \"Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹\",\n    \"velum-no-articles\": \"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‚Ø§Ù„Ø§Øª Ù…ØªØ§Ø­Ø©\",\n    Terminologia: \"Ø§Ù„Ù…ØµØ·Ù„Ø­Ø§Øª\",\n  },\n  eu: {\n    \"search-placeholder\": \"Bilatu WikiConflicts-en...\",\n    language: \"Hizkuntza\",\n    collaborate: \"Lagundu\",\n    characters: \"Pertsonaiak\",\n    organizations: \"Erakundeak\",\n    concepts: \"Kontzeptuak\",\n    ukraine: \"Ukraina\",\n    \"conflict-description\": \"Gatazkaren deskribapena\",\n    \"see-testimonies\": \"Testigantzak ikusi\",\n    \"see-analysis\": \"Azterketa ikusi\",\n    photos: \"Argazkiak\",\n    videos: \"Bideoak\",\n    \"no-content\": \"Ez dago edukirik atal honetarako.\",\n    footer: \"Â© 2025 WikiConflicts â€” Eskubide guztiak erreserbatuta\",\n    timeline: \"Kronologia\",\n    \"timeline-subtitle\": \"Gatazkaren gertaera nagusiak\",\n    resistance: \"Erresistentzia\",\n    guardians: \"Zaindari\",\n    victims: \"Biktimak\",\n    sources: \"Iturriak\",\n    \"back-button\": \"Itzuli\",\n    loading: \"Kargatzen...\",\n    \"available-testimonies\": \"Testigantza eskuragarriak\",\n    \"available-analyses\": \"Azterketa eskuragarriak\",\n    \"velum-articles\": \"Ikusi ikerketak\",\n    \"velum-title\": \"Mikro-tesiak eta Ikerketak\",\n    \"velum-abstract\": \"Laburpena\",\n    \"velum-keywords\": \"Hitz gakoak\",\n    \"velum-sections\": \"Atalak\",\n    \"velum-bibliography\": \"Bibliografia\",\n    \"velum-no-articles\": \"Ez dago artikulurik eskuragarri\",\n    Terminologia: \"Terminologia\",\n  },\n}\n\nexport function LanguageProvider({ children }) {\n  const [lang, setLang] = useState(() => {\n    return localStorage.getItem(\"wikilang\") || \"es\"\n  })\n\n  useEffect(() => {\n    localStorage.setItem(\"wikilang\", lang)\n    document.documentElement.lang = lang\n  }, [lang])\n\n  const t = (key) => {\n    return translations[lang]?.[key] || translations.es[key] || key\n  }\n\n  return <LanguageContext.Provider value={{ lang, setLang, t }}>{children}</LanguageContext.Provider>\n}\n\nexport function useLanguage() {\n  return useContext(LanguageContext)\n}\n","path":null,"size_bytes":5887,"size_tokens":null},"src/index.js":{"content":"import React from \"react\";\nimport ReactDOM from \"react-dom/client\";\nimport App from \"./App\";\nimport { LanguageProvider } from \"./context/LanguageContext\";\n\nReactDOM.createRoot(document.getElementById(\"root\")).render(\n  <LanguageProvider>\n    <App />\n  </LanguageProvider>\n);\n","path":null,"size_bytes":275,"size_tokens":null},"src/admin/AdminCountry.js":{"content":"import React, { useState, useEffect } from 'react';\nimport { useParams, Link, useNavigate } from 'react-router-dom';\nimport { useAuth } from '../context/AuthContext';\nimport TimelineEditor from './components/TimelineEditor';\nimport TestimoniesEditor from './components/TestimoniesEditor';\nimport AnalystsEditor from './components/AnalystsEditor';\nimport FototecaEditor from './components/FototecaEditor';\nimport ResistanceEditor from './components/ResistanceEditor';\nimport VelumEditor from './components/VelumEditor';\nimport './admin.css';\n\nexport default function AdminCountry() {\n  const { countryCode } = useParams();\n  const { user, getAuthHeaders } = useAuth();\n  const navigate = useNavigate();\n  const [country, setCountry] = useState(null);\n  const [activeSection, setActiveSection] = useState('velum');\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadCountry();\n  }, [countryCode]);\n\n  async function loadCountry() {\n    try {\n      const res = await fetch(`/api/cms/countries?lang=es`, { headers: getAuthHeaders() });\n      if (res.ok) {\n        const data = await res.json();\n        const found = data.countries.find(c => c.code === countryCode);\n        if (found) {\n          setCountry(found);\n        } else {\n          navigate('/admin');\n        }\n      }\n    } catch (error) {\n      console.error('Error loading country:', error);\n    }\n    setLoading(false);\n  }\n\n  if (loading) {\n    return <div className=\"admin-loading\">Cargando...</div>;\n  }\n\n  if (!country) {\n    return <div className=\"admin-loading\">PaÃ­s no encontrado</div>;\n  }\n\n  const sections = [\n    { id: 'velum', label: 'VELUM', icon: 'ðŸ“œ' },\n    { id: 'timeline', label: 'Timeline', icon: 'ðŸ“…' },\n    { id: 'testimonies', label: 'Testimonios', icon: 'ðŸ‘¤' },\n    { id: 'resistance', label: 'Resistencia', icon: 'âœŠ' },\n    { id: 'analysts', label: 'Analistas', icon: 'ðŸ“Š' },\n    { id: 'photos', label: 'Fotos', icon: 'ðŸ“·' },\n    { id: 'videos', label: 'Videos', icon: 'ðŸŽ¬' }\n  ];\n\n  return (\n    <div className=\"admin-container\">\n      <header className=\"admin-header\">\n        <div className=\"admin-header-left\">\n          <Link to=\"/admin\" className=\"admin-back-link\">â† Volver</Link>\n          <h1>{country.name}</h1>\n        </div>\n        <div className=\"admin-header-right\">\n          <span className=\"admin-user-name\">{user.name}</span>\n        </div>\n      </header>\n\n      <div className=\"admin-country-layout\">\n        <aside className=\"admin-sidebar\">\n          <nav className=\"admin-sidebar-nav\">\n            {sections.map(section => (\n              <button\n                key={section.id}\n                className={`admin-sidebar-item ${activeSection === section.id ? 'active' : ''}`}\n                onClick={() => setActiveSection(section.id)}\n              >\n                <span className=\"admin-sidebar-icon\">{section.icon}</span>\n                {section.label}\n              </button>\n            ))}\n          </nav>\n        </aside>\n\n        <main className=\"admin-content\">\n          {activeSection === 'velum' && (\n            <VelumEditor countryCode={countryCode} />\n          )}\n          {activeSection === 'timeline' && (\n            <TimelineEditor countryCode={countryCode} />\n          )}\n          {activeSection === 'testimonies' && (\n            <TestimoniesEditor countryCode={countryCode} />\n          )}\n          {activeSection === 'resistance' && (\n            <ResistanceEditor countryCode={countryCode} />\n          )}\n          {activeSection === 'analysts' && (\n            <AnalystsEditor countryCode={countryCode} />\n          )}\n          {activeSection === 'photos' && (\n            <FototecaEditor countryCode={countryCode} mediaType=\"image\" />\n          )}\n          {activeSection === 'videos' && (\n            <FototecaEditor countryCode={countryCode} mediaType=\"video\" />\n          )}\n        </main>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":3918,"size_tokens":null},"src/admin/components/FototecaEditor.js":{"content":"import React, { useState, useEffect } from 'react';\nimport { useAuth } from '../../context/AuthContext';\n\nexport default function FototecaEditor({ countryCode, mediaType = null }) {\n  const { user, getAuthHeaders } = useAuth();\n  const [items, setItems] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [showModal, setShowModal] = useState(false);\n  const [editingItem, setEditingItem] = useState(null);\n  const [uploading, setUploading] = useState(false);\n\n  const sectionTitle = mediaType === 'image' ? 'Fotos' : mediaType === 'video' ? 'Videos' : 'Fototeca';\n\n  const [formData, setFormData] = useState({\n    title: '',\n    date: '',\n    description: '',\n    type: mediaType || 'image',\n    url: ''\n  });\n\n  useEffect(() => {\n    loadItems();\n  }, [countryCode]);\n\n  async function loadItems() {\n    try {\n      const res = await fetch(`/api/cms/countries/${countryCode}/fototeca`, { \n        headers: getAuthHeaders() \n      });\n      if (res.ok) {\n        const data = await res.json();\n        let allItems = data.items || [];\n        if (mediaType) {\n          allItems = allItems.filter(item => item.type === mediaType);\n        }\n        setItems(allItems);\n      }\n    } catch (error) {\n      console.error('Error loading fototeca:', error);\n    }\n    setLoading(false);\n  }\n\n  function openAddModal() {\n    setEditingItem(null);\n    setFormData({\n      title: '',\n      date: new Date().toISOString().split('T')[0],\n      description: '',\n      type: mediaType || 'image',\n      url: ''\n    });\n    setShowModal(true);\n  }\n\n  function openEditModal(item) {\n    setEditingItem(item);\n    setFormData({\n      title: item.title || '',\n      date: item.date || '',\n      description: item.description || '',\n      type: item.type || 'image',\n      url: item.url || ''\n    });\n    setShowModal(true);\n  }\n\n  async function handleFileUpload(e) {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    setUploading(true);\n    const uploadFormData = new FormData();\n    uploadFormData.append('images', file);\n\n    try {\n      const res = await fetch('/api/upload/images', {\n        method: 'POST',\n        headers: getAuthHeaders(),\n        body: uploadFormData\n      });\n\n      if (res.ok) {\n        const data = await res.json();\n        if (data.files && data.files.length > 0) {\n          setFormData(prev => ({ ...prev, url: data.files[0].url }));\n        }\n      } else {\n        alert('Error al subir archivo');\n      }\n    } catch (error) {\n      console.error('Error uploading:', error);\n    }\n    setUploading(false);\n  }\n\n  async function handleSave() {\n    if (!formData.title.trim() || !formData.url.trim()) {\n      alert('El tÃ­tulo y la URL son obligatorios');\n      return;\n    }\n\n    try {\n      const method = editingItem ? 'PUT' : 'POST';\n      const url = editingItem \n        ? `/api/cms/countries/${countryCode}/fototeca/${editingItem.id}`\n        : `/api/cms/countries/${countryCode}/fototeca`;\n\n      const res = await fetch(url, {\n        method,\n        headers: {\n          ...getAuthHeaders(),\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(formData)\n      });\n\n      if (res.ok) {\n        setShowModal(false);\n        loadItems();\n      } else {\n        const error = await res.json();\n        alert(error.error || 'Error al guardar');\n      }\n    } catch (error) {\n      console.error('Error saving:', error);\n    }\n  }\n\n  async function handleDelete(item) {\n    if (!window.confirm(`Â¿Eliminar \"${item.title}\"?`)) return;\n\n    try {\n      const res = await fetch(`/api/cms/countries/${countryCode}/fototeca/${item.id}`, {\n        method: 'DELETE',\n        headers: getAuthHeaders()\n      });\n\n      if (res.ok) {\n        loadItems();\n      }\n    } catch (error) {\n      console.error('Error deleting:', error);\n    }\n  }\n\n  if (loading) {\n    return <div className=\"admin-loading\">Cargando fototeca...</div>;\n  }\n\n  return (\n    <div className=\"admin-editor\">\n      <div className=\"admin-editor-header\">\n        <h2>{sectionTitle}</h2>\n        <button className=\"admin-btn-primary\" onClick={openAddModal}>\n          + Agregar {mediaType === 'image' ? 'foto' : mediaType === 'video' ? 'video' : 'elemento'}\n        </button>\n      </div>\n\n      <div className=\"admin-fototeca-grid\">\n        {items.map(item => (\n          <div key={item.id} className=\"admin-fototeca-item\">\n            <div className=\"admin-fototeca-media\">\n              {item.type === 'image' ? (\n                <img src={item.url} alt={item.title} />\n              ) : (\n                <video src={item.url} />\n              )}\n              <span className=\"admin-fototeca-type\">{item.type === 'image' ? 'ðŸ–¼ï¸' : 'ðŸŽ¬'}</span>\n            </div>\n            <div className=\"admin-fototeca-info\">\n              <span className=\"admin-fototeca-date\">{item.date}</span>\n              <h4 className=\"admin-fototeca-title\">{item.title}</h4>\n            </div>\n            <div className=\"admin-fototeca-actions\">\n              <button onClick={() => openEditModal(item)} title=\"Editar\">âœï¸</button>\n              <button onClick={() => handleDelete(item)} title=\"Eliminar\">ðŸ—‘ï¸</button>\n            </div>\n          </div>\n        ))}\n        {items.length === 0 && (\n          <div className=\"admin-empty\">\n            <p>No hay {mediaType === 'image' ? 'fotos' : mediaType === 'video' ? 'videos' : 'elementos'}</p>\n            <button className=\"admin-btn-primary\" onClick={openAddModal}>\n              Agregar {mediaType === 'image' ? 'primera foto' : mediaType === 'video' ? 'primer video' : 'primer elemento'}\n            </button>\n          </div>\n        )}\n      </div>\n\n      {showModal && (\n        <div className=\"admin-modal-overlay\" onClick={() => setShowModal(false)}>\n          <div className=\"admin-modal\" onClick={e => e.stopPropagation()}>\n            <div className=\"admin-modal-header\">\n              <h3>{editingItem ? 'Editar elemento' : 'Nuevo elemento'}</h3>\n              <button className=\"admin-modal-close\" onClick={() => setShowModal(false)}>Ã—</button>\n            </div>\n            <div className=\"admin-modal-body\">\n              {!mediaType && (\n                <div className=\"admin-form-group\">\n                  <label>Tipo</label>\n                  <select\n                    value={formData.type}\n                    onChange={e => setFormData(prev => ({ ...prev, type: e.target.value }))}\n                  >\n                    <option value=\"image\">Imagen</option>\n                    <option value=\"video\">Video</option>\n                  </select>\n                </div>\n              )}\n\n              <div className=\"admin-form-group\">\n                <label>TÃ­tulo *</label>\n                <input\n                  type=\"text\"\n                  value={formData.title}\n                  onChange={e => setFormData(prev => ({ ...prev, title: e.target.value }))}\n                  placeholder=\"TÃ­tulo del elemento\"\n                />\n              </div>\n\n              <div className=\"admin-form-group\">\n                <label>Fecha</label>\n                <input\n                  type=\"date\"\n                  value={formData.date}\n                  onChange={e => setFormData(prev => ({ ...prev, date: e.target.value }))}\n                />\n              </div>\n\n              <div className=\"admin-form-group\">\n                <label>DescripciÃ³n</label>\n                <textarea\n                  value={formData.description}\n                  onChange={e => setFormData(prev => ({ ...prev, description: e.target.value }))}\n                  placeholder=\"DescripciÃ³n del elemento\"\n                  rows={3}\n                />\n              </div>\n\n              <div className=\"admin-form-group\">\n                <label>Archivo *</label>\n                <div className=\"admin-file-upload\">\n                  <input\n                    type=\"file\"\n                    accept={formData.type === 'image' ? 'image/*' : 'video/*'}\n                    onChange={handleFileUpload}\n                    disabled={uploading}\n                  />\n                  {uploading && <span>Subiendo...</span>}\n                </div>\n                {formData.url && (\n                  <div className=\"admin-file-preview\">\n                    {formData.type === 'image' ? (\n                      <img src={formData.url} alt=\"Preview\" />\n                    ) : (\n                      <video src={formData.url} controls />\n                    )}\n                    <input\n                      type=\"text\"\n                      value={formData.url}\n                      onChange={e => setFormData(prev => ({ ...prev, url: e.target.value }))}\n                      placeholder=\"O ingresa la URL directamente\"\n                    />\n                  </div>\n                )}\n              </div>\n            </div>\n            <div className=\"admin-modal-footer\">\n              <button className=\"admin-btn-secondary\" onClick={() => setShowModal(false)}>\n                Cancelar\n              </button>\n              <button className=\"admin-btn-primary\" onClick={handleSave} disabled={uploading}>\n                {editingItem ? 'Guardar cambios' : 'Crear elemento'}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":9296,"size_tokens":null},"src/admin/components/ImageUploader.js":{"content":"import React, { useState } from 'react';\nimport { useAuth } from '../../context/AuthContext';\n\nexport default function ImageUploader({ value, onChange }) {\n  const { getAuthHeaders } = useAuth();\n  const [uploading, setUploading] = useState(false);\n  const [showGallery, setShowGallery] = useState(false);\n  const [gallery, setGallery] = useState([]);\n\n  async function handleUpload(e) {\n    const file = e.target.files[0];\n    if (!file) return;\n\n    setUploading(true);\n    const formData = new FormData();\n    formData.append('image', file);\n\n    try {\n      const res = await fetch('/api/upload/image', {\n        method: 'POST',\n        headers: getAuthHeaders(),\n        body: formData\n      });\n\n      if (res.ok) {\n        const data = await res.json();\n        onChange(data.url);\n      } else {\n        alert('Error al subir imagen');\n      }\n    } catch (error) {\n      console.error('Error uploading:', error);\n    }\n    setUploading(false);\n    e.target.value = '';\n  }\n\n  async function openGallery() {\n    try {\n      const res = await fetch('/api/upload/list', { headers: getAuthHeaders() });\n      if (res.ok) {\n        const data = await res.json();\n        setGallery(data.images || []);\n        setShowGallery(true);\n      }\n    } catch (error) {\n      console.error('Error loading gallery:', error);\n    }\n  }\n\n  function selectFromGallery(url) {\n    onChange(url);\n    setShowGallery(false);\n  }\n\n  return (\n    <div className=\"admin-image-uploader\">\n      {value && (\n        <div className=\"admin-image-preview\">\n          <img src={value} alt=\"Preview\" />\n          <button type=\"button\" onClick={() => onChange('')} className=\"admin-btn-remove-image\">\n            Ã—\n          </button>\n        </div>\n      )}\n      \n      <div className=\"admin-image-actions\">\n        <label className=\"admin-btn-upload\">\n          {uploading ? 'Subiendo...' : 'Subir imagen'}\n          <input\n            type=\"file\"\n            accept=\"image/*\"\n            onChange={handleUpload}\n            style={{ display: 'none' }}\n            disabled={uploading}\n          />\n        </label>\n        <button type=\"button\" onClick={openGallery} className=\"admin-btn-gallery\">\n          Elegir de galerÃ­a\n        </button>\n        <input\n          type=\"text\"\n          value={value || ''}\n          onChange={(e) => onChange(e.target.value)}\n          placeholder=\"O pegar URL de imagen\"\n          className=\"admin-image-url-input\"\n        />\n      </div>\n\n      {showGallery && (\n        <div className=\"admin-modal-overlay\" onClick={() => setShowGallery(false)}>\n          <div className=\"admin-modal gallery\" onClick={e => e.stopPropagation()}>\n            <h3>Seleccionar Imagen</h3>\n            <div className=\"admin-gallery-grid\">\n              {gallery.map(img => (\n                <div \n                  key={img.filename} \n                  className=\"admin-gallery-item\"\n                  onClick={() => selectFromGallery(img.url)}\n                >\n                  <img src={img.url} alt={img.filename} />\n                </div>\n              ))}\n              {gallery.length === 0 && (\n                <div className=\"admin-empty\">No hay imÃ¡genes en la galerÃ­a</div>\n              )}\n            </div>\n            <button type=\"button\" onClick={() => setShowGallery(false)} className=\"admin-btn-secondary\">\n              Cancelar\n            </button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":3434,"size_tokens":null},"server/index.js":{"content":"const express = require('express');\nconst cors = require('cors');\nconst cookieParser = require('cookie-parser');\nconst path = require('path');\nconst fs = require('fs');\n\nconst authRoutes = require('./routes/auth');\nconst cmsRoutes = require('./routes/cms');\nconst uploadRoutes = require('./routes/upload');\n\nconst app = express();\nconst PORT = 3001;\n\napp.use(cors({\n  origin: true,\n  credentials: true\n}));\napp.use(express.json({ limit: '50mb' }));\napp.use(express.urlencoded({ extended: true, limit: '50mb' }));\napp.use(cookieParser());\n\nconst dataDir = path.join(__dirname, 'data');\nif (!fs.existsSync(dataDir)) {\n  fs.mkdirSync(dataDir, { recursive: true });\n}\n\nconst usersFile = path.join(dataDir, 'users.json');\nconst isFirstRun = !fs.existsSync(usersFile);\nif (isFirstRun) {\n  const bcrypt = require('bcryptjs');\n  const crypto = require('crypto');\n  const initialPassword = process.env.ADMIN_INITIAL_PASSWORD || crypto.randomBytes(12).toString('base64').slice(0, 16);\n  \n  const defaultAdmin = {\n    users: [\n      {\n        id: 'admin',\n        username: 'admin',\n        password: bcrypt.hashSync(initialPassword, 10),\n        role: 'admin',\n        name: 'Administrador',\n        countries: ['all'],\n        permissions: {\n          canCreate: true,\n          canEdit: true,\n          canDelete: true,\n          requiresApproval: false\n        },\n        createdAt: new Date().toISOString(),\n        mustChangePassword: true\n      }\n    ]\n  };\n  fs.writeFileSync(usersFile, JSON.stringify(defaultAdmin, null, 2));\n  \n  console.log('\\n=== PRIMERA EJECUCION ===');\n  console.log('Usuario administrador creado:');\n  console.log('  Usuario: admin');\n  console.log(`  ContraseÃ±a: ${initialPassword}`);\n  console.log('IMPORTANTE: Cambie esta contraseÃ±a inmediatamente desde el panel de admin.');\n  console.log('===========================\\n');\n}\n\nconst pendingFile = path.join(dataDir, 'pending-changes.json');\nif (!fs.existsSync(pendingFile)) {\n  fs.writeFileSync(pendingFile, JSON.stringify({ changes: [] }, null, 2));\n}\n\napp.use('/api/auth', authRoutes);\napp.use('/api/cms', cmsRoutes);\napp.use('/api/upload', uploadRoutes);\n\napp.use('/uploads', express.static(path.join(__dirname, '../public/imagenes')));\n\napp.get('/api/health', (req, res) => {\n  res.json({ status: 'ok', timestamp: new Date().toISOString() });\n});\n\napp.listen(PORT, '0.0.0.0', () => {\n  console.log(`CMS Server running on port ${PORT}`);\n});\n","path":null,"size_bytes":2421,"size_tokens":null},"server/routes/auth.js":{"content":"const express = require('express');\nconst bcrypt = require('bcryptjs');\nconst jwt = require('jsonwebtoken');\nconst fs = require('fs');\nconst path = require('path');\nconst { v4: uuidv4 } = require('uuid');\nconst { authenticateToken, requireAdmin, JWT_SECRET } = require('../middleware/auth');\n\nconst router = express.Router();\nconst usersFile = path.join(__dirname, '../data/users.json');\n\nfunction getUsers() {\n  const data = fs.readFileSync(usersFile, 'utf8');\n  return JSON.parse(data);\n}\n\nfunction saveUsers(data) {\n  fs.writeFileSync(usersFile, JSON.stringify(data, null, 2));\n}\n\nrouter.post('/login', (req, res) => {\n  const { username, password } = req.body;\n\n  if (!username || !password) {\n    return res.status(400).json({ error: 'Usuario y contraseÃ±a requeridos' });\n  }\n\n  const data = getUsers();\n  const user = data.users.find(u => u.username === username);\n\n  if (!user) {\n    return res.status(401).json({ error: 'Credenciales invÃ¡lidas' });\n  }\n\n  const validPassword = bcrypt.compareSync(password, user.password);\n  if (!validPassword) {\n    return res.status(401).json({ error: 'Credenciales invÃ¡lidas' });\n  }\n\n  const token = jwt.sign(\n    {\n      id: user.id,\n      username: user.username,\n      role: user.role,\n      name: user.name,\n      countries: user.countries,\n      permissions: user.permissions\n    },\n    JWT_SECRET,\n    { expiresIn: '24h' }\n  );\n\n  res.cookie('token', token, {\n    httpOnly: true,\n    secure: process.env.NODE_ENV === 'production',\n    sameSite: 'lax',\n    maxAge: 24 * 60 * 60 * 1000\n  });\n\n  res.json({\n    success: true,\n    user: {\n      id: user.id,\n      username: user.username,\n      role: user.role,\n      name: user.name,\n      countries: user.countries,\n      permissions: user.permissions\n    },\n    token\n  });\n});\n\nrouter.post('/logout', (req, res) => {\n  res.clearCookie('token');\n  res.json({ success: true });\n});\n\nrouter.get('/me', authenticateToken, (req, res) => {\n  res.json({ user: req.user });\n});\n\nrouter.get('/users', authenticateToken, requireAdmin, (req, res) => {\n  const data = getUsers();\n  const usersWithoutPasswords = data.users.map(u => ({\n    id: u.id,\n    username: u.username,\n    role: u.role,\n    name: u.name,\n    countries: u.countries,\n    permissions: u.permissions,\n    createdAt: u.createdAt\n  }));\n  res.json({ users: usersWithoutPasswords });\n});\n\nrouter.post('/users', authenticateToken, requireAdmin, (req, res) => {\n  const { username, password, name, role, countries, permissions } = req.body;\n\n  if (!username || !password || !name) {\n    return res.status(400).json({ error: 'Faltan campos requeridos' });\n  }\n\n  const data = getUsers();\n  \n  if (data.users.find(u => u.username === username)) {\n    return res.status(400).json({ error: 'El usuario ya existe' });\n  }\n\n  const newUser = {\n    id: uuidv4(),\n    username,\n    password: bcrypt.hashSync(password, 10),\n    name,\n    role: role || 'editor',\n    countries: countries || [],\n    permissions: permissions || {\n      canCreate: true,\n      canEdit: false,\n      canDelete: false,\n      requiresApproval: true\n    },\n    createdAt: new Date().toISOString()\n  };\n\n  data.users.push(newUser);\n  saveUsers(data);\n\n  res.json({\n    success: true,\n    user: {\n      id: newUser.id,\n      username: newUser.username,\n      role: newUser.role,\n      name: newUser.name,\n      countries: newUser.countries,\n      permissions: newUser.permissions\n    }\n  });\n});\n\nrouter.put('/users/:id', authenticateToken, requireAdmin, (req, res) => {\n  const { id } = req.params;\n  const { name, password, role, countries, permissions } = req.body;\n\n  const data = getUsers();\n  const userIndex = data.users.findIndex(u => u.id === id);\n\n  if (userIndex === -1) {\n    return res.status(404).json({ error: 'Usuario no encontrado' });\n  }\n\n  if (name) data.users[userIndex].name = name;\n  if (password) data.users[userIndex].password = bcrypt.hashSync(password, 10);\n  if (role) data.users[userIndex].role = role;\n  if (countries) data.users[userIndex].countries = countries;\n  if (permissions) data.users[userIndex].permissions = permissions;\n\n  saveUsers(data);\n\n  res.json({\n    success: true,\n    user: {\n      id: data.users[userIndex].id,\n      username: data.users[userIndex].username,\n      role: data.users[userIndex].role,\n      name: data.users[userIndex].name,\n      countries: data.users[userIndex].countries,\n      permissions: data.users[userIndex].permissions\n    }\n  });\n});\n\nrouter.delete('/users/:id', authenticateToken, requireAdmin, (req, res) => {\n  const { id } = req.params;\n\n  const data = getUsers();\n  const userIndex = data.users.findIndex(u => u.id === id);\n\n  if (userIndex === -1) {\n    return res.status(404).json({ error: 'Usuario no encontrado' });\n  }\n\n  if (data.users[userIndex].username === 'admin') {\n    return res.status(400).json({ error: 'No se puede eliminar el administrador principal' });\n  }\n\n  data.users.splice(userIndex, 1);\n  saveUsers(data);\n\n  res.json({ success: true });\n});\n\nmodule.exports = router;\n","path":null,"size_bytes":4997,"size_tokens":null},"server/routes/upload.js":{"content":"const express = require('express');\nconst multer = require('multer');\nconst path = require('path');\nconst fs = require('fs');\nconst { v4: uuidv4 } = require('uuid');\nconst { authenticateToken } = require('../middleware/auth');\n\nconst router = express.Router();\n\nconst imagenesDir = path.join(__dirname, '../../public/imagenes');\nif (!fs.existsSync(imagenesDir)) {\n  fs.mkdirSync(imagenesDir, { recursive: true });\n}\n\nconst storage = multer.diskStorage({\n  destination: function (req, file, cb) {\n    cb(null, imagenesDir);\n  },\n  filename: function (req, file, cb) {\n    const ext = path.extname(file.originalname);\n    const name = path.basename(file.originalname, ext)\n      .replace(/[^a-zA-Z0-9_-]/g, '_')\n      .toLowerCase();\n    const uniqueName = `${name}_${uuidv4().slice(0, 8)}${ext}`;\n    cb(null, uniqueName);\n  }\n});\n\nconst fileFilter = (req, file, cb) => {\n  const allowedTypes = [\n    'image/jpeg', 'image/png', 'image/gif', 'image/webp',\n    'video/mp4', 'video/webm', 'video/ogg',\n    'audio/mpeg', 'audio/ogg', 'audio/wav', 'audio/mp3', 'audio/m4a'\n  ];\n  if (allowedTypes.includes(file.mimetype)) {\n    cb(null, true);\n  } else {\n    cb(new Error('Tipo de archivo no permitido'), false);\n  }\n};\n\nconst upload = multer({\n  storage,\n  fileFilter,\n  limits: {\n    fileSize: 50 * 1024 * 1024\n  }\n});\n\nrouter.post('/image', authenticateToken, upload.single('image'), (req, res) => {\n  if (!req.file) {\n    return res.status(400).json({ error: 'No se subiÃ³ ningÃºn archivo' });\n  }\n\n  const url = `/imagenes/${req.file.filename}`;\n  res.json({\n    success: true,\n    filename: req.file.filename,\n    url,\n    size: req.file.size\n  });\n});\n\nrouter.post('/images', authenticateToken, upload.array('images', 10), (req, res) => {\n  if (!req.files || req.files.length === 0) {\n    return res.status(400).json({ error: 'No se subieron archivos' });\n  }\n\n  const uploaded = req.files.map(file => ({\n    filename: file.filename,\n    url: `/imagenes/${file.filename}`,\n    size: file.size\n  }));\n\n  res.json({\n    success: true,\n    files: uploaded\n  });\n});\n\nrouter.post('/video', authenticateToken, upload.single('video'), (req, res) => {\n  if (!req.file) {\n    return res.status(400).json({ error: 'No se subiÃ³ ningÃºn archivo' });\n  }\n\n  const url = `/imagenes/${req.file.filename}`;\n  res.json({\n    success: true,\n    filename: req.file.filename,\n    url,\n    size: req.file.size\n  });\n});\n\nrouter.post('/media', authenticateToken, upload.single('file'), (req, res) => {\n  if (!req.file) {\n    return res.status(400).json({ error: 'No se subiÃ³ ningÃºn archivo' });\n  }\n\n  const url = `/imagenes/${req.file.filename}`;\n  res.json({\n    success: true,\n    filename: req.file.filename,\n    url,\n    size: req.file.size,\n    mimetype: req.file.mimetype\n  });\n});\n\nrouter.get('/list', authenticateToken, (req, res) => {\n  const files = fs.readdirSync(imagenesDir);\n  const images = files\n    .filter(f => /\\.(jpg|jpeg|png|gif|webp)$/i.test(f))\n    .map(f => ({\n      filename: f,\n      url: `/imagenes/${f}`\n    }));\n  \n  const videos = files\n    .filter(f => /\\.(mp4|webm)$/i.test(f))\n    .map(f => ({\n      filename: f,\n      url: `/imagenes/${f}`\n    }));\n\n  res.json({ images, videos });\n});\n\nrouter.delete('/:filename', authenticateToken, (req, res) => {\n  const { filename } = req.params;\n  \n  const sanitizedFilename = path.basename(filename);\n  \n  if (sanitizedFilename !== filename || \n      sanitizedFilename.includes('..') || \n      sanitizedFilename.includes('/') || \n      sanitizedFilename.includes('\\\\')) {\n    return res.status(400).json({ error: 'Nombre de archivo invÃ¡lido' });\n  }\n  \n  const filePath = path.join(imagenesDir, sanitizedFilename);\n  const resolvedPath = path.resolve(filePath);\n  const resolvedDir = path.resolve(imagenesDir);\n  \n  if (!resolvedPath.startsWith(resolvedDir + path.sep)) {\n    return res.status(403).json({ error: 'Acceso denegado' });\n  }\n\n  if (!fs.existsSync(filePath)) {\n    return res.status(404).json({ error: 'Archivo no encontrado' });\n  }\n\n  try {\n    fs.unlinkSync(filePath);\n    res.json({ success: true });\n  } catch (error) {\n    res.status(500).json({ error: 'Error al eliminar el archivo' });\n  }\n});\n\nmodule.exports = router;\n","path":null,"size_bytes":4200,"size_tokens":null},"src/context/AuthContext.js":{"content":"import React, { createContext, useContext, useState, useEffect } from 'react';\n\nconst AuthContext = createContext(null);\n\nexport function AuthProvider({ children }) {\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [token, setToken] = useState(localStorage.getItem('token'));\n\n  useEffect(() => {\n    checkAuth();\n  }, []);\n\n  async function checkAuth() {\n    const savedToken = localStorage.getItem('token');\n    if (!savedToken) {\n      setLoading(false);\n      return;\n    }\n\n    try {\n      const res = await fetch('/api/auth/me', {\n        headers: {\n          'Authorization': `Bearer ${savedToken}`\n        }\n      });\n      if (res.ok) {\n        const data = await res.json();\n        setUser(data.user);\n        setToken(savedToken);\n      } else {\n        localStorage.removeItem('token');\n        setToken(null);\n      }\n    } catch (error) {\n      console.error('Auth check failed:', error);\n    }\n    setLoading(false);\n  }\n\n  async function login(username, password) {\n    const res = await fetch('/api/auth/login', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ username, password })\n    });\n\n    const data = await res.json();\n    \n    if (!res.ok) {\n      throw new Error(data.error || 'Error al iniciar sesiÃ³n');\n    }\n\n    localStorage.setItem('token', data.token);\n    setToken(data.token);\n    setUser(data.user);\n    return data.user;\n  }\n\n  async function logout() {\n    try {\n      await fetch('/api/auth/logout', { method: 'POST' });\n    } catch (e) {}\n    localStorage.removeItem('token');\n    setToken(null);\n    setUser(null);\n  }\n\n  function getAuthHeaders() {\n    return token ? { 'Authorization': `Bearer ${token}` } : {};\n  }\n\n  return (\n    <AuthContext.Provider value={{ user, loading, login, logout, token, getAuthHeaders }}>\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within AuthProvider');\n  }\n  return context;\n}\n","path":null,"size_bytes":2104,"size_tokens":null},"src/admin/AdminDashboard.js":{"content":"import React, { useState, useEffect } from 'react';\nimport { useNavigate, Link } from 'react-router-dom';\nimport { useAuth } from '../context/AuthContext';\nimport './admin.css';\n\nexport default function AdminDashboard() {\n  const { user, logout, getAuthHeaders } = useAuth();\n  const navigate = useNavigate();\n  const [countries, setCountries] = useState([]);\n  const [pendingCount, setPendingCount] = useState(0);\n  const [loading, setLoading] = useState(true);\n  const [showNewCountry, setShowNewCountry] = useState(false);\n  const [newCountry, setNewCountry] = useState({ code: '', name: '' });\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  async function loadData() {\n    try {\n      const [countriesRes, pendingRes] = await Promise.all([\n        fetch('/api/cms/countries?lang=es', { headers: getAuthHeaders() }),\n        user.role === 'admin' ? fetch('/api/cms/pending', { headers: getAuthHeaders() }) : Promise.resolve({ ok: true, json: () => ({ changes: [] }) })\n      ]);\n\n      if (countriesRes.ok) {\n        const data = await countriesRes.json();\n        setCountries(data.countries);\n      }\n\n      if (pendingRes.ok) {\n        const data = await pendingRes.json();\n        setPendingCount(data.changes?.length || 0);\n      }\n    } catch (error) {\n      console.error('Error loading data:', error);\n    }\n    setLoading(false);\n  }\n\n  async function handleCreateCountry(e) {\n    e.preventDefault();\n    try {\n      const res = await fetch('/api/cms/countries', {\n        method: 'POST',\n        headers: {\n          ...getAuthHeaders(),\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({ ...newCountry, lang: 'es' })\n      });\n\n      if (res.ok) {\n        setShowNewCountry(false);\n        setNewCountry({ code: '', name: '' });\n        loadData();\n      }\n    } catch (error) {\n      console.error('Error creating country:', error);\n    }\n  }\n\n  function handleLogout() {\n    logout();\n    navigate('/admin/login');\n  }\n\n  if (loading) {\n    return <div className=\"admin-loading\">Cargando...</div>;\n  }\n\n  return (\n    <div className=\"admin-container\">\n      <header className=\"admin-header\">\n        <div className=\"admin-header-left\">\n          <h1>Wiki<span>Conflicts</span> CMS</h1>\n        </div>\n        <div className=\"admin-header-right\">\n          <span className=\"admin-user-name\">{user.name}</span>\n          <span className=\"admin-user-role\">{user.role === 'admin' ? 'Administrador' : 'Editor'}</span>\n          <button onClick={handleLogout} className=\"admin-btn-logout\">Cerrar SesiÃ³n</button>\n        </div>\n      </header>\n\n      <nav className=\"admin-nav\">\n        <Link to=\"/admin\" className=\"admin-nav-item active\">PaÃ­ses</Link>\n        {user.role === 'admin' && (\n          <>\n            <Link to=\"/admin/users\" className=\"admin-nav-item\">Usuarios</Link>\n            <Link to=\"/admin/pending\" className=\"admin-nav-item\">\n              Pendientes {pendingCount > 0 && <span className=\"admin-badge\">{pendingCount}</span>}\n            </Link>\n          </>\n        )}\n        <Link to=\"/admin/media\" className=\"admin-nav-item\">Medios</Link>\n        <a href=\"/\" className=\"admin-nav-item admin-nav-back\">â† Volver al sitio</a>\n      </nav>\n\n      <main className=\"admin-main\">\n        <div className=\"admin-section\">\n          <div className=\"admin-section-header\">\n            <h2>PaÃ­ses</h2>\n            {(user.role === 'admin' || user.permissions?.canCreate) && (\n              <button onClick={() => setShowNewCountry(true)} className=\"admin-btn-primary\">\n                + Nuevo PaÃ­s\n              </button>\n            )}\n          </div>\n\n          {showNewCountry && (\n            <div className=\"admin-modal-overlay\">\n              <div className=\"admin-modal\">\n                <h3>Crear Nuevo PaÃ­s</h3>\n                <form onSubmit={handleCreateCountry}>\n                  <div className=\"admin-form-group\">\n                    <label>CÃ³digo (ej: syria, yemen)</label>\n                    <input\n                      type=\"text\"\n                      value={newCountry.code}\n                      onChange={(e) => setNewCountry({ ...newCountry, code: e.target.value.toLowerCase().replace(/[^a-z]/g, '') })}\n                      required\n                      placeholder=\"codigo-del-pais\"\n                    />\n                  </div>\n                  <div className=\"admin-form-group\">\n                    <label>Nombre</label>\n                    <input\n                      type=\"text\"\n                      value={newCountry.name}\n                      onChange={(e) => setNewCountry({ ...newCountry, name: e.target.value })}\n                      required\n                      placeholder=\"Nombre del PaÃ­s\"\n                    />\n                  </div>\n                  <div className=\"admin-modal-actions\">\n                    <button type=\"button\" onClick={() => setShowNewCountry(false)} className=\"admin-btn-secondary\">\n                      Cancelar\n                    </button>\n                    <button type=\"submit\" className=\"admin-btn-primary\">\n                      Crear PaÃ­s\n                    </button>\n                  </div>\n                </form>\n              </div>\n            </div>\n          )}\n\n          <div className=\"admin-countries-grid\">\n            {countries.map(country => {\n              const hasAccess = user.role === 'admin' || \n                user.countries?.includes('all') || \n                user.countries?.includes(country.code);\n              \n              return (\n                <div \n                  key={country.code} \n                  className={`admin-country-card ${!hasAccess ? 'disabled' : ''}`}\n                >\n                  <h3>{country.name}</h3>\n                  <p className=\"admin-country-code\">{country.code}</p>\n                  <p className=\"admin-country-sections\">\n                    {country.sections?.length || 0} secciones\n                  </p>\n                  {hasAccess ? (\n                    <Link to={`/admin/country/${country.code}`} className=\"admin-btn-secondary\">\n                      Gestionar\n                    </Link>\n                  ) : (\n                    <span className=\"admin-no-access\">Sin acceso</span>\n                  )}\n                </div>\n              );\n            })}\n\n            {countries.length === 0 && (\n              <div className=\"admin-empty\">\n                <p>No hay paÃ­ses configurados</p>\n                <p>Haz clic en \"Nuevo PaÃ­s\" para comenzar</p>\n              </div>\n            )}\n          </div>\n        </div>\n      </main>\n    </div>\n  );\n}\n","path":null,"size_bytes":6602,"size_tokens":null},"src/admin/components/MultiMediaUploader.js":{"content":"import React, { useState } from 'react';\nimport { useAuth } from '../../context/AuthContext';\n\nexport default function MultiMediaUploader({ value = [], onChange, allowedTypes = ['image', 'video', 'audio'] }) {\n  const { getAuthHeaders } = useAuth();\n  const [uploading, setUploading] = useState(false);\n\n  async function handleUpload(e) {\n    const files = Array.from(e.target.files);\n    if (!files.length) return;\n\n    setUploading(true);\n    const newMedia = [];\n\n    for (const file of files) {\n      const formData = new FormData();\n      formData.append('file', file);\n\n      try {\n        const res = await fetch('/api/upload/media', {\n          method: 'POST',\n          headers: getAuthHeaders(),\n          body: formData\n        });\n\n        if (res.ok) {\n          const data = await res.json();\n          const fileType = file.type.startsWith('video/') ? 'video' \n            : file.type.startsWith('audio/') ? 'audio' \n            : 'image';\n          newMedia.push({\n            url: data.url,\n            type: fileType,\n            caption: ''\n          });\n        }\n      } catch (error) {\n        console.error('Error uploading:', error);\n      }\n    }\n\n    onChange([...value, ...newMedia]);\n    setUploading(false);\n    e.target.value = '';\n  }\n\n  function updateCaption(index, caption) {\n    const updated = [...value];\n    updated[index] = { ...updated[index], caption };\n    onChange(updated);\n  }\n\n  function removeMedia(index) {\n    const updated = value.filter((_, i) => i !== index);\n    onChange(updated);\n  }\n\n  function moveMedia(index, direction) {\n    const newIndex = index + direction;\n    if (newIndex < 0 || newIndex >= value.length) return;\n    \n    const updated = [...value];\n    [updated[index], updated[newIndex]] = [updated[newIndex], updated[index]];\n    onChange(updated);\n  }\n\n  function addUrlMedia(url, type) {\n    if (!url.trim()) return;\n    onChange([...value, { url: url.trim(), type, caption: '' }]);\n  }\n\n  const acceptTypes = [];\n  if (allowedTypes.includes('image')) acceptTypes.push('image/*');\n  if (allowedTypes.includes('video')) acceptTypes.push('video/*');\n  if (allowedTypes.includes('audio')) acceptTypes.push('audio/*');\n\n  return (\n    <div className=\"admin-multi-media-uploader\">\n      <div className=\"admin-media-list\">\n        {value.map((media, index) => (\n          <div key={index} className=\"admin-media-item\">\n            <div className=\"admin-media-preview\">\n              {media.type === 'image' && (\n                <img src={media.url} alt={media.caption || `Media ${index + 1}`} />\n              )}\n              {media.type === 'video' && (\n                <video src={media.url} controls />\n              )}\n              {media.type === 'audio' && (\n                <audio src={media.url} controls />\n              )}\n              <span className=\"admin-media-type-badge\">\n                {media.type === 'image' ? 'ðŸ–¼ï¸' : media.type === 'video' ? 'ðŸŽ¬' : 'ðŸŽµ'}\n              </span>\n            </div>\n            <div className=\"admin-media-controls\">\n              <input\n                type=\"text\"\n                value={media.caption || ''}\n                onChange={(e) => updateCaption(index, e.target.value)}\n                placeholder=\"Pie de foto/video...\"\n                className=\"admin-media-caption\"\n              />\n              <div className=\"admin-media-buttons\">\n                <button \n                  type=\"button\" \n                  onClick={() => moveMedia(index, -1)} \n                  disabled={index === 0}\n                  className=\"admin-btn-mini\"\n                  title=\"Mover arriba\"\n                >\n                  â†‘\n                </button>\n                <button \n                  type=\"button\" \n                  onClick={() => moveMedia(index, 1)} \n                  disabled={index === value.length - 1}\n                  className=\"admin-btn-mini\"\n                  title=\"Mover abajo\"\n                >\n                  â†“\n                </button>\n                <button \n                  type=\"button\" \n                  onClick={() => removeMedia(index)} \n                  className=\"admin-btn-mini danger\"\n                  title=\"Eliminar\"\n                >\n                  Ã—\n                </button>\n              </div>\n            </div>\n          </div>\n        ))}\n      </div>\n\n      <div className=\"admin-media-actions\">\n        <label className=\"admin-btn-upload\">\n          {uploading ? 'Subiendo...' : '+ Subir archivo(s)'}\n          <input\n            type=\"file\"\n            accept={acceptTypes.join(',')}\n            onChange={handleUpload}\n            style={{ display: 'none' }}\n            disabled={uploading}\n            multiple\n          />\n        </label>\n      </div>\n\n      <div className=\"admin-media-url-inputs\">\n        <div className=\"admin-url-input-row\">\n          <input\n            type=\"text\"\n            id=\"url-input-image\"\n            placeholder=\"URL de imagen\"\n            onKeyDown={(e) => {\n              if (e.key === 'Enter') {\n                e.preventDefault();\n                addUrlMedia(e.target.value, 'image');\n                e.target.value = '';\n              }\n            }}\n          />\n          <button \n            type=\"button\" \n            onClick={(e) => {\n              const input = e.target.previousSibling;\n              addUrlMedia(input.value, 'image');\n              input.value = '';\n            }}\n            className=\"admin-btn-add-url\"\n          >\n            +\n          </button>\n        </div>\n        {allowedTypes.includes('video') && (\n          <div className=\"admin-url-input-row\">\n            <input\n              type=\"text\"\n              id=\"url-input-video\"\n              placeholder=\"URL de video (YouTube, Vimeo, etc.)\"\n              onKeyDown={(e) => {\n                if (e.key === 'Enter') {\n                  e.preventDefault();\n                  addUrlMedia(e.target.value, 'video');\n                  e.target.value = '';\n                }\n              }}\n            />\n            <button \n              type=\"button\" \n              onClick={(e) => {\n                const input = e.target.previousSibling;\n                addUrlMedia(input.value, 'video');\n                input.value = '';\n              }}\n              className=\"admin-btn-add-url\"\n            >\n              +\n            </button>\n          </div>\n        )}\n        {allowedTypes.includes('audio') && (\n          <div className=\"admin-url-input-row\">\n            <input\n              type=\"text\"\n              id=\"url-input-audio\"\n              placeholder=\"URL de audio\"\n              onKeyDown={(e) => {\n                if (e.key === 'Enter') {\n                  e.preventDefault();\n                  addUrlMedia(e.target.value, 'audio');\n                  e.target.value = '';\n                }\n              }}\n            />\n            <button \n              type=\"button\" \n              onClick={(e) => {\n                const input = e.target.previousSibling;\n                addUrlMedia(input.value, 'audio');\n                input.value = '';\n              }}\n              className=\"admin-btn-add-url\"\n            >\n              +\n            </button>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":7258,"size_tokens":null},"src/admin/components/TestimoniesEditor.js":{"content":"import React, { useState, useEffect } from 'react';\nimport { useAuth } from '../../context/AuthContext';\nimport ImageUploader from './ImageUploader';\nimport MultiMediaUploader from './MultiMediaUploader';\n\nexport default function TestimoniesEditor({ countryCode }) {\n  const { user, getAuthHeaders } = useAuth();\n  const [witnesses, setWitnesses] = useState([]);\n  const [selectedWitness, setSelectedWitness] = useState(null);\n  const [witnessDetail, setWitnessDetail] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [showWitnessModal, setShowWitnessModal] = useState(false);\n  const [showTestimonyModal, setShowTestimonyModal] = useState(false);\n  const [editingWitness, setEditingWitness] = useState(null);\n  const [editingTestimony, setEditingTestimony] = useState(null);\n  \n  const [witnessForm, setWitnessForm] = useState({\n    id: '',\n    name: '',\n    bio: '',\n    image: '',\n    social: { instagram: '', telegram: '', donation: '' }\n  });\n\n  const [testimonyForm, setTestimonyForm] = useState({\n    id: '',\n    title: '',\n    summary: '',\n    date: '',\n    paragraphs: [''],\n    media: []\n  });\n\n  useEffect(() => {\n    loadWitnesses();\n  }, [countryCode]);\n\n  async function loadWitnesses() {\n    try {\n      const res = await fetch(`/api/cms/countries/${countryCode}/testimonies?lang=es`, {\n        headers: getAuthHeaders()\n      });\n      if (res.ok) {\n        const data = await res.json();\n        setWitnesses(data.items || []);\n      }\n    } catch (error) {\n      console.error('Error loading witnesses:', error);\n    }\n    setLoading(false);\n  }\n\n  async function loadWitnessDetail(witnessId) {\n    try {\n      const res = await fetch(`/api/cms/countries/${countryCode}/testimonies/${witnessId}?lang=es`, {\n        headers: getAuthHeaders()\n      });\n      if (res.ok) {\n        const data = await res.json();\n        setWitnessDetail(data);\n        setSelectedWitness(witnessId);\n      }\n    } catch (error) {\n      console.error('Error loading witness detail:', error);\n    }\n  }\n\n  function openCreateWitnessModal() {\n    setEditingWitness(null);\n    setWitnessForm({\n      id: '',\n      name: '',\n      bio: '',\n      image: '',\n      social: { instagram: '', telegram: '', donation: '' }\n    });\n    setShowWitnessModal(true);\n  }\n\n  function openEditWitnessModal() {\n    if (!witnessDetail) return;\n    setEditingWitness(witnessDetail);\n    setWitnessForm({\n      id: witnessDetail.id,\n      name: witnessDetail.name || '',\n      bio: witnessDetail.bio || '',\n      image: witnessDetail.image || '',\n      social: witnessDetail.social || { instagram: '', telegram: '', donation: '' }\n    });\n    setShowWitnessModal(true);\n  }\n\n  function openCreateTestimonyModal() {\n    setEditingTestimony(null);\n    const nextId = `t${(witnessDetail?.testimonies?.length || 0) + 1}`;\n    setTestimonyForm({\n      id: nextId,\n      title: '',\n      summary: '',\n      date: '',\n      paragraphs: [''],\n      media: []\n    });\n    setShowTestimonyModal(true);\n  }\n\n  function openEditTestimonyModal(testimony) {\n    setEditingTestimony(testimony);\n    setTestimonyForm({\n      id: testimony.id,\n      title: testimony.title || '',\n      summary: testimony.summary || '',\n      date: testimony.date || '',\n      paragraphs: testimony.paragraphs || [''],\n      media: testimony.media || []\n    });\n    setShowTestimonyModal(true);\n  }\n\n  async function handleWitnessSubmit(e) {\n    e.preventDefault();\n    \n    const url = editingWitness\n      ? `/api/cms/countries/${countryCode}/testimonies/${editingWitness.id}?lang=es`\n      : `/api/cms/countries/${countryCode}/testimonies?lang=es`;\n    \n    const method = editingWitness ? 'PUT' : 'POST';\n\n    const body = {\n      ...witnessForm,\n      id: witnessForm.id || witnessForm.name.toLowerCase().replace(/[^a-z0-9]/g, '-').slice(0, 20)\n    };\n\n    try {\n      const res = await fetch(url, {\n        method,\n        headers: {\n          ...getAuthHeaders(),\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(body)\n      });\n\n      const data = await res.json();\n      \n      if (res.ok) {\n        setShowWitnessModal(false);\n        if (data.pending) {\n          alert('Cambio enviado para aprobaciÃ³n');\n        }\n        loadWitnesses();\n        if (editingWitness) {\n          loadWitnessDetail(editingWitness.id);\n        }\n      } else {\n        alert(data.error || 'Error al guardar');\n      }\n    } catch (error) {\n      console.error('Error saving:', error);\n    }\n  }\n\n  async function handleTestimonySubmit(e) {\n    e.preventDefault();\n    \n    const body = {\n      ...testimonyForm,\n      paragraphs: testimonyForm.paragraphs.filter(p => p.trim()),\n      media: testimonyForm.media || []\n    };\n\n    const isEdit = editingTestimony && editingTestimony.id;\n    const url = isEdit\n      ? `/api/cms/countries/${countryCode}/testimonies/${selectedWitness}/testimony/${editingTestimony.id}?lang=es`\n      : `/api/cms/countries/${countryCode}/testimonies/${selectedWitness}/testimony?lang=es`;\n\n    try {\n      const res = await fetch(url, {\n        method: isEdit ? 'PUT' : 'POST',\n        headers: {\n          ...getAuthHeaders(),\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(body)\n      });\n\n      const data = await res.json();\n      \n      if (res.ok) {\n        setShowTestimonyModal(false);\n        if (data.pending) {\n          alert('Cambio enviado para aprobaciÃ³n');\n        }\n        loadWitnessDetail(selectedWitness);\n      } else {\n        alert(data.error || 'Error al guardar');\n      }\n    } catch (error) {\n      console.error('Error saving:', error);\n    }\n  }\n\n  function addParagraph() {\n    setTestimonyForm({ ...testimonyForm, paragraphs: [...testimonyForm.paragraphs, ''] });\n  }\n\n  function updateParagraph(index, value) {\n    const newParagraphs = [...testimonyForm.paragraphs];\n    newParagraphs[index] = value;\n    setTestimonyForm({ ...testimonyForm, paragraphs: newParagraphs });\n  }\n\n  function removeParagraph(index) {\n    setTestimonyForm({ \n      ...testimonyForm, \n      paragraphs: testimonyForm.paragraphs.filter((_, i) => i !== index) \n    });\n  }\n\n  const canCreate = user.role === 'admin' || user.permissions?.canCreate;\n  const canEdit = user.role === 'admin' || user.permissions?.canEdit;\n\n  if (loading) {\n    return <div className=\"admin-loading\">Cargando testimonios...</div>;\n  }\n\n  return (\n    <div className=\"admin-editor\">\n      <div className=\"admin-editor-header\">\n        <h2>Testimonios</h2>\n        {canCreate && (\n          <button onClick={openCreateWitnessModal} className=\"admin-btn-primary\">\n            + Nuevo Testigo\n          </button>\n        )}\n      </div>\n\n      <div className=\"admin-testimonies-layout\">\n        <div className=\"admin-witnesses-list\">\n          <h3>Testigos ({witnesses.length})</h3>\n          {witnesses.map(witness => (\n            <div \n              key={witness.id} \n              className={`admin-witness-item ${selectedWitness === witness.id ? 'active' : ''}`}\n              onClick={() => loadWitnessDetail(witness.id)}\n            >\n              {witness.image && (\n                <img src={witness.image} alt={witness.name} className=\"admin-witness-thumb\" />\n              )}\n              <span>{witness.name}</span>\n            </div>\n          ))}\n          {witnesses.length === 0 && (\n            <div className=\"admin-empty-small\">No hay testigos</div>\n          )}\n        </div>\n\n        <div className=\"admin-witness-detail\">\n          {witnessDetail ? (\n            <>\n              <div className=\"admin-witness-header\">\n                <div className=\"admin-witness-info\">\n                  {witnessDetail.image && (\n                    <img src={witnessDetail.image} alt={witnessDetail.name} className=\"admin-witness-avatar\" />\n                  )}\n                  <div>\n                    <h3>{witnessDetail.name}</h3>\n                    <p className=\"admin-witness-bio\">{witnessDetail.bio}</p>\n                  </div>\n                </div>\n                {canEdit && (\n                  <button onClick={openEditWitnessModal} className=\"admin-btn-secondary\">\n                    Editar Testigo\n                  </button>\n                )}\n              </div>\n\n              <div className=\"admin-testimonies-section\">\n                <div className=\"admin-section-header\">\n                  <h4>Testimonios ({witnessDetail.testimonies?.length || 0})</h4>\n                  {canCreate && (\n                    <button onClick={openCreateTestimonyModal} className=\"admin-btn-primary small\">\n                      + AÃ±adir Testimonio\n                    </button>\n                  )}\n                </div>\n\n                <div className=\"admin-testimonies-list\">\n                  {witnessDetail.testimonies?.map(t => (\n                    <div key={t.id} className=\"admin-testimony-card\" onClick={() => canEdit && openEditTestimonyModal(t)}>\n                      <h5>{t.title}</h5>\n                      <p>{t.summary}</p>\n                      <span className=\"admin-testimony-date\">{t.date}</span>\n                      {t.media && t.media.length > 0 && (\n                        <span className=\"admin-testimony-media-count\">\n                          {t.media.length} archivo(s) multimedia\n                        </span>\n                      )}\n                    </div>\n                  ))}\n                  {(!witnessDetail.testimonies || witnessDetail.testimonies.length === 0) && (\n                    <div className=\"admin-empty-small\">No hay testimonios</div>\n                  )}\n                </div>\n              </div>\n            </>\n          ) : (\n            <div className=\"admin-empty\">\n              <p>Selecciona un testigo para ver sus detalles</p>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {showWitnessModal && (\n        <div className=\"admin-modal-overlay\">\n          <div className=\"admin-modal large\">\n            <h3>{editingWitness ? 'Editar Testigo' : 'Nuevo Testigo'}</h3>\n            <form onSubmit={handleWitnessSubmit}>\n              <div className=\"admin-form-group\">\n                <label>Nombre</label>\n                <input\n                  type=\"text\"\n                  value={witnessForm.name}\n                  onChange={(e) => setWitnessForm({ ...witnessForm, name: e.target.value })}\n                  required\n                />\n              </div>\n\n              <div className=\"admin-form-group\">\n                <label>BiografÃ­a</label>\n                <textarea\n                  value={witnessForm.bio}\n                  onChange={(e) => setWitnessForm({ ...witnessForm, bio: e.target.value })}\n                  rows={3}\n                />\n              </div>\n\n              <div className=\"admin-form-group\">\n                <label>Foto</label>\n                <ImageUploader\n                  value={witnessForm.image}\n                  onChange={(url) => setWitnessForm({ ...witnessForm, image: url })}\n                />\n              </div>\n\n              <div className=\"admin-form-group\">\n                <label>Redes Sociales</label>\n                <div className=\"admin-social-inputs\">\n                  <input\n                    type=\"text\"\n                    placeholder=\"Instagram URL\"\n                    value={witnessForm.social.instagram}\n                    onChange={(e) => setWitnessForm({ \n                      ...witnessForm, \n                      social: { ...witnessForm.social, instagram: e.target.value }\n                    })}\n                  />\n                  <input\n                    type=\"text\"\n                    placeholder=\"Telegram URL\"\n                    value={witnessForm.social.telegram}\n                    onChange={(e) => setWitnessForm({ \n                      ...witnessForm, \n                      social: { ...witnessForm.social, telegram: e.target.value }\n                    })}\n                  />\n                  <input\n                    type=\"text\"\n                    placeholder=\"DonaciÃ³n URL\"\n                    value={witnessForm.social.donation}\n                    onChange={(e) => setWitnessForm({ \n                      ...witnessForm, \n                      social: { ...witnessForm.social, donation: e.target.value }\n                    })}\n                  />\n                </div>\n              </div>\n\n              <div className=\"admin-modal-actions\">\n                <button type=\"button\" onClick={() => setShowWitnessModal(false)} className=\"admin-btn-secondary\">\n                  Cancelar\n                </button>\n                <button type=\"submit\" className=\"admin-btn-primary\">\n                  {editingWitness ? 'Guardar Cambios' : 'Crear Testigo'}\n                </button>\n              </div>\n            </form>\n          </div>\n        </div>\n      )}\n\n      {showTestimonyModal && (\n        <div className=\"admin-modal-overlay\">\n          <div className=\"admin-modal large\">\n            <h3>{editingTestimony ? 'Editar Testimonio' : 'Nuevo Testimonio'}</h3>\n            <form onSubmit={handleTestimonySubmit}>\n              <div className=\"admin-form-group\">\n                <label>TÃ­tulo</label>\n                <input\n                  type=\"text\"\n                  value={testimonyForm.title}\n                  onChange={(e) => setTestimonyForm({ ...testimonyForm, title: e.target.value })}\n                  required\n                />\n              </div>\n\n              <div className=\"admin-form-row\">\n                <div className=\"admin-form-group\">\n                  <label>Resumen</label>\n                  <input\n                    type=\"text\"\n                    value={testimonyForm.summary}\n                    onChange={(e) => setTestimonyForm({ ...testimonyForm, summary: e.target.value })}\n                  />\n                </div>\n                <div className=\"admin-form-group\">\n                  <label>Fecha/Contexto</label>\n                  <input\n                    type=\"text\"\n                    value={testimonyForm.date}\n                    onChange={(e) => setTestimonyForm({ ...testimonyForm, date: e.target.value })}\n                  />\n                </div>\n              </div>\n\n              <div className=\"admin-form-group\">\n                <label>Archivos Multimedia (fotos, videos, audio)</label>\n                <MultiMediaUploader\n                  value={testimonyForm.media}\n                  onChange={(media) => setTestimonyForm({ ...testimonyForm, media })}\n                  allowedTypes={['image', 'video', 'audio']}\n                />\n              </div>\n\n              <div className=\"admin-form-group\">\n                <label>Contenido (pÃ¡rrafos)</label>\n                {testimonyForm.paragraphs.map((p, i) => (\n                  <div key={i} className=\"admin-array-item\">\n                    <textarea\n                      value={p}\n                      onChange={(e) => updateParagraph(i, e.target.value)}\n                      rows={3}\n                      placeholder={`PÃ¡rrafo ${i + 1}`}\n                    />\n                    <button type=\"button\" onClick={() => removeParagraph(i)} className=\"admin-btn-remove\">\n                      Ã—\n                    </button>\n                  </div>\n                ))}\n                <button type=\"button\" onClick={addParagraph} className=\"admin-btn-add\">\n                  + AÃ±adir pÃ¡rrafo\n                </button>\n              </div>\n\n              <div className=\"admin-modal-actions\">\n                <button type=\"button\" onClick={() => setShowTestimonyModal(false)} className=\"admin-btn-secondary\">\n                  Cancelar\n                </button>\n                <button type=\"submit\" className=\"admin-btn-primary\">\n                  {editingTestimony ? 'Guardar Cambios' : 'Crear Testimonio'}\n                </button>\n              </div>\n            </form>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":15941,"size_tokens":null},"src/admin/components/VelumEditor.js":{"content":"import React, { useState, useEffect } from 'react';\nimport { useAuth } from '../../context/AuthContext';\nimport ImageUploader from './ImageUploader';\n\nexport default function VelumEditor({ countryCode }) {\n  const { user, getAuthHeaders } = useAuth();\n  const [articles, setArticles] = useState([]);\n  const [selectedArticle, setSelectedArticle] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [showModal, setShowModal] = useState(false);\n  const [editingArticle, setEditingArticle] = useState(null);\n\n  const [formData, setFormData] = useState({\n    id: '',\n    title: '',\n    author: '',\n    authorImage: '',\n    date: '',\n    abstract: '',\n    keywords: [],\n    sections: [],\n    bibliography: []\n  });\n\n  const [newKeyword, setNewKeyword] = useState('');\n\n  useEffect(() => {\n    loadArticles();\n  }, [countryCode]);\n\n  async function loadArticles() {\n    try {\n      const res = await fetch(`/api/cms/velum?lang=es`, {\n        headers: getAuthHeaders()\n      });\n      if (res.ok) {\n        const data = await res.json();\n        setArticles(data.items || []);\n      }\n    } catch (error) {\n      console.error('Error loading VELUM articles:', error);\n    }\n    setLoading(false);\n  }\n\n  function openCreateModal() {\n    setEditingArticle(null);\n    setFormData({\n      id: '',\n      title: '',\n      author: '',\n      authorImage: '',\n      date: new Date().toISOString().split('T')[0],\n      abstract: '',\n      keywords: [],\n      sections: [{ title: '', content: '' }],\n      bibliography: ['']\n    });\n    setShowModal(true);\n  }\n\n  function openEditModal(article) {\n    setEditingArticle(article);\n    setFormData({\n      id: article.id,\n      title: article.title || '',\n      author: article.author || '',\n      authorImage: article.authorImage || '',\n      date: article.date || '',\n      abstract: article.abstract || '',\n      keywords: article.keywords || [],\n      sections: article.sections?.length ? article.sections : [{ title: '', content: '' }],\n      bibliography: article.bibliography?.length ? article.bibliography : ['']\n    });\n    setShowModal(true);\n  }\n\n  async function handleSubmit(e) {\n    e.preventDefault();\n    \n    const body = {\n      ...formData,\n      id: formData.id || formData.title.toLowerCase().replace(/[^a-z0-9]/g, '-').slice(0, 30),\n      sections: formData.sections.filter(s => s.title.trim() || s.content.trim()),\n      bibliography: formData.bibliography.filter(b => b.trim())\n    };\n\n    const url = editingArticle\n      ? `/api/cms/velum/${editingArticle.id}?lang=es`\n      : `/api/cms/velum?lang=es`;\n\n    const method = editingArticle ? 'PUT' : 'POST';\n\n    try {\n      const res = await fetch(url, {\n        method,\n        headers: {\n          ...getAuthHeaders(),\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(body)\n      });\n\n      const data = await res.json();\n      \n      if (res.ok) {\n        setShowModal(false);\n        if (data.pending) {\n          alert('Cambio enviado para aprobaciÃ³n');\n        }\n        loadArticles();\n      } else {\n        alert(data.error || 'Error al guardar');\n      }\n    } catch (error) {\n      console.error('Error saving:', error);\n    }\n  }\n\n  async function handleDelete(article) {\n    if (!window.confirm(`Â¿Eliminar \"${article.title}\"?`)) return;\n\n    try {\n      const res = await fetch(`/api/cms/velum/${article.id}?lang=es`, {\n        method: 'DELETE',\n        headers: getAuthHeaders()\n      });\n\n      if (res.ok) {\n        loadArticles();\n      }\n    } catch (error) {\n      console.error('Error deleting:', error);\n    }\n  }\n\n  function addKeyword() {\n    if (newKeyword.trim() && !formData.keywords.includes(newKeyword.trim())) {\n      setFormData({ ...formData, keywords: [...formData.keywords, newKeyword.trim()] });\n      setNewKeyword('');\n    }\n  }\n\n  function removeKeyword(keyword) {\n    setFormData({ ...formData, keywords: formData.keywords.filter(k => k !== keyword) });\n  }\n\n  function addSection() {\n    setFormData({ ...formData, sections: [...formData.sections, { title: '', content: '' }] });\n  }\n\n  function updateSection(index, field, value) {\n    const newSections = [...formData.sections];\n    newSections[index][field] = value;\n    setFormData({ ...formData, sections: newSections });\n  }\n\n  function removeSection(index) {\n    setFormData({ ...formData, sections: formData.sections.filter((_, i) => i !== index) });\n  }\n\n  function addBibliography() {\n    setFormData({ ...formData, bibliography: [...formData.bibliography, ''] });\n  }\n\n  function updateBibliography(index, value) {\n    const newBib = [...formData.bibliography];\n    newBib[index] = value;\n    setFormData({ ...formData, bibliography: newBib });\n  }\n\n  function removeBibliography(index) {\n    setFormData({ ...formData, bibliography: formData.bibliography.filter((_, i) => i !== index) });\n  }\n\n  const canCreate = user.role === 'admin' || user.permissions?.canCreate;\n  const canEdit = user.role === 'admin' || user.permissions?.canEdit;\n\n  if (loading) {\n    return <div className=\"admin-loading\">Cargando artÃ­culos VELUM...</div>;\n  }\n\n  return (\n    <div className=\"admin-editor\">\n      <div className=\"admin-editor-header\">\n        <h2>VELUM - Micro-tesis e Investigaciones</h2>\n        {canCreate && (\n          <button onClick={openCreateModal} className=\"admin-btn-primary\">\n            + Nuevo ArtÃ­culo\n          </button>\n        )}\n      </div>\n\n      <div className=\"admin-velum-list\">\n        {articles.map(article => (\n          <div key={article.id} className=\"admin-velum-card\">\n            <div className=\"admin-velum-card-content\">\n              <div className=\"admin-velum-meta\">\n                <span className=\"admin-velum-date\">{article.date}</span>\n                <span className=\"admin-velum-author\">{article.author}</span>\n              </div>\n              <h3 className=\"admin-velum-title\">{article.title}</h3>\n              {article.abstract && (\n                <p className=\"admin-velum-abstract\">{article.abstract.substring(0, 200)}...</p>\n              )}\n              {article.keywords && article.keywords.length > 0 && (\n                <div className=\"admin-velum-keywords\">\n                  {article.keywords.slice(0, 4).map((kw, i) => (\n                    <span key={i} className=\"admin-velum-keyword\">{kw}</span>\n                  ))}\n                </div>\n              )}\n            </div>\n            {canEdit && (\n              <div className=\"admin-velum-actions\">\n                <button onClick={() => openEditModal(article)} className=\"admin-btn-secondary small\">\n                  Editar\n                </button>\n                <button onClick={() => handleDelete(article)} className=\"admin-btn-danger small\">\n                  Eliminar\n                </button>\n              </div>\n            )}\n          </div>\n        ))}\n        {articles.length === 0 && (\n          <div className=\"admin-empty\">\n            <p>No hay artÃ­culos en VELUM</p>\n            {canCreate && (\n              <button onClick={openCreateModal} className=\"admin-btn-primary\">\n                Crear primer artÃ­culo\n              </button>\n            )}\n          </div>\n        )}\n      </div>\n\n      {showModal && (\n        <div className=\"admin-modal-overlay\">\n          <div className=\"admin-modal large\">\n            <h3>{editingArticle ? 'Editar ArtÃ­culo' : 'Nuevo ArtÃ­culo VELUM'}</h3>\n            <form onSubmit={handleSubmit}>\n              <div className=\"admin-form-group\">\n                <label>TÃ­tulo *</label>\n                <input\n                  type=\"text\"\n                  value={formData.title}\n                  onChange={(e) => setFormData({ ...formData, title: e.target.value })}\n                  required\n                  placeholder=\"TÃ­tulo del artÃ­culo\"\n                />\n              </div>\n\n              <div className=\"admin-form-row\">\n                <div className=\"admin-form-group\">\n                  <label>Autor</label>\n                  <input\n                    type=\"text\"\n                    value={formData.author}\n                    onChange={(e) => setFormData({ ...formData, author: e.target.value })}\n                    placeholder=\"Nombre del autor\"\n                  />\n                </div>\n                <div className=\"admin-form-group\">\n                  <label>Fecha</label>\n                  <input\n                    type=\"date\"\n                    value={formData.date}\n                    onChange={(e) => setFormData({ ...formData, date: e.target.value })}\n                  />\n                </div>\n              </div>\n\n              <div className=\"admin-form-group\">\n                <label>Imagen del autor</label>\n                <ImageUploader\n                  value={formData.authorImage}\n                  onChange={(url) => setFormData({ ...formData, authorImage: url })}\n                />\n              </div>\n\n              <div className=\"admin-form-group\">\n                <label>Resumen (Abstract)</label>\n                <textarea\n                  value={formData.abstract}\n                  onChange={(e) => setFormData({ ...formData, abstract: e.target.value })}\n                  rows={4}\n                  placeholder=\"Resumen del artÃ­culo...\"\n                />\n              </div>\n\n              <div className=\"admin-form-group\">\n                <label>Palabras clave</label>\n                <div className=\"admin-keywords-input\">\n                  <input\n                    type=\"text\"\n                    value={newKeyword}\n                    onChange={(e) => setNewKeyword(e.target.value)}\n                    onKeyPress={(e) => e.key === 'Enter' && (e.preventDefault(), addKeyword())}\n                    placeholder=\"AÃ±adir palabra clave\"\n                  />\n                  <button type=\"button\" onClick={addKeyword} className=\"admin-btn-add-keyword\">+</button>\n                </div>\n                <div className=\"admin-keywords-list\">\n                  {formData.keywords.map((kw, i) => (\n                    <span key={i} className=\"admin-keyword-tag\">\n                      {kw}\n                      <button type=\"button\" onClick={() => removeKeyword(kw)}>Ã—</button>\n                    </span>\n                  ))}\n                </div>\n              </div>\n\n              <div className=\"admin-form-group\">\n                <label>Secciones del artÃ­culo</label>\n                {formData.sections.map((section, i) => (\n                  <div key={i} className=\"admin-section-item\">\n                    <div className=\"admin-section-header\">\n                      <input\n                        type=\"text\"\n                        value={section.title}\n                        onChange={(e) => updateSection(i, 'title', e.target.value)}\n                        placeholder={`TÃ­tulo de la secciÃ³n ${i + 1}`}\n                      />\n                      <button type=\"button\" onClick={() => removeSection(i)} className=\"admin-btn-remove\">Ã—</button>\n                    </div>\n                    <textarea\n                      value={section.content}\n                      onChange={(e) => updateSection(i, 'content', e.target.value)}\n                      rows={4}\n                      placeholder=\"Contenido de la secciÃ³n...\"\n                    />\n                  </div>\n                ))}\n                <button type=\"button\" onClick={addSection} className=\"admin-btn-add\">\n                  + AÃ±adir secciÃ³n\n                </button>\n              </div>\n\n              <div className=\"admin-form-group\">\n                <label>BibliografÃ­a</label>\n                {formData.bibliography.map((bib, i) => (\n                  <div key={i} className=\"admin-array-item\">\n                    <input\n                      type=\"text\"\n                      value={bib}\n                      onChange={(e) => updateBibliography(i, e.target.value)}\n                      placeholder=\"Referencia bibliogrÃ¡fica...\"\n                    />\n                    <button type=\"button\" onClick={() => removeBibliography(i)} className=\"admin-btn-remove\">Ã—</button>\n                  </div>\n                ))}\n                <button type=\"button\" onClick={addBibliography} className=\"admin-btn-add\">\n                  + AÃ±adir referencia\n                </button>\n              </div>\n\n              <div className=\"admin-modal-actions\">\n                <button type=\"button\" onClick={() => setShowModal(false)} className=\"admin-btn-secondary\">\n                  Cancelar\n                </button>\n                <button type=\"submit\" className=\"admin-btn-primary\">\n                  {editingArticle ? 'Guardar Cambios' : 'Crear ArtÃ­culo'}\n                </button>\n              </div>\n            </form>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":12804,"size_tokens":null},"src/admin/AdminLogin.js":{"content":"import React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuth } from '../context/AuthContext';\nimport './admin.css';\n\nexport default function AdminLogin() {\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [error, setError] = useState('');\n  const [loading, setLoading] = useState(false);\n  const { login } = useAuth();\n  const navigate = useNavigate();\n\n  async function handleSubmit(e) {\n    e.preventDefault();\n    setError('');\n    setLoading(true);\n\n    try {\n      await login(username, password);\n      navigate('/admin');\n    } catch (err) {\n      setError(err.message);\n    }\n    setLoading(false);\n  }\n\n  return (\n    <div className=\"admin-login-container\">\n      <div className=\"admin-login-box\">\n        <div className=\"admin-login-header\">\n          <h1>Wiki<span>Conflicts</span></h1>\n          <p>Panel de AdministraciÃ³n</p>\n        </div>\n        \n        <form onSubmit={handleSubmit} className=\"admin-login-form\">\n          {error && <div className=\"admin-error\">{error}</div>}\n          \n          <div className=\"admin-form-group\">\n            <label htmlFor=\"username\">Usuario</label>\n            <input\n              type=\"text\"\n              id=\"username\"\n              value={username}\n              onChange={(e) => setUsername(e.target.value)}\n              required\n              autoComplete=\"username\"\n            />\n          </div>\n          \n          <div className=\"admin-form-group\">\n            <label htmlFor=\"password\">ContraseÃ±a</label>\n            <input\n              type=\"password\"\n              id=\"password\"\n              value={password}\n              onChange={(e) => setPassword(e.target.value)}\n              required\n              autoComplete=\"current-password\"\n            />\n          </div>\n          \n          <button type=\"submit\" className=\"admin-btn-primary\" disabled={loading}>\n            {loading ? 'Iniciando...' : 'Iniciar SesiÃ³n'}\n          </button>\n        </form>\n        \n        <div className=\"admin-login-footer\">\n          <a href=\"/\">â† Volver al sitio</a>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":2180,"size_tokens":null},"src/admin/AdminUsers.js":{"content":"import React, { useState, useEffect } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { useAuth } from '../context/AuthContext';\nimport './admin.css';\n\nexport default function AdminUsers() {\n  const { user, getAuthHeaders } = useAuth();\n  const navigate = useNavigate();\n  const [users, setUsers] = useState([]);\n  const [countries, setCountries] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [showModal, setShowModal] = useState(false);\n  const [editingUser, setEditingUser] = useState(null);\n  const [formData, setFormData] = useState({\n    username: '',\n    password: '',\n    name: '',\n    role: 'editor',\n    countries: [],\n    permissions: {\n      canCreate: true,\n      canEdit: false,\n      canDelete: false,\n      requiresApproval: true\n    }\n  });\n\n  useEffect(() => {\n    if (user.role !== 'admin') {\n      navigate('/admin');\n      return;\n    }\n    loadData();\n  }, []);\n\n  async function loadData() {\n    try {\n      const [usersRes, countriesRes] = await Promise.all([\n        fetch('/api/auth/users', { headers: getAuthHeaders() }),\n        fetch('/api/cms/countries?lang=es', { headers: getAuthHeaders() })\n      ]);\n\n      if (usersRes.ok) {\n        const data = await usersRes.json();\n        setUsers(data.users);\n      }\n\n      if (countriesRes.ok) {\n        const data = await countriesRes.json();\n        setCountries(data.countries);\n      }\n    } catch (error) {\n      console.error('Error loading data:', error);\n    }\n    setLoading(false);\n  }\n\n  function openCreateModal() {\n    setEditingUser(null);\n    setFormData({\n      username: '',\n      password: '',\n      name: '',\n      role: 'editor',\n      countries: [],\n      permissions: {\n        canCreate: true,\n        canEdit: false,\n        canDelete: false,\n        requiresApproval: true\n      }\n    });\n    setShowModal(true);\n  }\n\n  function openEditModal(u) {\n    setEditingUser(u);\n    setFormData({\n      username: u.username,\n      password: '',\n      name: u.name,\n      role: u.role,\n      countries: u.countries || [],\n      permissions: u.permissions || {\n        canCreate: true,\n        canEdit: false,\n        canDelete: false,\n        requiresApproval: true\n      }\n    });\n    setShowModal(true);\n  }\n\n  async function handleSubmit(e) {\n    e.preventDefault();\n    \n    const url = editingUser \n      ? `/api/auth/users/${editingUser.id}`\n      : '/api/auth/users';\n    \n    const method = editingUser ? 'PUT' : 'POST';\n    \n    const body = { ...formData };\n    if (editingUser && !body.password) {\n      delete body.password;\n    }\n\n    try {\n      const res = await fetch(url, {\n        method,\n        headers: {\n          ...getAuthHeaders(),\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(body)\n      });\n\n      if (res.ok) {\n        setShowModal(false);\n        loadData();\n      } else {\n        const data = await res.json();\n        alert(data.error || 'Error al guardar');\n      }\n    } catch (error) {\n      console.error('Error saving user:', error);\n    }\n  }\n\n  async function handleDelete(u) {\n    if (!window.confirm(`Â¿Eliminar al usuario \"${u.name}\"?`)) return;\n\n    try {\n      const res = await fetch(`/api/auth/users/${u.id}`, {\n        method: 'DELETE',\n        headers: getAuthHeaders()\n      });\n\n      if (res.ok) {\n        loadData();\n      } else {\n        const data = await res.json();\n        alert(data.error || 'Error al eliminar');\n      }\n    } catch (error) {\n      console.error('Error deleting user:', error);\n    }\n  }\n\n  function toggleCountry(code) {\n    const current = formData.countries || [];\n    if (current.includes(code)) {\n      setFormData({ ...formData, countries: current.filter(c => c !== code) });\n    } else {\n      setFormData({ ...formData, countries: [...current, code] });\n    }\n  }\n\n  function toggleAllCountries() {\n    if (formData.countries.includes('all')) {\n      setFormData({ ...formData, countries: [] });\n    } else {\n      setFormData({ ...formData, countries: ['all'] });\n    }\n  }\n\n  if (loading) {\n    return <div className=\"admin-loading\">Cargando...</div>;\n  }\n\n  return (\n    <div className=\"admin-container\">\n      <header className=\"admin-header\">\n        <div className=\"admin-header-left\">\n          <Link to=\"/admin\" className=\"admin-back-link\">â† Volver</Link>\n          <h1>GestiÃ³n de Usuarios</h1>\n        </div>\n      </header>\n\n      <main className=\"admin-main\">\n        <div className=\"admin-section\">\n          <div className=\"admin-section-header\">\n            <h2>Usuarios ({users.length})</h2>\n            <button onClick={openCreateModal} className=\"admin-btn-primary\">\n              + Nuevo Usuario\n            </button>\n          </div>\n\n          <div className=\"admin-table-container\">\n            <table className=\"admin-table\">\n              <thead>\n                <tr>\n                  <th>Nombre</th>\n                  <th>Usuario</th>\n                  <th>Rol</th>\n                  <th>PaÃ­ses</th>\n                  <th>Permisos</th>\n                  <th>Acciones</th>\n                </tr>\n              </thead>\n              <tbody>\n                {users.map(u => (\n                  <tr key={u.id}>\n                    <td>{u.name}</td>\n                    <td>{u.username}</td>\n                    <td>\n                      <span className={`admin-role-badge ${u.role}`}>\n                        {u.role === 'admin' ? 'Admin' : 'Editor'}\n                      </span>\n                    </td>\n                    <td>\n                      {u.countries?.includes('all') \n                        ? 'Todos' \n                        : u.countries?.length || 0}\n                    </td>\n                    <td>\n                      <div className=\"admin-permissions-badges\">\n                        {u.permissions?.canCreate && <span className=\"perm-badge create\">Crear</span>}\n                        {u.permissions?.canEdit && <span className=\"perm-badge edit\">Editar</span>}\n                        {u.permissions?.canDelete && <span className=\"perm-badge delete\">Eliminar</span>}\n                        {u.permissions?.requiresApproval && <span className=\"perm-badge approval\">Requiere AprobaciÃ³n</span>}\n                      </div>\n                    </td>\n                    <td>\n                      <button onClick={() => openEditModal(u)} className=\"admin-btn-icon\" title=\"Editar\">\n                        âœï¸\n                      </button>\n                      {u.username !== 'admin' && (\n                        <button onClick={() => handleDelete(u)} className=\"admin-btn-icon delete\" title=\"Eliminar\">\n                          ðŸ—‘ï¸\n                        </button>\n                      )}\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </main>\n\n      {showModal && (\n        <div className=\"admin-modal-overlay\">\n          <div className=\"admin-modal large\">\n            <h3>{editingUser ? 'Editar Usuario' : 'Nuevo Usuario'}</h3>\n            <form onSubmit={handleSubmit}>\n              <div className=\"admin-form-row\">\n                <div className=\"admin-form-group\">\n                  <label>Nombre Completo</label>\n                  <input\n                    type=\"text\"\n                    value={formData.name}\n                    onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                    required\n                  />\n                </div>\n                <div className=\"admin-form-group\">\n                  <label>Usuario</label>\n                  <input\n                    type=\"text\"\n                    value={formData.username}\n                    onChange={(e) => setFormData({ ...formData, username: e.target.value })}\n                    required\n                    disabled={editingUser}\n                  />\n                </div>\n              </div>\n\n              <div className=\"admin-form-row\">\n                <div className=\"admin-form-group\">\n                  <label>{editingUser ? 'Nueva ContraseÃ±a (dejar vacÃ­o para mantener)' : 'ContraseÃ±a'}</label>\n                  <input\n                    type=\"password\"\n                    value={formData.password}\n                    onChange={(e) => setFormData({ ...formData, password: e.target.value })}\n                    required={!editingUser}\n                  />\n                </div>\n                <div className=\"admin-form-group\">\n                  <label>Rol</label>\n                  <select\n                    value={formData.role}\n                    onChange={(e) => setFormData({ ...formData, role: e.target.value })}\n                  >\n                    <option value=\"editor\">Editor</option>\n                    <option value=\"admin\">Administrador</option>\n                  </select>\n                </div>\n              </div>\n\n              <div className=\"admin-form-group\">\n                <label>PaÃ­ses con Acceso</label>\n                <div className=\"admin-countries-checkboxes\">\n                  <label className=\"admin-checkbox\">\n                    <input\n                      type=\"checkbox\"\n                      checked={formData.countries.includes('all')}\n                      onChange={toggleAllCountries}\n                    />\n                    <span>Todos los paÃ­ses</span>\n                  </label>\n                  {!formData.countries.includes('all') && countries.map(c => (\n                    <label key={c.code} className=\"admin-checkbox\">\n                      <input\n                        type=\"checkbox\"\n                        checked={formData.countries.includes(c.code)}\n                        onChange={() => toggleCountry(c.code)}\n                      />\n                      <span>{c.name}</span>\n                    </label>\n                  ))}\n                </div>\n              </div>\n\n              <div className=\"admin-form-group\">\n                <label>Permisos</label>\n                <div className=\"admin-permissions-checkboxes\">\n                  <label className=\"admin-checkbox\">\n                    <input\n                      type=\"checkbox\"\n                      checked={formData.permissions.canCreate}\n                      onChange={(e) => setFormData({\n                        ...formData,\n                        permissions: { ...formData.permissions, canCreate: e.target.checked }\n                      })}\n                    />\n                    <span>Puede crear contenido</span>\n                  </label>\n                  <label className=\"admin-checkbox\">\n                    <input\n                      type=\"checkbox\"\n                      checked={formData.permissions.canEdit}\n                      onChange={(e) => setFormData({\n                        ...formData,\n                        permissions: { ...formData.permissions, canEdit: e.target.checked }\n                      })}\n                    />\n                    <span>Puede editar contenido</span>\n                  </label>\n                  <label className=\"admin-checkbox\">\n                    <input\n                      type=\"checkbox\"\n                      checked={formData.permissions.canDelete}\n                      onChange={(e) => setFormData({\n                        ...formData,\n                        permissions: { ...formData.permissions, canDelete: e.target.checked }\n                      })}\n                    />\n                    <span>Puede eliminar contenido</span>\n                  </label>\n                  <label className=\"admin-checkbox\">\n                    <input\n                      type=\"checkbox\"\n                      checked={formData.permissions.requiresApproval}\n                      onChange={(e) => setFormData({\n                        ...formData,\n                        permissions: { ...formData.permissions, requiresApproval: e.target.checked }\n                      })}\n                    />\n                    <span>Sus cambios requieren aprobaciÃ³n</span>\n                  </label>\n                </div>\n              </div>\n\n              <div className=\"admin-modal-actions\">\n                <button type=\"button\" onClick={() => setShowModal(false)} className=\"admin-btn-secondary\">\n                  Cancelar\n                </button>\n                <button type=\"submit\" className=\"admin-btn-primary\">\n                  {editingUser ? 'Guardar Cambios' : 'Crear Usuario'}\n                </button>\n              </div>\n            </form>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":12610,"size_tokens":null},"server/middleware/auth.js":{"content":"const jwt = require('jsonwebtoken');\nconst crypto = require('crypto');\nconst fs = require('fs');\nconst path = require('path');\n\nconst secretFile = path.join(__dirname, '../data/jwt-secret.key');\nfunction getJWTSecret() {\n  if (process.env.JWT_SECRET) {\n    return process.env.JWT_SECRET;\n  }\n  \n  if (fs.existsSync(secretFile)) {\n    return fs.readFileSync(secretFile, 'utf8').trim();\n  }\n  \n  const secret = crypto.randomBytes(64).toString('hex');\n  const dir = path.dirname(secretFile);\n  if (!fs.existsSync(dir)) {\n    fs.mkdirSync(dir, { recursive: true });\n  }\n  fs.writeFileSync(secretFile, secret, { mode: 0o600 });\n  return secret;\n}\n\nconst JWT_SECRET = getJWTSecret();\n\nfunction authenticateToken(req, res, next) {\n  const token = req.cookies.token || req.headers.authorization?.split(' ')[1];\n  \n  if (!token) {\n    return res.status(401).json({ error: 'No autorizado' });\n  }\n\n  try {\n    const decoded = jwt.verify(token, JWT_SECRET);\n    req.user = decoded;\n    next();\n  } catch (error) {\n    return res.status(403).json({ error: 'Token invÃ¡lido' });\n  }\n}\n\nfunction requireAdmin(req, res, next) {\n  if (req.user.role !== 'admin') {\n    return res.status(403).json({ error: 'Se requieren permisos de administrador' });\n  }\n  next();\n}\n\nfunction checkCountryPermission(req, res, next) {\n  const { countryCode } = req.params;\n  const user = req.user;\n\n  if (user.role === 'admin' || user.countries.includes('all') || user.countries.includes(countryCode)) {\n    next();\n  } else {\n    return res.status(403).json({ error: 'No tienes permiso para este paÃ­s' });\n  }\n}\n\nfunction checkPermission(action) {\n  return (req, res, next) => {\n    const user = req.user;\n    \n    if (user.role === 'admin') {\n      return next();\n    }\n\n    const permissions = user.permissions || {};\n    \n    switch(action) {\n      case 'create':\n        if (!permissions.canCreate) {\n          return res.status(403).json({ error: 'No tienes permiso para crear contenido' });\n        }\n        break;\n      case 'edit':\n        if (!permissions.canEdit) {\n          return res.status(403).json({ error: 'No tienes permiso para editar contenido' });\n        }\n        break;\n      case 'delete':\n        if (!permissions.canDelete) {\n          return res.status(403).json({ error: 'No tienes permiso para eliminar contenido' });\n        }\n        break;\n    }\n    \n    if (permissions.requiresApproval && action !== 'read') {\n      req.requiresApproval = true;\n    }\n    \n    next();\n  };\n}\n\nmodule.exports = {\n  authenticateToken,\n  requireAdmin,\n  checkCountryPermission,\n  checkPermission,\n  JWT_SECRET\n};\n","path":null,"size_bytes":2597,"size_tokens":null},"src/admin/components/MediaEditor.js":{"content":"import React, { useState, useEffect } from 'react';\nimport { useAuth } from '../../context/AuthContext';\n\nexport default function MediaEditor({ countryCode }) {\n  const { getAuthHeaders } = useAuth();\n  const [images, setImages] = useState([]);\n  const [videos, setVideos] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [uploading, setUploading] = useState(false);\n\n  useEffect(() => {\n    loadMedia();\n  }, []);\n\n  async function loadMedia() {\n    try {\n      const res = await fetch('/api/upload/list', { headers: getAuthHeaders() });\n      if (res.ok) {\n        const data = await res.json();\n        setImages(data.images || []);\n        setVideos(data.videos || []);\n      }\n    } catch (error) {\n      console.error('Error loading media:', error);\n    }\n    setLoading(false);\n  }\n\n  async function handleUpload(e) {\n    const files = e.target.files;\n    if (!files || files.length === 0) return;\n\n    setUploading(true);\n    const formData = new FormData();\n\n    for (let i = 0; i < files.length; i++) {\n      formData.append('images', files[i]);\n    }\n\n    try {\n      const res = await fetch('/api/upload/images', {\n        method: 'POST',\n        headers: getAuthHeaders(),\n        body: formData\n      });\n\n      if (res.ok) {\n        loadMedia();\n      } else {\n        alert('Error al subir archivos');\n      }\n    } catch (error) {\n      console.error('Error uploading:', error);\n    }\n    setUploading(false);\n    e.target.value = '';\n  }\n\n  async function handleDelete(filename) {\n    if (!window.confirm('Â¿Eliminar este archivo?')) return;\n\n    try {\n      const res = await fetch(`/api/upload/${filename}`, {\n        method: 'DELETE',\n        headers: getAuthHeaders()\n      });\n\n      if (res.ok) {\n        loadMedia();\n      }\n    } catch (error) {\n      console.error('Error deleting:', error);\n    }\n  }\n\n  function copyUrl(url) {\n    navigator.clipboard.writeText(url);\n    alert('URL copiada al portapapeles');\n  }\n\n  if (loading) {\n    return <div className=\"admin-loading\">Cargando medios...</div>;\n  }\n\n  return (\n    <div className=\"admin-editor\">\n      <div className=\"admin-editor-header\">\n        <h2>Biblioteca de Medios</h2>\n        <label className=\"admin-btn-primary\">\n          {uploading ? 'Subiendo...' : '+ Subir Archivos'}\n          <input\n            type=\"file\"\n            multiple\n            accept=\"image/*,video/*\"\n            onChange={handleUpload}\n            style={{ display: 'none' }}\n            disabled={uploading}\n          />\n        </label>\n      </div>\n\n      <div className=\"admin-media-section\">\n        <h3>ImÃ¡genes ({images.length})</h3>\n        <div className=\"admin-media-grid\">\n          {images.map(img => (\n            <div key={img.filename} className=\"admin-media-item\">\n              <img src={img.url} alt={img.filename} />\n              <div className=\"admin-media-overlay\">\n                <button onClick={() => copyUrl(img.url)} title=\"Copiar URL\">\n                  ðŸ“‹\n                </button>\n                <button onClick={() => handleDelete(img.filename)} title=\"Eliminar\">\n                  ðŸ—‘ï¸\n                </button>\n              </div>\n              <span className=\"admin-media-name\">{img.filename}</span>\n            </div>\n          ))}\n          {images.length === 0 && (\n            <div className=\"admin-empty-small\">No hay imÃ¡genes</div>\n          )}\n        </div>\n      </div>\n\n      <div className=\"admin-media-section\">\n        <h3>Videos ({videos.length})</h3>\n        <div className=\"admin-media-grid\">\n          {videos.map(vid => (\n            <div key={vid.filename} className=\"admin-media-item video\">\n              <video src={vid.url} />\n              <div className=\"admin-media-overlay\">\n                <button onClick={() => copyUrl(vid.url)} title=\"Copiar URL\">\n                  ðŸ“‹\n                </button>\n                <button onClick={() => handleDelete(vid.filename)} title=\"Eliminar\">\n                  ðŸ—‘ï¸\n                </button>\n              </div>\n              <span className=\"admin-media-name\">{vid.filename}</span>\n            </div>\n          ))}\n          {videos.length === 0 && (\n            <div className=\"admin-empty-small\">No hay videos</div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":4285,"size_tokens":null},"src/admin/components/AnalystsEditor.js":{"content":"import React, { useState, useEffect } from 'react';\nimport { useAuth } from '../../context/AuthContext';\nimport ImageUploader from './ImageUploader';\n\nexport default function AnalystsEditor({ countryCode }) {\n  const { user, getAuthHeaders } = useAuth();\n  const [analysts, setAnalysts] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [showModal, setShowModal] = useState(false);\n  const [editingAnalyst, setEditingAnalyst] = useState(null);\n  const [formData, setFormData] = useState({\n    id: '',\n    name: '',\n    bio: '',\n    image: ''\n  });\n\n  useEffect(() => {\n    loadAnalysts();\n  }, [countryCode]);\n\n  async function loadAnalysts() {\n    try {\n      const res = await fetch(`/api/cms/countries/${countryCode}/analysts?lang=es`, {\n        headers: getAuthHeaders()\n      });\n      if (res.ok) {\n        const data = await res.json();\n        setAnalysts(data.items || []);\n      }\n    } catch (error) {\n      console.error('Error loading analysts:', error);\n    }\n    setLoading(false);\n  }\n\n  function openCreateModal() {\n    setEditingAnalyst(null);\n    setFormData({\n      id: '',\n      name: '',\n      bio: '',\n      image: ''\n    });\n    setShowModal(true);\n  }\n\n  async function handleSubmit(e) {\n    e.preventDefault();\n    \n    const body = {\n      ...formData,\n      id: formData.id || formData.name.toLowerCase().replace(/[^a-z0-9]/g, '-').slice(0, 20)\n    };\n\n    try {\n      const res = await fetch(`/api/cms/countries/${countryCode}/analysts?lang=es`, {\n        method: 'POST',\n        headers: {\n          ...getAuthHeaders(),\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(body)\n      });\n\n      const data = await res.json();\n      \n      if (res.ok) {\n        setShowModal(false);\n        if (data.pending) {\n          alert('Cambio enviado para aprobaciÃ³n');\n        }\n        loadAnalysts();\n      } else {\n        alert(data.error || 'Error al guardar');\n      }\n    } catch (error) {\n      console.error('Error saving:', error);\n    }\n  }\n\n  const canCreate = user.role === 'admin' || user.permissions?.canCreate;\n\n  if (loading) {\n    return <div className=\"admin-loading\">Cargando analistas...</div>;\n  }\n\n  return (\n    <div className=\"admin-editor\">\n      <div className=\"admin-editor-header\">\n        <h2>Analistas</h2>\n        {canCreate && (\n          <button onClick={openCreateModal} className=\"admin-btn-primary\">\n            + Nuevo Analista\n          </button>\n        )}\n      </div>\n\n      <div className=\"admin-items-grid\">\n        {analysts.length === 0 ? (\n          <div className=\"admin-empty\">\n            <p>No hay analistas registrados</p>\n          </div>\n        ) : (\n          analysts.map(analyst => (\n            <div key={analyst.id} className=\"admin-analyst-card\">\n              {analyst.image && (\n                <img src={analyst.image} alt={analyst.name} className=\"admin-analyst-image\" />\n              )}\n              <div className=\"admin-analyst-info\">\n                <h3>{analyst.name}</h3>\n                <p>{analyst.bio}</p>\n              </div>\n            </div>\n          ))\n        )}\n      </div>\n\n      {showModal && (\n        <div className=\"admin-modal-overlay\">\n          <div className=\"admin-modal\">\n            <h3>Nuevo Analista</h3>\n            <form onSubmit={handleSubmit}>\n              <div className=\"admin-form-group\">\n                <label>Nombre</label>\n                <input\n                  type=\"text\"\n                  value={formData.name}\n                  onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                  required\n                />\n              </div>\n\n              <div className=\"admin-form-group\">\n                <label>BiografÃ­a</label>\n                <textarea\n                  value={formData.bio}\n                  onChange={(e) => setFormData({ ...formData, bio: e.target.value })}\n                  rows={3}\n                />\n              </div>\n\n              <div className=\"admin-form-group\">\n                <label>Foto</label>\n                <ImageUploader\n                  value={formData.image}\n                  onChange={(url) => setFormData({ ...formData, image: url })}\n                />\n              </div>\n\n              <div className=\"admin-modal-actions\">\n                <button type=\"button\" onClick={() => setShowModal(false)} className=\"admin-btn-secondary\">\n                  Cancelar\n                </button>\n                <button type=\"submit\" className=\"admin-btn-primary\">\n                  Crear Analista\n                </button>\n              </div>\n            </form>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":4688,"size_tokens":null},"src/admin/components/ResistanceEditor.js":{"content":"import React, { useState, useEffect } from 'react';\nimport { useAuth } from '../../context/AuthContext';\nimport ImageUploader from './ImageUploader';\nimport MultiMediaUploader from './MultiMediaUploader';\n\nexport default function ResistanceEditor({ countryCode }) {\n  const { user, getAuthHeaders } = useAuth();\n  const [resistors, setResistors] = useState([]);\n  const [selectedResistor, setSelectedResistor] = useState(null);\n  const [resistorDetail, setResistorDetail] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [showResistorModal, setShowResistorModal] = useState(false);\n  const [showEntryModal, setShowEntryModal] = useState(false);\n  const [editingResistor, setEditingResistor] = useState(null);\n  const [editingEntry, setEditingEntry] = useState(null);\n  \n  const [resistorForm, setResistorForm] = useState({\n    id: '',\n    name: '',\n    bio: '',\n    image: '',\n    social: { instagram: '', telegram: '', donation: '' }\n  });\n\n  const [entryForm, setEntryForm] = useState({\n    id: '',\n    title: '',\n    summary: '',\n    date: '',\n    paragraphs: [''],\n    media: []\n  });\n\n  useEffect(() => {\n    loadResistors();\n  }, [countryCode]);\n\n  async function loadResistors() {\n    try {\n      const res = await fetch(`/api/cms/countries/${countryCode}/resistance?lang=es`, {\n        headers: getAuthHeaders()\n      });\n      if (res.ok) {\n        const data = await res.json();\n        setResistors(data.items || []);\n      }\n    } catch (error) {\n      console.error('Error loading resistance:', error);\n    }\n    setLoading(false);\n  }\n\n  async function loadResistorDetail(resistorId) {\n    try {\n      const res = await fetch(`/api/cms/countries/${countryCode}/resistance/${resistorId}?lang=es`, {\n        headers: getAuthHeaders()\n      });\n      if (res.ok) {\n        const data = await res.json();\n        setResistorDetail(data);\n        setSelectedResistor(resistorId);\n      }\n    } catch (error) {\n      console.error('Error loading resistor detail:', error);\n    }\n  }\n\n  function openCreateResistorModal() {\n    setEditingResistor(null);\n    setResistorForm({\n      id: '',\n      name: '',\n      bio: '',\n      image: '',\n      social: { instagram: '', telegram: '', donation: '' }\n    });\n    setShowResistorModal(true);\n  }\n\n  function openEditResistorModal() {\n    if (!resistorDetail) return;\n    setEditingResistor(resistorDetail);\n    setResistorForm({\n      id: resistorDetail.id,\n      name: resistorDetail.name || '',\n      bio: resistorDetail.bio || '',\n      image: resistorDetail.image || '',\n      social: resistorDetail.social || { instagram: '', telegram: '', donation: '' }\n    });\n    setShowResistorModal(true);\n  }\n\n  function openCreateEntryModal() {\n    setEditingEntry(null);\n    const nextId = `r${(resistorDetail?.entries?.length || 0) + 1}`;\n    setEntryForm({\n      id: nextId,\n      title: '',\n      summary: '',\n      date: '',\n      paragraphs: [''],\n      media: []\n    });\n    setShowEntryModal(true);\n  }\n\n  function openEditEntryModal(entry) {\n    setEditingEntry(entry);\n    setEntryForm({\n      id: entry.id,\n      title: entry.title || '',\n      summary: entry.summary || '',\n      date: entry.date || '',\n      paragraphs: entry.paragraphs || [''],\n      media: entry.media || []\n    });\n    setShowEntryModal(true);\n  }\n\n  async function handleResistorSubmit(e) {\n    e.preventDefault();\n    \n    const url = editingResistor\n      ? `/api/cms/countries/${countryCode}/resistance/${editingResistor.id}?lang=es`\n      : `/api/cms/countries/${countryCode}/resistance?lang=es`;\n    \n    const method = editingResistor ? 'PUT' : 'POST';\n\n    const body = {\n      ...resistorForm,\n      id: resistorForm.id || resistorForm.name.toLowerCase().replace(/[^a-z0-9]/g, '-').slice(0, 20)\n    };\n\n    try {\n      const res = await fetch(url, {\n        method,\n        headers: {\n          ...getAuthHeaders(),\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(body)\n      });\n\n      const data = await res.json();\n      \n      if (res.ok) {\n        setShowResistorModal(false);\n        if (data.pending) {\n          alert('Cambio enviado para aprobaciÃ³n');\n        }\n        loadResistors();\n        if (editingResistor) {\n          loadResistorDetail(editingResistor.id);\n        }\n      } else {\n        alert(data.error || 'Error al guardar');\n      }\n    } catch (error) {\n      console.error('Error saving:', error);\n    }\n  }\n\n  async function handleEntrySubmit(e) {\n    e.preventDefault();\n    \n    const body = {\n      ...entryForm,\n      paragraphs: entryForm.paragraphs.filter(p => p.trim()),\n      media: entryForm.media || []\n    };\n\n    const isEdit = editingEntry && editingEntry.id;\n    const url = isEdit\n      ? `/api/cms/countries/${countryCode}/resistance/${selectedResistor}/entry/${editingEntry.id}?lang=es`\n      : `/api/cms/countries/${countryCode}/resistance/${selectedResistor}/entry?lang=es`;\n\n    try {\n      const res = await fetch(url, {\n        method: isEdit ? 'PUT' : 'POST',\n        headers: {\n          ...getAuthHeaders(),\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(body)\n      });\n\n      const data = await res.json();\n      \n      if (res.ok) {\n        setShowEntryModal(false);\n        if (data.pending) {\n          alert('Cambio enviado para aprobaciÃ³n');\n        }\n        loadResistorDetail(selectedResistor);\n      } else {\n        alert(data.error || 'Error al guardar');\n      }\n    } catch (error) {\n      console.error('Error saving:', error);\n    }\n  }\n\n  function addParagraph() {\n    setEntryForm({ ...entryForm, paragraphs: [...entryForm.paragraphs, ''] });\n  }\n\n  function updateParagraph(index, value) {\n    const newParagraphs = [...entryForm.paragraphs];\n    newParagraphs[index] = value;\n    setEntryForm({ ...entryForm, paragraphs: newParagraphs });\n  }\n\n  function removeParagraph(index) {\n    setEntryForm({ \n      ...entryForm, \n      paragraphs: entryForm.paragraphs.filter((_, i) => i !== index) \n    });\n  }\n\n  const canCreate = user.role === 'admin' || user.permissions?.canCreate;\n  const canEdit = user.role === 'admin' || user.permissions?.canEdit;\n\n  if (loading) {\n    return <div className=\"admin-loading\">Cargando resistencia...</div>;\n  }\n\n  return (\n    <div className=\"admin-editor\">\n      <div className=\"admin-editor-header\">\n        <h2>Resistencia</h2>\n        {canCreate && (\n          <button onClick={openCreateResistorModal} className=\"admin-btn-primary\">\n            + Nueva Persona/Grupo\n          </button>\n        )}\n      </div>\n\n      <div className=\"admin-testimonies-layout\">\n        <div className=\"admin-witnesses-list\">\n          <h3>Personas/Grupos ({resistors.length})</h3>\n          {resistors.map(resistor => (\n            <div \n              key={resistor.id} \n              className={`admin-witness-item ${selectedResistor === resistor.id ? 'active' : ''}`}\n              onClick={() => loadResistorDetail(resistor.id)}\n            >\n              {resistor.image && (\n                <img src={resistor.image} alt={resistor.name} className=\"admin-witness-thumb\" />\n              )}\n              <span>{resistor.name}</span>\n            </div>\n          ))}\n          {resistors.length === 0 && (\n            <div className=\"admin-empty-small\">No hay entradas de resistencia</div>\n          )}\n        </div>\n\n        <div className=\"admin-witness-detail\">\n          {resistorDetail ? (\n            <>\n              <div className=\"admin-witness-header\">\n                <div className=\"admin-witness-info\">\n                  {resistorDetail.image && (\n                    <img src={resistorDetail.image} alt={resistorDetail.name} className=\"admin-witness-avatar\" />\n                  )}\n                  <div>\n                    <h3>{resistorDetail.name}</h3>\n                    <p className=\"admin-witness-bio\">{resistorDetail.bio}</p>\n                  </div>\n                </div>\n                {canEdit && (\n                  <button onClick={openEditResistorModal} className=\"admin-btn-secondary\">\n                    Editar\n                  </button>\n                )}\n              </div>\n\n              <div className=\"admin-testimonies-section\">\n                <div className=\"admin-section-header\">\n                  <h4>Entradas ({resistorDetail.entries?.length || 0})</h4>\n                  {canCreate && (\n                    <button onClick={openCreateEntryModal} className=\"admin-btn-primary small\">\n                      + AÃ±adir Entrada\n                    </button>\n                  )}\n                </div>\n\n                <div className=\"admin-testimonies-list\">\n                  {resistorDetail.entries?.map(entry => (\n                    <div key={entry.id} className=\"admin-testimony-card\" onClick={() => canEdit && openEditEntryModal(entry)}>\n                      <h5>{entry.title}</h5>\n                      <p>{entry.summary}</p>\n                      <span className=\"admin-testimony-date\">{entry.date}</span>\n                      {entry.media && entry.media.length > 0 && (\n                        <span className=\"admin-testimony-media-count\">\n                          {entry.media.length} archivo(s) multimedia\n                        </span>\n                      )}\n                    </div>\n                  ))}\n                  {(!resistorDetail.entries || resistorDetail.entries.length === 0) && (\n                    <div className=\"admin-empty-small\">No hay entradas</div>\n                  )}\n                </div>\n              </div>\n            </>\n          ) : (\n            <div className=\"admin-empty\">\n              <p>Selecciona una persona o grupo para ver sus detalles</p>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {showResistorModal && (\n        <div className=\"admin-modal-overlay\">\n          <div className=\"admin-modal large\">\n            <h3>{editingResistor ? 'Editar Persona/Grupo' : 'Nueva Persona/Grupo'}</h3>\n            <form onSubmit={handleResistorSubmit}>\n              <div className=\"admin-form-group\">\n                <label>Nombre</label>\n                <input\n                  type=\"text\"\n                  value={resistorForm.name}\n                  onChange={(e) => setResistorForm({ ...resistorForm, name: e.target.value })}\n                  required\n                />\n              </div>\n\n              <div className=\"admin-form-group\">\n                <label>DescripciÃ³n/BiografÃ­a</label>\n                <textarea\n                  value={resistorForm.bio}\n                  onChange={(e) => setResistorForm({ ...resistorForm, bio: e.target.value })}\n                  rows={3}\n                />\n              </div>\n\n              <div className=\"admin-form-group\">\n                <label>Foto/Imagen</label>\n                <ImageUploader\n                  value={resistorForm.image}\n                  onChange={(url) => setResistorForm({ ...resistorForm, image: url })}\n                />\n              </div>\n\n              <div className=\"admin-form-group\">\n                <label>Redes Sociales / Enlaces</label>\n                <div className=\"admin-social-inputs\">\n                  <input\n                    type=\"text\"\n                    placeholder=\"Instagram URL\"\n                    value={resistorForm.social.instagram}\n                    onChange={(e) => setResistorForm({ \n                      ...resistorForm, \n                      social: { ...resistorForm.social, instagram: e.target.value }\n                    })}\n                  />\n                  <input\n                    type=\"text\"\n                    placeholder=\"Telegram URL\"\n                    value={resistorForm.social.telegram}\n                    onChange={(e) => setResistorForm({ \n                      ...resistorForm, \n                      social: { ...resistorForm.social, telegram: e.target.value }\n                    })}\n                  />\n                  <input\n                    type=\"text\"\n                    placeholder=\"DonaciÃ³n URL\"\n                    value={resistorForm.social.donation}\n                    onChange={(e) => setResistorForm({ \n                      ...resistorForm, \n                      social: { ...resistorForm.social, donation: e.target.value }\n                    })}\n                  />\n                </div>\n              </div>\n\n              <div className=\"admin-modal-actions\">\n                <button type=\"button\" onClick={() => setShowResistorModal(false)} className=\"admin-btn-secondary\">\n                  Cancelar\n                </button>\n                <button type=\"submit\" className=\"admin-btn-primary\">\n                  {editingResistor ? 'Guardar Cambios' : 'Crear'}\n                </button>\n              </div>\n            </form>\n          </div>\n        </div>\n      )}\n\n      {showEntryModal && (\n        <div className=\"admin-modal-overlay\">\n          <div className=\"admin-modal large\">\n            <h3>{editingEntry ? 'Editar Entrada' : 'Nueva Entrada de Resistencia'}</h3>\n            <form onSubmit={handleEntrySubmit}>\n              <div className=\"admin-form-group\">\n                <label>TÃ­tulo</label>\n                <input\n                  type=\"text\"\n                  value={entryForm.title}\n                  onChange={(e) => setEntryForm({ ...entryForm, title: e.target.value })}\n                  required\n                />\n              </div>\n\n              <div className=\"admin-form-row\">\n                <div className=\"admin-form-group\">\n                  <label>Resumen</label>\n                  <input\n                    type=\"text\"\n                    value={entryForm.summary}\n                    onChange={(e) => setEntryForm({ ...entryForm, summary: e.target.value })}\n                  />\n                </div>\n                <div className=\"admin-form-group\">\n                  <label>Fecha/Contexto</label>\n                  <input\n                    type=\"text\"\n                    value={entryForm.date}\n                    onChange={(e) => setEntryForm({ ...entryForm, date: e.target.value })}\n                  />\n                </div>\n              </div>\n\n              <div className=\"admin-form-group\">\n                <label>Archivos Multimedia (fotos, videos, audio)</label>\n                <MultiMediaUploader\n                  value={entryForm.media}\n                  onChange={(media) => setEntryForm({ ...entryForm, media })}\n                  allowedTypes={['image', 'video', 'audio']}\n                />\n              </div>\n\n              <div className=\"admin-form-group\">\n                <label>Contenido (pÃ¡rrafos)</label>\n                {entryForm.paragraphs.map((p, i) => (\n                  <div key={i} className=\"admin-array-item\">\n                    <textarea\n                      value={p}\n                      onChange={(e) => updateParagraph(i, e.target.value)}\n                      rows={3}\n                      placeholder={`PÃ¡rrafo ${i + 1}`}\n                    />\n                    <button type=\"button\" onClick={() => removeParagraph(i)} className=\"admin-btn-remove\">\n                      Ã—\n                    </button>\n                  </div>\n                ))}\n                <button type=\"button\" onClick={addParagraph} className=\"admin-btn-add\">\n                  + AÃ±adir pÃ¡rrafo\n                </button>\n              </div>\n\n              <div className=\"admin-modal-actions\">\n                <button type=\"button\" onClick={() => setShowEntryModal(false)} className=\"admin-btn-secondary\">\n                  Cancelar\n                </button>\n                <button type=\"submit\" className=\"admin-btn-primary\">\n                  {editingEntry ? 'Guardar Cambios' : 'Crear Entrada'}\n                </button>\n              </div>\n            </form>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":15863,"size_tokens":null},"src/admin/AdminPending.js":{"content":"import React, { useState, useEffect } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { useAuth } from '../context/AuthContext';\nimport './admin.css';\n\nexport default function AdminPending() {\n  const { user, getAuthHeaders } = useAuth();\n  const navigate = useNavigate();\n  const [changes, setChanges] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    if (user.role !== 'admin') {\n      navigate('/admin');\n      return;\n    }\n    loadChanges();\n  }, []);\n\n  async function loadChanges() {\n    try {\n      const res = await fetch('/api/cms/pending', { headers: getAuthHeaders() });\n      if (res.ok) {\n        const data = await res.json();\n        setChanges(data.changes || []);\n      }\n    } catch (error) {\n      console.error('Error loading changes:', error);\n    }\n    setLoading(false);\n  }\n\n  async function handleApprove(changeId) {\n    try {\n      const res = await fetch(`/api/cms/pending/${changeId}/approve`, {\n        method: 'POST',\n        headers: getAuthHeaders()\n      });\n      if (res.ok) {\n        loadChanges();\n      }\n    } catch (error) {\n      console.error('Error approving:', error);\n    }\n  }\n\n  async function handleReject(changeId) {\n    if (!window.confirm('Â¿Rechazar este cambio?')) return;\n    \n    try {\n      const res = await fetch(`/api/cms/pending/${changeId}/reject`, {\n        method: 'POST',\n        headers: getAuthHeaders()\n      });\n      if (res.ok) {\n        loadChanges();\n      }\n    } catch (error) {\n      console.error('Error rejecting:', error);\n    }\n  }\n\n  function getTypeLabel(type) {\n    switch (type) {\n      case 'create': return 'Crear';\n      case 'edit': return 'Editar';\n      case 'delete': return 'Eliminar';\n      default: return type;\n    }\n  }\n\n  function getSectionLabel(section) {\n    switch (section) {\n      case 'timeline': return 'Timeline';\n      case 'testimonies': return 'Testimonios';\n      case 'testimony': return 'Testimonio';\n      case 'analysts': return 'Analistas';\n      default: return section;\n    }\n  }\n\n  if (loading) {\n    return <div className=\"admin-loading\">Cargando...</div>;\n  }\n\n  return (\n    <div className=\"admin-container\">\n      <header className=\"admin-header\">\n        <div className=\"admin-header-left\">\n          <Link to=\"/admin\" className=\"admin-back-link\">â† Volver</Link>\n          <h1>Cambios Pendientes</h1>\n        </div>\n      </header>\n\n      <main className=\"admin-main\">\n        <div className=\"admin-section\">\n          {changes.length === 0 ? (\n            <div className=\"admin-empty\">\n              <p>No hay cambios pendientes de aprobaciÃ³n</p>\n            </div>\n          ) : (\n            <div className=\"admin-pending-list\">\n              {changes.map(change => (\n                <div key={change.id} className=\"admin-pending-card\">\n                  <div className=\"admin-pending-header\">\n                    <span className={`admin-pending-type ${change.type}`}>\n                      {getTypeLabel(change.type)}\n                    </span>\n                    <span className=\"admin-pending-section\">\n                      {getSectionLabel(change.section)}\n                    </span>\n                    <span className=\"admin-pending-country\">\n                      {change.countryCode}\n                    </span>\n                  </div>\n                  \n                  <div className=\"admin-pending-meta\">\n                    <span>Por: {change.userName}</span>\n                    <span>{new Date(change.createdAt).toLocaleString()}</span>\n                  </div>\n\n                  {change.data && (\n                    <div className=\"admin-pending-preview\">\n                      <strong>{change.data.title || change.data.name}</strong>\n                      {change.data.summary && <p>{change.data.summary}</p>}\n                    </div>\n                  )}\n\n                  <div className=\"admin-pending-actions\">\n                    <button \n                      onClick={() => handleApprove(change.id)} \n                      className=\"admin-btn-success\"\n                    >\n                      Aprobar\n                    </button>\n                    <button \n                      onClick={() => handleReject(change.id)} \n                      className=\"admin-btn-danger\"\n                    >\n                      Rechazar\n                    </button>\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      </main>\n    </div>\n  );\n}\n","path":null,"size_bytes":4535,"size_tokens":null},"src/admin/components/TimelineEditor.js":{"content":"import React, { useState, useEffect } from 'react';\nimport { useAuth } from '../../context/AuthContext';\nimport ImageUploader from './ImageUploader';\n\nexport default function TimelineEditor({ countryCode }) {\n  const { user, getAuthHeaders } = useAuth();\n  const [items, setItems] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [showModal, setShowModal] = useState(false);\n  const [editingItem, setEditingItem] = useState(null);\n  const [formData, setFormData] = useState({\n    id: '',\n    date: '',\n    year: '',\n    month: '',\n    title: '',\n    summary: '',\n    image: '',\n    video: '',\n    paragraphs: [],\n    sources: []\n  });\n  const [filterYear, setFilterYear] = useState('');\n  const [filterMonth, setFilterMonth] = useState('');\n\n  useEffect(() => {\n    loadItems();\n  }, [countryCode]);\n\n  async function loadItems() {\n    try {\n      const res = await fetch(`/api/cms/countries/${countryCode}/timeline?lang=es`, {\n        headers: getAuthHeaders()\n      });\n      if (res.ok) {\n        const data = await res.json();\n        setItems(data.items || []);\n      }\n    } catch (error) {\n      console.error('Error loading timeline:', error);\n    }\n    setLoading(false);\n  }\n\n  function openCreateModal() {\n    setEditingItem(null);\n    setFormData({\n      id: '',\n      date: '',\n      year: new Date().getFullYear(),\n      month: new Date().getMonth() + 1,\n      title: '',\n      summary: '',\n      image: '',\n      video: '',\n      paragraphs: [''],\n      sources: ['']\n    });\n    setShowModal(true);\n  }\n\n  function openEditModal(item) {\n    setEditingItem(item);\n    setFormData({\n      id: item.id,\n      date: item.date || '',\n      year: item.year || '',\n      month: item.month || '',\n      title: item.title || '',\n      summary: item.summary || '',\n      image: item.image || '',\n      video: item.video || '',\n      paragraphs: item.paragraphs || [''],\n      sources: item.sources || ['']\n    });\n    setShowModal(true);\n  }\n\n  async function handleSubmit(e) {\n    e.preventDefault();\n    \n    const url = editingItem\n      ? `/api/cms/countries/${countryCode}/timeline/${editingItem.id}?lang=es`\n      : `/api/cms/countries/${countryCode}/timeline?lang=es`;\n    \n    const method = editingItem ? 'PUT' : 'POST';\n\n    const body = {\n      ...formData,\n      id: formData.id || formData.title.toLowerCase().replace(/[^a-z0-9]/g, '-'),\n      year: parseInt(formData.year) || null,\n      month: parseInt(formData.month) || null,\n      paragraphs: formData.paragraphs.filter(p => p.trim()),\n      sources: formData.sources.filter(s => s.trim())\n    };\n\n    try {\n      const res = await fetch(url, {\n        method,\n        headers: {\n          ...getAuthHeaders(),\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(body)\n      });\n\n      const data = await res.json();\n      \n      if (res.ok) {\n        setShowModal(false);\n        if (data.pending) {\n          alert('Cambio enviado para aprobaciÃ³n del administrador');\n        }\n        loadItems();\n      } else {\n        alert(data.error || 'Error al guardar');\n      }\n    } catch (error) {\n      console.error('Error saving:', error);\n    }\n  }\n\n  async function handleDelete(item) {\n    if (!window.confirm(`Â¿Eliminar \"${item.title}\"?`)) return;\n\n    try {\n      const res = await fetch(`/api/cms/countries/${countryCode}/timeline/${item.id}?lang=es`, {\n        method: 'DELETE',\n        headers: getAuthHeaders()\n      });\n\n      const data = await res.json();\n      \n      if (res.ok) {\n        if (data.pending) {\n          alert('EliminaciÃ³n enviada para aprobaciÃ³n');\n        }\n        loadItems();\n      }\n    } catch (error) {\n      console.error('Error deleting:', error);\n    }\n  }\n\n  function addParagraph() {\n    setFormData({ ...formData, paragraphs: [...formData.paragraphs, ''] });\n  }\n\n  function updateParagraph(index, value) {\n    const newParagraphs = [...formData.paragraphs];\n    newParagraphs[index] = value;\n    setFormData({ ...formData, paragraphs: newParagraphs });\n  }\n\n  function removeParagraph(index) {\n    setFormData({ \n      ...formData, \n      paragraphs: formData.paragraphs.filter((_, i) => i !== index) \n    });\n  }\n\n  function addSource() {\n    setFormData({ ...formData, sources: [...formData.sources, ''] });\n  }\n\n  function updateSource(index, value) {\n    const newSources = [...formData.sources];\n    newSources[index] = value;\n    setFormData({ ...formData, sources: newSources });\n  }\n\n  function removeSource(index) {\n    setFormData({ \n      ...formData, \n      sources: formData.sources.filter((_, i) => i !== index) \n    });\n  }\n\n  const years = [...new Set(items.map(i => i.year).filter(Boolean))].sort((a, b) => b - a);\n  const months = [\n    { value: 1, label: 'Enero' },\n    { value: 2, label: 'Febrero' },\n    { value: 3, label: 'Marzo' },\n    { value: 4, label: 'Abril' },\n    { value: 5, label: 'Mayo' },\n    { value: 6, label: 'Junio' },\n    { value: 7, label: 'Julio' },\n    { value: 8, label: 'Agosto' },\n    { value: 9, label: 'Septiembre' },\n    { value: 10, label: 'Octubre' },\n    { value: 11, label: 'Noviembre' },\n    { value: 12, label: 'Diciembre' }\n  ];\n\n  const filteredItems = items.filter(item => {\n    if (filterYear && item.year !== parseInt(filterYear)) return false;\n    if (filterMonth && item.month !== parseInt(filterMonth)) return false;\n    return true;\n  });\n\n  const canCreate = user.role === 'admin' || user.permissions?.canCreate;\n  const canEdit = user.role === 'admin' || user.permissions?.canEdit;\n  const canDelete = user.role === 'admin' || user.permissions?.canDelete;\n\n  if (loading) {\n    return <div className=\"admin-loading\">Cargando timeline...</div>;\n  }\n\n  return (\n    <div className=\"admin-editor\">\n      <div className=\"admin-editor-header\">\n        <h2>Timeline</h2>\n        <div className=\"admin-editor-filters\">\n          <select value={filterYear} onChange={(e) => setFilterYear(e.target.value)}>\n            <option value=\"\">Todos los aÃ±os</option>\n            {years.map(y => (\n              <option key={y} value={y}>{y}</option>\n            ))}\n          </select>\n          <select value={filterMonth} onChange={(e) => setFilterMonth(e.target.value)}>\n            <option value=\"\">Todos los meses</option>\n            {months.map(m => (\n              <option key={m.value} value={m.value}>{m.label}</option>\n            ))}\n          </select>\n        </div>\n        {canCreate && (\n          <button onClick={openCreateModal} className=\"admin-btn-primary\">\n            + Nuevo Evento\n          </button>\n        )}\n      </div>\n\n      <div className=\"admin-items-list\">\n        {filteredItems.length === 0 ? (\n          <div className=\"admin-empty\">\n            <p>No hay eventos en el timeline</p>\n          </div>\n        ) : (\n          filteredItems.map(item => (\n            <div key={item.id} className=\"admin-item-card\">\n              {item.image && (\n                <img src={item.image} alt={item.title} className=\"admin-item-thumb\" />\n              )}\n              <div className=\"admin-item-content\">\n                <div className=\"admin-item-date\">{item.date}</div>\n                <h3>{item.title}</h3>\n                <p>{item.summary}</p>\n              </div>\n              <div className=\"admin-item-actions\">\n                {canEdit && (\n                  <button onClick={() => openEditModal(item)} className=\"admin-btn-icon\">\n                    âœï¸\n                  </button>\n                )}\n                {canDelete && (\n                  <button onClick={() => handleDelete(item)} className=\"admin-btn-icon delete\">\n                    ðŸ—‘ï¸\n                  </button>\n                )}\n              </div>\n            </div>\n          ))\n        )}\n      </div>\n\n      {showModal && (\n        <div className=\"admin-modal-overlay\">\n          <div className=\"admin-modal large\">\n            <h3>{editingItem ? 'Editar Evento' : 'Nuevo Evento'}</h3>\n            <form onSubmit={handleSubmit}>\n              <div className=\"admin-form-row\">\n                <div className=\"admin-form-group\">\n                  <label>TÃ­tulo</label>\n                  <input\n                    type=\"text\"\n                    value={formData.title}\n                    onChange={(e) => setFormData({ ...formData, title: e.target.value })}\n                    required\n                  />\n                </div>\n              </div>\n\n              <div className=\"admin-form-row three\">\n                <div className=\"admin-form-group\">\n                  <label>Fecha (texto)</label>\n                  <input\n                    type=\"text\"\n                    value={formData.date}\n                    onChange={(e) => setFormData({ ...formData, date: e.target.value })}\n                    placeholder=\"15 de mayo de 1948\"\n                    required\n                  />\n                </div>\n                <div className=\"admin-form-group\">\n                  <label>AÃ±o</label>\n                  <input\n                    type=\"number\"\n                    value={formData.year}\n                    onChange={(e) => setFormData({ ...formData, year: e.target.value })}\n                    placeholder=\"1948\"\n                  />\n                </div>\n                <div className=\"admin-form-group\">\n                  <label>Mes</label>\n                  <select\n                    value={formData.month}\n                    onChange={(e) => setFormData({ ...formData, month: e.target.value })}\n                  >\n                    <option value=\"\">Sin mes</option>\n                    {months.map(m => (\n                      <option key={m.value} value={m.value}>{m.label}</option>\n                    ))}\n                  </select>\n                </div>\n              </div>\n\n              <div className=\"admin-form-group\">\n                <label>Resumen</label>\n                <textarea\n                  value={formData.summary}\n                  onChange={(e) => setFormData({ ...formData, summary: e.target.value })}\n                  rows={2}\n                />\n              </div>\n\n              <div className=\"admin-form-group\">\n                <label>Imagen</label>\n                <ImageUploader\n                  value={formData.image}\n                  onChange={(url) => setFormData({ ...formData, image: url })}\n                />\n              </div>\n\n              <div className=\"admin-form-group\">\n                <label>Video (URL)</label>\n                <input\n                  type=\"text\"\n                  value={formData.video}\n                  onChange={(e) => setFormData({ ...formData, video: e.target.value })}\n                  placeholder=\"/imagenes/video.mp4 o URL externa\"\n                />\n              </div>\n\n              <div className=\"admin-form-group\">\n                <label>Contenido (pÃ¡rrafos)</label>\n                {formData.paragraphs.map((p, i) => (\n                  <div key={i} className=\"admin-array-item\">\n                    <textarea\n                      value={p}\n                      onChange={(e) => updateParagraph(i, e.target.value)}\n                      rows={3}\n                      placeholder={`PÃ¡rrafo ${i + 1}`}\n                    />\n                    <button type=\"button\" onClick={() => removeParagraph(i)} className=\"admin-btn-remove\">\n                      Ã—\n                    </button>\n                  </div>\n                ))}\n                <button type=\"button\" onClick={addParagraph} className=\"admin-btn-add\">\n                  + AÃ±adir pÃ¡rrafo\n                </button>\n              </div>\n\n              <div className=\"admin-form-group\">\n                <label>Fuentes</label>\n                {formData.sources.map((s, i) => (\n                  <div key={i} className=\"admin-array-item\">\n                    <input\n                      type=\"text\"\n                      value={s}\n                      onChange={(e) => updateSource(i, e.target.value)}\n                      placeholder={`Fuente ${i + 1}`}\n                    />\n                    <button type=\"button\" onClick={() => removeSource(i)} className=\"admin-btn-remove\">\n                      Ã—\n                    </button>\n                  </div>\n                ))}\n                <button type=\"button\" onClick={addSource} className=\"admin-btn-add\">\n                  + AÃ±adir fuente\n                </button>\n              </div>\n\n              <div className=\"admin-modal-actions\">\n                <button type=\"button\" onClick={() => setShowModal(false)} className=\"admin-btn-secondary\">\n                  Cancelar\n                </button>\n                <button type=\"submit\" className=\"admin-btn-primary\">\n                  {editingItem ? 'Guardar Cambios' : 'Crear Evento'}\n                </button>\n              </div>\n            </form>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":12875,"size_tokens":null},"src/admin/admin.css":{"content":":root {\n  --admin-primary: #0c3344;\n  --admin-primary-light: #1d546b;\n  --admin-accent: #8b0000;\n  --admin-bg: #f5f5f5;\n  --admin-card-bg: #ffffff;\n  --admin-text: #333333;\n  --admin-text-light: #666666;\n  --admin-border: #e0e0e0;\n  --admin-success: #28a745;\n  --admin-danger: #dc3545;\n  --admin-warning: #ffc107;\n}\n\n.admin-login-container {\n  min-height: 100vh;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: linear-gradient(135deg, var(--admin-primary) 0%, var(--admin-primary-light) 100%);\n  padding: 1rem;\n}\n\n.admin-login-box {\n  background: var(--admin-card-bg);\n  padding: 2.5rem;\n  border-radius: 12px;\n  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);\n  width: 100%;\n  max-width: 400px;\n}\n\n.admin-login-header {\n  text-align: center;\n  margin-bottom: 2rem;\n}\n\n.admin-login-header h1 {\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 2rem;\n  color: var(--admin-primary);\n  margin-bottom: 0.5rem;\n}\n\n.admin-login-header h1 span {\n  font-weight: 400;\n}\n\n.admin-login-header p {\n  color: var(--admin-text-light);\n  font-size: 0.9rem;\n}\n\n.admin-login-form {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n}\n\n.admin-form-group {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n\n.admin-form-group label {\n  font-weight: 500;\n  color: var(--admin-text);\n  font-size: 0.9rem;\n}\n\n.admin-form-group input,\n.admin-form-group select,\n.admin-form-group textarea {\n  padding: 0.75rem 1rem;\n  border: 1px solid var(--admin-border);\n  border-radius: 6px;\n  font-size: 1rem;\n  transition: border-color 0.2s, box-shadow 0.2s;\n}\n\n.admin-form-group input:focus,\n.admin-form-group select:focus,\n.admin-form-group textarea:focus {\n  outline: none;\n  border-color: var(--admin-primary);\n  box-shadow: 0 0 0 3px rgba(12, 51, 68, 0.1);\n}\n\n.admin-error {\n  background: #fde8e8;\n  color: var(--admin-danger);\n  padding: 0.75rem 1rem;\n  border-radius: 6px;\n  font-size: 0.9rem;\n}\n\n.admin-btn-primary {\n  background: var(--admin-primary);\n  color: white;\n  border: none;\n  padding: 0.75rem 1.5rem;\n  border-radius: 6px;\n  font-size: 1rem;\n  font-weight: 500;\n  cursor: pointer;\n  transition: background 0.2s;\n}\n\n.admin-btn-primary:hover {\n  background: var(--admin-primary-light);\n}\n\n.admin-btn-primary:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n}\n\n.admin-btn-secondary {\n  background: transparent;\n  color: var(--admin-primary);\n  border: 1px solid var(--admin-primary);\n  padding: 0.75rem 1.5rem;\n  border-radius: 6px;\n  font-size: 1rem;\n  font-weight: 500;\n  cursor: pointer;\n  transition: background 0.2s;\n}\n\n.admin-btn-secondary:hover {\n  background: rgba(12, 51, 68, 0.05);\n}\n\n.admin-btn-success {\n  background: var(--admin-success);\n  color: white;\n  border: none;\n  padding: 0.5rem 1rem;\n  border-radius: 6px;\n  cursor: pointer;\n}\n\n.admin-btn-danger {\n  background: var(--admin-danger);\n  color: white;\n  border: none;\n  padding: 0.5rem 1rem;\n  border-radius: 6px;\n  cursor: pointer;\n}\n\n.admin-btn-logout {\n  background: transparent;\n  color: white;\n  border: 1px solid rgba(255, 255, 255, 0.5);\n  padding: 0.5rem 1rem;\n  border-radius: 6px;\n  cursor: pointer;\n  transition: background 0.2s;\n}\n\n.admin-btn-logout:hover {\n  background: rgba(255, 255, 255, 0.1);\n}\n\n.admin-login-footer {\n  text-align: center;\n  margin-top: 1.5rem;\n  padding-top: 1.5rem;\n  border-top: 1px solid var(--admin-border);\n}\n\n.admin-login-footer a {\n  color: var(--admin-primary);\n  text-decoration: none;\n}\n\n.admin-container {\n  min-height: 100vh;\n  background: var(--admin-bg);\n}\n\n.admin-header {\n  background: var(--admin-primary);\n  color: white;\n  padding: 1rem 2rem;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.admin-header-left {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n}\n\n.admin-header h1 {\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 1.5rem;\n  font-weight: 600;\n}\n\n.admin-header h1 span {\n  font-weight: 400;\n}\n\n.admin-back-link {\n  color: rgba(255, 255, 255, 0.8);\n  text-decoration: none;\n  font-size: 0.9rem;\n}\n\n.admin-back-link:hover {\n  color: white;\n}\n\n.admin-header-right {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n}\n\n.admin-user-name {\n  font-weight: 500;\n}\n\n.admin-user-role {\n  font-size: 0.8rem;\n  opacity: 0.8;\n  background: rgba(255, 255, 255, 0.1);\n  padding: 0.25rem 0.5rem;\n  border-radius: 4px;\n}\n\n.admin-nav {\n  background: white;\n  border-bottom: 1px solid var(--admin-border);\n  padding: 0 2rem;\n  display: flex;\n  gap: 0.5rem;\n}\n\n.admin-nav-item {\n  padding: 1rem 1.5rem;\n  color: var(--admin-text);\n  text-decoration: none;\n  border-bottom: 3px solid transparent;\n  transition: all 0.2s;\n}\n\n.admin-nav-item:hover {\n  background: rgba(12, 51, 68, 0.05);\n}\n\n.admin-nav-item.active {\n  color: var(--admin-primary);\n  border-bottom-color: var(--admin-primary);\n  font-weight: 500;\n}\n\n.admin-nav-back {\n  margin-left: auto;\n  color: var(--admin-text-light);\n}\n\n.admin-badge {\n  background: var(--admin-accent);\n  color: white;\n  font-size: 0.75rem;\n  padding: 0.1rem 0.4rem;\n  border-radius: 10px;\n  margin-left: 0.5rem;\n}\n\n.admin-main {\n  padding: 2rem;\n  max-width: 1400px;\n  margin: 0 auto;\n}\n\n.admin-section {\n  background: white;\n  border-radius: 12px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);\n  padding: 1.5rem;\n}\n\n.admin-section-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 1.5rem;\n}\n\n.admin-section-header h2 {\n  font-family: 'Cormorant Garamond', serif;\n  color: var(--admin-primary);\n  font-size: 1.5rem;\n}\n\n.admin-countries-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));\n  gap: 1.5rem;\n}\n\n.admin-country-card {\n  background: var(--admin-bg);\n  border-radius: 8px;\n  padding: 1.5rem;\n  transition: transform 0.2s, box-shadow 0.2s;\n}\n\n.admin-country-card:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);\n}\n\n.admin-country-card.disabled {\n  opacity: 0.6;\n}\n\n.admin-country-card h3 {\n  font-family: 'Cormorant Garamond', serif;\n  color: var(--admin-primary);\n  font-size: 1.3rem;\n  margin-bottom: 0.5rem;\n}\n\n.admin-country-code {\n  color: var(--admin-text-light);\n  font-size: 0.85rem;\n  margin-bottom: 0.5rem;\n}\n\n.admin-country-sections {\n  color: var(--admin-text-light);\n  font-size: 0.9rem;\n  margin-bottom: 1rem;\n}\n\n.admin-no-access {\n  color: var(--admin-text-light);\n  font-style: italic;\n  font-size: 0.9rem;\n}\n\n.admin-empty {\n  text-align: center;\n  padding: 3rem;\n  color: var(--admin-text-light);\n}\n\n.admin-empty-small {\n  text-align: center;\n  padding: 1rem;\n  color: var(--admin-text-light);\n  font-size: 0.9rem;\n}\n\n.admin-loading {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  min-height: 200px;\n  color: var(--admin-text-light);\n}\n\n.admin-modal-overlay {\n  position: fixed;\n  inset: 0;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 1rem;\n  z-index: 1000;\n}\n\n.admin-modal {\n  background: white;\n  border-radius: 12px;\n  padding: 2rem;\n  width: 100%;\n  max-width: 500px;\n  max-height: 90vh;\n  overflow-y: auto;\n}\n\n.admin-modal.large {\n  max-width: 700px;\n}\n\n.admin-modal.gallery {\n  max-width: 800px;\n}\n\n.admin-modal h3 {\n  font-family: 'Cormorant Garamond', serif;\n  color: var(--admin-primary);\n  font-size: 1.5rem;\n  margin-bottom: 1.5rem;\n}\n\n.admin-modal-actions {\n  display: flex;\n  gap: 1rem;\n  justify-content: flex-end;\n  margin-top: 2rem;\n  padding-top: 1rem;\n  border-top: 1px solid var(--admin-border);\n}\n\n.admin-form-row {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 1rem;\n  margin-bottom: 1rem;\n}\n\n.admin-form-row.three {\n  grid-template-columns: 2fr 1fr 1fr;\n}\n\n.admin-countries-checkboxes,\n.admin-permissions-checkboxes {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 0.5rem;\n}\n\n.admin-checkbox {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0.5rem 1rem;\n  background: var(--admin-bg);\n  border-radius: 6px;\n  cursor: pointer;\n  font-size: 0.9rem;\n}\n\n.admin-checkbox input {\n  accent-color: var(--admin-primary);\n}\n\n.admin-table-container {\n  overflow-x: auto;\n}\n\n.admin-table {\n  width: 100%;\n  border-collapse: collapse;\n}\n\n.admin-table th,\n.admin-table td {\n  padding: 1rem;\n  text-align: left;\n  border-bottom: 1px solid var(--admin-border);\n}\n\n.admin-table th {\n  background: var(--admin-bg);\n  font-weight: 600;\n  color: var(--admin-text);\n}\n\n.admin-role-badge {\n  padding: 0.25rem 0.75rem;\n  border-radius: 12px;\n  font-size: 0.85rem;\n  font-weight: 500;\n}\n\n.admin-role-badge.admin {\n  background: var(--admin-primary);\n  color: white;\n}\n\n.admin-role-badge.editor {\n  background: var(--admin-bg);\n  color: var(--admin-text);\n}\n\n.admin-permissions-badges {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 0.25rem;\n}\n\n.perm-badge {\n  font-size: 0.7rem;\n  padding: 0.2rem 0.5rem;\n  border-radius: 4px;\n  background: var(--admin-bg);\n}\n\n.perm-badge.create { background: #d4edda; color: #155724; }\n.perm-badge.edit { background: #cce5ff; color: #004085; }\n.perm-badge.delete { background: #f8d7da; color: #721c24; }\n.perm-badge.approval { background: #fff3cd; color: #856404; }\n\n.admin-btn-icon {\n  background: transparent;\n  border: none;\n  font-size: 1.2rem;\n  cursor: pointer;\n  padding: 0.25rem;\n  opacity: 0.7;\n  transition: opacity 0.2s;\n}\n\n.admin-btn-icon:hover {\n  opacity: 1;\n}\n\n.admin-btn-icon.delete:hover {\n  filter: hue-rotate(0deg);\n}\n\n.admin-country-layout {\n  display: flex;\n  min-height: calc(100vh - 120px);\n}\n\n.admin-sidebar {\n  width: 200px;\n  background: white;\n  border-right: 1px solid var(--admin-border);\n  padding: 1rem 0;\n}\n\n.admin-sidebar-nav {\n  display: flex;\n  flex-direction: column;\n}\n\n.admin-sidebar-item {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  padding: 1rem 1.5rem;\n  background: transparent;\n  border: none;\n  text-align: left;\n  cursor: pointer;\n  color: var(--admin-text);\n  transition: background 0.2s;\n  font-size: 0.95rem;\n}\n\n.admin-sidebar-item:hover {\n  background: var(--admin-bg);\n}\n\n.admin-sidebar-item.active {\n  background: var(--admin-bg);\n  color: var(--admin-primary);\n  font-weight: 500;\n  border-right: 3px solid var(--admin-primary);\n}\n\n.admin-sidebar-icon {\n  font-size: 1.2rem;\n}\n\n.admin-content {\n  flex: 1;\n  padding: 1.5rem;\n  background: var(--admin-bg);\n  overflow-y: auto;\n}\n\n.admin-editor {\n  background: white;\n  border-radius: 12px;\n  padding: 1.5rem;\n  min-height: 400px;\n}\n\n.admin-editor-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 1.5rem;\n  flex-wrap: wrap;\n  gap: 1rem;\n}\n\n.admin-editor-header h2 {\n  font-family: 'Cormorant Garamond', serif;\n  color: var(--admin-primary);\n}\n\n.admin-editor-filters {\n  display: flex;\n  gap: 0.5rem;\n}\n\n.admin-editor-filters select {\n  padding: 0.5rem 1rem;\n  border: 1px solid var(--admin-border);\n  border-radius: 6px;\n  background: white;\n}\n\n.admin-items-list {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n}\n\n.admin-item-card {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  padding: 1rem;\n  background: var(--admin-bg);\n  border-radius: 8px;\n  transition: transform 0.2s;\n}\n\n.admin-item-card:hover {\n  transform: translateX(5px);\n}\n\n.admin-item-thumb {\n  width: 80px;\n  height: 60px;\n  object-fit: cover;\n  border-radius: 6px;\n}\n\n.admin-item-content {\n  flex: 1;\n}\n\n.admin-item-date {\n  font-size: 0.8rem;\n  color: var(--admin-accent);\n  font-weight: 600;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n  margin-bottom: 0.25rem;\n}\n\n.admin-item-content h3 {\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 1.1rem;\n  color: var(--admin-primary);\n  margin-bottom: 0.25rem;\n}\n\n.admin-item-content p {\n  font-size: 0.9rem;\n  color: var(--admin-text-light);\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n}\n\n.admin-item-actions {\n  display: flex;\n  gap: 0.5rem;\n}\n\n.admin-array-item {\n  display: flex;\n  gap: 0.5rem;\n  margin-bottom: 0.5rem;\n}\n\n.admin-array-item textarea,\n.admin-array-item input {\n  flex: 1;\n}\n\n.admin-btn-remove {\n  background: var(--admin-danger);\n  color: white;\n  border: none;\n  width: 30px;\n  height: 30px;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 1.2rem;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  align-self: flex-start;\n  margin-top: 0.5rem;\n}\n\n.admin-btn-add {\n  background: transparent;\n  color: var(--admin-primary);\n  border: 1px dashed var(--admin-primary);\n  padding: 0.5rem 1rem;\n  border-radius: 6px;\n  cursor: pointer;\n  width: 100%;\n  margin-top: 0.5rem;\n}\n\n.admin-btn-add:hover {\n  background: rgba(12, 51, 68, 0.05);\n}\n\n.admin-testimonies-layout {\n  display: grid;\n  grid-template-columns: 250px 1fr;\n  gap: 1.5rem;\n}\n\n.admin-witnesses-list {\n  background: var(--admin-bg);\n  border-radius: 8px;\n  padding: 1rem;\n}\n\n.admin-witnesses-list h3 {\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 1rem;\n  color: var(--admin-primary);\n  margin-bottom: 1rem;\n}\n\n.admin-witness-item {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  padding: 0.75rem;\n  border-radius: 6px;\n  cursor: pointer;\n  transition: background 0.2s;\n  margin-bottom: 0.5rem;\n}\n\n.admin-witness-item:hover {\n  background: rgba(12, 51, 68, 0.1);\n}\n\n.admin-witness-item.active {\n  background: var(--admin-primary);\n  color: white;\n}\n\n.admin-witness-thumb {\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n  object-fit: cover;\n}\n\n.admin-witness-detail {\n  background: white;\n  border-radius: 8px;\n  padding: 1.5rem;\n}\n\n.admin-witness-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  margin-bottom: 1.5rem;\n  padding-bottom: 1rem;\n  border-bottom: 1px solid var(--admin-border);\n}\n\n.admin-witness-info {\n  display: flex;\n  gap: 1rem;\n}\n\n.admin-witness-avatar {\n  width: 80px;\n  height: 80px;\n  border-radius: 50%;\n  object-fit: cover;\n}\n\n.admin-witness-info h3 {\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 1.3rem;\n  color: var(--admin-primary);\n  margin-bottom: 0.5rem;\n}\n\n.admin-witness-bio {\n  font-size: 0.9rem;\n  color: var(--admin-text-light);\n  max-width: 400px;\n}\n\n.admin-testimonies-section h4 {\n  font-family: 'Cormorant Garamond', serif;\n  color: var(--admin-primary);\n  margin-bottom: 1rem;\n}\n\n.admin-testimonies-list {\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n}\n\n.admin-testimony-card {\n  background: var(--admin-bg);\n  padding: 1rem;\n  border-radius: 6px;\n}\n\n.admin-testimony-card h5 {\n  font-family: 'Cormorant Garamond', serif;\n  color: var(--admin-primary);\n  margin-bottom: 0.25rem;\n}\n\n.admin-testimony-card p {\n  font-size: 0.9rem;\n  color: var(--admin-text-light);\n  margin-bottom: 0.5rem;\n}\n\n.admin-testimony-date {\n  font-size: 0.8rem;\n  color: var(--admin-accent);\n}\n\n.admin-social-inputs {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n\n.admin-social-inputs input {\n  padding: 0.5rem;\n  border: 1px solid var(--admin-border);\n  border-radius: 4px;\n}\n\n.admin-items-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));\n  gap: 1rem;\n}\n\n.admin-analyst-card {\n  background: var(--admin-bg);\n  border-radius: 8px;\n  padding: 1rem;\n  text-align: center;\n}\n\n.admin-analyst-image {\n  width: 100px;\n  height: 100px;\n  border-radius: 50%;\n  object-fit: cover;\n  margin-bottom: 1rem;\n}\n\n.admin-analyst-info h3 {\n  font-family: 'Cormorant Garamond', serif;\n  color: var(--admin-primary);\n  margin-bottom: 0.5rem;\n}\n\n.admin-analyst-info p {\n  font-size: 0.9rem;\n  color: var(--admin-text-light);\n}\n\n.admin-media-section {\n  margin-bottom: 2rem;\n}\n\n.admin-media-section h3 {\n  font-family: 'Cormorant Garamond', serif;\n  color: var(--admin-primary);\n  margin-bottom: 1rem;\n}\n\n.admin-media-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));\n  gap: 1rem;\n}\n\n.admin-media-item {\n  position: relative;\n  aspect-ratio: 1;\n  border-radius: 8px;\n  overflow: hidden;\n  background: var(--admin-bg);\n}\n\n.admin-media-item img,\n.admin-media-item video {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n.admin-media-overlay {\n  position: absolute;\n  inset: 0;\n  background: rgba(0, 0, 0, 0.6);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 0.5rem;\n  opacity: 0;\n  transition: opacity 0.2s;\n}\n\n.admin-media-item:hover .admin-media-overlay {\n  opacity: 1;\n}\n\n.admin-media-overlay button {\n  background: white;\n  border: none;\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n  cursor: pointer;\n  font-size: 1.2rem;\n}\n\n.admin-media-name {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background: rgba(0, 0, 0, 0.7);\n  color: white;\n  font-size: 0.7rem;\n  padding: 0.25rem;\n  text-align: center;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n}\n\n.admin-image-uploader {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n\n.admin-image-preview {\n  position: relative;\n  width: 150px;\n  height: 100px;\n  border-radius: 8px;\n  overflow: hidden;\n}\n\n.admin-image-preview img {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n.admin-btn-remove-image {\n  position: absolute;\n  top: 5px;\n  right: 5px;\n  background: var(--admin-danger);\n  color: white;\n  border: none;\n  width: 24px;\n  height: 24px;\n  border-radius: 50%;\n  cursor: pointer;\n  font-size: 1rem;\n}\n\n.admin-image-actions {\n  display: flex;\n  gap: 0.5rem;\n  flex-wrap: wrap;\n}\n\n.admin-btn-upload,\n.admin-btn-gallery {\n  padding: 0.5rem 1rem;\n  border-radius: 6px;\n  cursor: pointer;\n  font-size: 0.9rem;\n}\n\n.admin-btn-upload {\n  background: var(--admin-primary);\n  color: white;\n  border: none;\n}\n\n.admin-btn-gallery {\n  background: transparent;\n  color: var(--admin-primary);\n  border: 1px solid var(--admin-primary);\n}\n\n.admin-image-url-input {\n  flex: 1;\n  min-width: 200px;\n  padding: 0.5rem;\n  border: 1px solid var(--admin-border);\n  border-radius: 6px;\n}\n\n.admin-gallery-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));\n  gap: 0.75rem;\n  margin-bottom: 1rem;\n  max-height: 400px;\n  overflow-y: auto;\n}\n\n.admin-gallery-item {\n  aspect-ratio: 1;\n  border-radius: 8px;\n  overflow: hidden;\n  cursor: pointer;\n  border: 3px solid transparent;\n  transition: border-color 0.2s;\n}\n\n.admin-gallery-item:hover {\n  border-color: var(--admin-primary);\n}\n\n.admin-gallery-item img {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n.admin-pending-list {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n}\n\n.admin-pending-card {\n  background: var(--admin-bg);\n  border-radius: 8px;\n  padding: 1rem;\n}\n\n.admin-pending-header {\n  display: flex;\n  gap: 0.5rem;\n  margin-bottom: 0.5rem;\n}\n\n.admin-pending-type {\n  padding: 0.25rem 0.5rem;\n  border-radius: 4px;\n  font-size: 0.8rem;\n  font-weight: 500;\n}\n\n.admin-pending-type.create { background: #d4edda; color: #155724; }\n.admin-pending-type.edit { background: #cce5ff; color: #004085; }\n.admin-pending-type.delete { background: #f8d7da; color: #721c24; }\n\n.admin-pending-section,\n.admin-pending-country {\n  padding: 0.25rem 0.5rem;\n  background: white;\n  border-radius: 4px;\n  font-size: 0.8rem;\n}\n\n.admin-pending-meta {\n  display: flex;\n  gap: 1rem;\n  font-size: 0.85rem;\n  color: var(--admin-text-light);\n  margin-bottom: 0.75rem;\n}\n\n.admin-pending-preview {\n  background: white;\n  padding: 0.75rem;\n  border-radius: 6px;\n  margin-bottom: 0.75rem;\n}\n\n.admin-pending-preview strong {\n  color: var(--admin-primary);\n}\n\n.admin-pending-preview p {\n  font-size: 0.9rem;\n  color: var(--admin-text-light);\n  margin-top: 0.25rem;\n}\n\n.admin-pending-actions {\n  display: flex;\n  gap: 0.5rem;\n}\n\n.admin-btn-primary.small {\n  padding: 0.5rem 1rem;\n  font-size: 0.9rem;\n}\n\n@media (max-width: 768px) {\n  .admin-header {\n    flex-direction: column;\n    gap: 1rem;\n    padding: 1rem;\n  }\n\n  .admin-nav {\n    flex-wrap: wrap;\n    padding: 0.5rem;\n  }\n\n  .admin-nav-item {\n    padding: 0.75rem 1rem;\n    font-size: 0.9rem;\n  }\n\n  .admin-main {\n    padding: 1rem;\n  }\n\n  .admin-country-layout {\n    flex-direction: column;\n  }\n\n  .admin-sidebar {\n    width: 100%;\n    border-right: none;\n    border-bottom: 1px solid var(--admin-border);\n  }\n\n  .admin-sidebar-nav {\n    flex-direction: row;\n    overflow-x: auto;\n  }\n\n  .admin-sidebar-item {\n    padding: 0.75rem 1rem;\n    white-space: nowrap;\n  }\n\n  .admin-sidebar-item.active {\n    border-right: none;\n    border-bottom: 3px solid var(--admin-primary);\n  }\n\n  .admin-testimonies-layout {\n    grid-template-columns: 1fr;\n  }\n\n  .admin-form-row {\n    grid-template-columns: 1fr;\n  }\n\n  .admin-form-row.three {\n    grid-template-columns: 1fr;\n  }\n\n  .admin-table {\n    font-size: 0.85rem;\n  }\n\n  .admin-table th,\n  .admin-table td {\n    padding: 0.5rem;\n  }\n}\n\n/* Fototeca Editor Styles */\n.admin-fototeca-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));\n  gap: 1.5rem;\n  padding: 1rem 0;\n}\n\n.admin-fototeca-item {\n  background: white;\n  border-radius: 8px;\n  overflow: hidden;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);\n  transition: all 0.2s ease;\n}\n\n.admin-fototeca-item:hover {\n  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);\n}\n\n.admin-fototeca-media {\n  position: relative;\n  aspect-ratio: 16/10;\n  background: #f0f0f0;\n  overflow: hidden;\n}\n\n.admin-fototeca-media img,\n.admin-fototeca-media video {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n.admin-fototeca-type {\n  position: absolute;\n  top: 8px;\n  right: 8px;\n  background: rgba(0, 0, 0, 0.6);\n  padding: 4px 8px;\n  border-radius: 4px;\n  font-size: 16px;\n}\n\n.admin-fototeca-info {\n  padding: 12px;\n}\n\n.admin-fototeca-date {\n  font-size: 0.8rem;\n  color: var(--admin-accent);\n  font-weight: 600;\n}\n\n.admin-fototeca-title {\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 1rem;\n  color: var(--admin-primary);\n  margin: 4px 0 0 0;\n  line-height: 1.3;\n}\n\n.admin-fototeca-actions {\n  display: flex;\n  gap: 8px;\n  padding: 8px 12px;\n  border-top: 1px solid var(--admin-border);\n  background: var(--admin-bg);\n}\n\n.admin-fototeca-actions button {\n  background: none;\n  border: none;\n  padding: 6px 10px;\n  cursor: pointer;\n  border-radius: 4px;\n  transition: background 0.2s;\n}\n\n.admin-fototeca-actions button:hover {\n  background: rgba(0, 0, 0, 0.1);\n}\n\n.admin-file-upload {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n}\n\n.admin-file-upload input[type=\"file\"] {\n  flex: 1;\n}\n\n.admin-file-preview {\n  margin-top: 1rem;\n  border: 1px solid var(--admin-border);\n  border-radius: 8px;\n  overflow: hidden;\n}\n\n.admin-file-preview img,\n.admin-file-preview video {\n  width: 100%;\n  max-height: 200px;\n  object-fit: contain;\n  background: #f0f0f0;\n}\n\n.admin-file-preview input {\n  width: 100%;\n  padding: 8px;\n  border: none;\n  border-top: 1px solid var(--admin-border);\n  font-size: 0.85rem;\n  color: #666;\n}\n\n/* Multi Media Uploader Styles */\n.admin-multi-media-uploader {\n  border: 1px solid var(--admin-border);\n  border-radius: 8px;\n  padding: 1rem;\n  background: var(--admin-bg);\n}\n\n.admin-media-list {\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n  margin-bottom: 1rem;\n}\n\n.admin-multi-media-uploader .admin-media-item {\n  display: flex;\n  gap: 1rem;\n  background: white;\n  border-radius: 8px;\n  padding: 0.75rem;\n  box-shadow: 0 1px 3px rgba(0,0,0,0.08);\n}\n\n.admin-multi-media-uploader .admin-media-preview {\n  position: relative;\n  width: 120px;\n  min-width: 120px;\n  height: 80px;\n  border-radius: 6px;\n  overflow: hidden;\n  background: #f0f0f0;\n}\n\n.admin-multi-media-uploader .admin-media-preview img,\n.admin-multi-media-uploader .admin-media-preview video {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n.admin-multi-media-uploader .admin-media-preview audio {\n  width: 100%;\n  height: 100%;\n}\n\n.admin-media-type-badge {\n  position: absolute;\n  top: 4px;\n  right: 4px;\n  background: rgba(0,0,0,0.6);\n  padding: 2px 6px;\n  border-radius: 4px;\n  font-size: 12px;\n}\n\n.admin-media-controls {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n\n.admin-media-caption {\n  flex: 1;\n  padding: 0.5rem;\n  border: 1px solid var(--admin-border);\n  border-radius: 4px;\n  font-size: 0.9rem;\n}\n\n.admin-media-buttons {\n  display: flex;\n  gap: 0.25rem;\n}\n\n.admin-btn-mini {\n  background: var(--admin-bg);\n  border: 1px solid var(--admin-border);\n  width: 28px;\n  height: 28px;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 1rem;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s;\n}\n\n.admin-btn-mini:hover {\n  background: var(--admin-primary);\n  color: white;\n  border-color: var(--admin-primary);\n}\n\n.admin-btn-mini:disabled {\n  opacity: 0.4;\n  cursor: not-allowed;\n}\n\n.admin-btn-mini.danger:hover {\n  background: var(--admin-danger);\n  border-color: var(--admin-danger);\n}\n\n.admin-media-actions {\n  margin-bottom: 1rem;\n}\n\n.admin-media-url-inputs {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n\n.admin-url-input-row {\n  display: flex;\n  gap: 0.5rem;\n}\n\n.admin-url-input-row input {\n  flex: 1;\n  padding: 0.5rem;\n  border: 1px solid var(--admin-border);\n  border-radius: 4px;\n  font-size: 0.9rem;\n}\n\n.admin-btn-add-url {\n  background: var(--admin-primary);\n  color: white;\n  border: none;\n  width: 32px;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 1.2rem;\n}\n\n.admin-btn-add-url:hover {\n  background: var(--admin-primary-light);\n}\n\n.admin-testimony-media-count {\n  display: inline-block;\n  background: var(--admin-primary);\n  color: white;\n  font-size: 0.75rem;\n  padding: 0.2rem 0.5rem;\n  border-radius: 4px;\n  margin-left: 0.5rem;\n}\n\n.admin-testimony-card {\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.admin-testimony-card:hover {\n  box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n}\n\n/* VELUM Editor Styles */\n.admin-velum-list {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n}\n\n.admin-velum-card {\n  background: var(--admin-bg);\n  border-radius: 8px;\n  padding: 1.5rem;\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  gap: 1rem;\n  transition: all 0.2s;\n  border-left: 4px solid var(--admin-primary);\n}\n\n.admin-velum-card:hover {\n  box-shadow: 0 4px 12px rgba(0,0,0,0.08);\n}\n\n.admin-velum-card-content {\n  flex: 1;\n}\n\n.admin-velum-meta {\n  display: flex;\n  gap: 1rem;\n  margin-bottom: 0.5rem;\n  font-size: 0.85rem;\n}\n\n.admin-velum-date {\n  color: var(--admin-accent);\n  font-weight: 600;\n}\n\n.admin-velum-author {\n  color: var(--admin-text-light);\n}\n\n.admin-velum-title {\n  font-family: 'Cormorant Garamond', serif;\n  font-size: 1.3rem;\n  color: var(--admin-primary);\n  margin-bottom: 0.5rem;\n  font-weight: 600;\n}\n\n.admin-velum-abstract {\n  font-size: 0.95rem;\n  color: var(--admin-text);\n  line-height: 1.6;\n  margin-bottom: 0.75rem;\n}\n\n.admin-velum-keywords {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 0.5rem;\n}\n\n.admin-velum-keyword {\n  background: var(--admin-primary);\n  color: white;\n  font-size: 0.75rem;\n  padding: 0.2rem 0.6rem;\n  border-radius: 12px;\n}\n\n.admin-velum-actions {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n\n.admin-keywords-input {\n  display: flex;\n  gap: 0.5rem;\n}\n\n.admin-keywords-input input {\n  flex: 1;\n  padding: 0.5rem;\n  border: 1px solid var(--admin-border);\n  border-radius: 4px;\n}\n\n.admin-btn-add-keyword {\n  background: var(--admin-primary);\n  color: white;\n  border: none;\n  width: 32px;\n  height: 32px;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 1.2rem;\n}\n\n.admin-keywords-list {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 0.5rem;\n  margin-top: 0.5rem;\n}\n\n.admin-keyword-tag {\n  display: inline-flex;\n  align-items: center;\n  gap: 0.25rem;\n  background: var(--admin-bg);\n  border: 1px solid var(--admin-border);\n  padding: 0.25rem 0.5rem;\n  border-radius: 4px;\n  font-size: 0.85rem;\n}\n\n.admin-keyword-tag button {\n  background: none;\n  border: none;\n  color: var(--admin-danger);\n  cursor: pointer;\n  font-size: 1rem;\n  padding: 0;\n  line-height: 1;\n}\n\n.admin-section-item {\n  border: 1px solid var(--admin-border);\n  border-radius: 8px;\n  padding: 1rem;\n  margin-bottom: 1rem;\n  background: white;\n}\n\n.admin-section-header {\n  display: flex;\n  gap: 0.5rem;\n  margin-bottom: 0.5rem;\n}\n\n.admin-section-header input {\n  flex: 1;\n  padding: 0.5rem;\n  border: 1px solid var(--admin-border);\n  border-radius: 4px;\n  font-weight: 600;\n}\n\n.admin-btn-danger.small {\n  padding: 0.4rem 0.75rem;\n  font-size: 0.85rem;\n}\n","path":null,"size_bytes":28197,"size_tokens":null},"server/routes/cms.js":{"content":"const express = require('express');\nconst fs = require('fs');\nconst path = require('path');\nconst { v4: uuidv4 } = require('uuid');\nconst { authenticateToken, checkCountryPermission, checkPermission } = require('../middleware/auth');\n\nconst router = express.Router();\nconst dataDir = path.join(__dirname, '../../public/data');\nconst pendingFile = path.join(__dirname, '../data/pending-changes.json');\n\nfunction ensureDir(dirPath) {\n  if (!fs.existsSync(dirPath)) {\n    fs.mkdirSync(dirPath, { recursive: true });\n  }\n}\n\nfunction readJSON(filePath) {\n  try {\n    if (fs.existsSync(filePath)) {\n      return JSON.parse(fs.readFileSync(filePath, 'utf8'));\n    }\n  } catch (e) {\n    console.error('Error reading JSON:', filePath, e);\n  }\n  return null;\n}\n\nfunction writeJSON(filePath, data) {\n  ensureDir(path.dirname(filePath));\n  fs.writeFileSync(filePath, JSON.stringify(data, null, 2));\n}\n\nfunction getPendingChanges() {\n  return readJSON(pendingFile) || { changes: [] };\n}\n\nfunction savePendingChange(change) {\n  const data = getPendingChanges();\n  data.changes.push({\n    id: uuidv4(),\n    ...change,\n    createdAt: new Date().toISOString(),\n    status: 'pending'\n  });\n  writeJSON(pendingFile, data);\n}\n\nrouter.get('/countries', authenticateToken, (req, res) => {\n  const lang = req.query.lang || 'es';\n  const langDir = path.join(dataDir, lang);\n  \n  if (!fs.existsSync(langDir)) {\n    return res.json({ countries: [] });\n  }\n\n  const countries = [];\n  const entries = fs.readdirSync(langDir, { withFileTypes: true });\n\n  for (const entry of entries) {\n    if (entry.isDirectory() && entry.name !== 'terminology') {\n      const metaPath = path.join(langDir, entry.name, 'meta.json');\n      const meta = readJSON(metaPath) || { name: entry.name };\n      countries.push({\n        code: entry.name,\n        name: meta.name || entry.name,\n        sections: meta.sections || []\n      });\n    }\n  }\n\n  res.json({ countries });\n});\n\nrouter.post('/countries', authenticateToken, checkPermission('create'), (req, res) => {\n  const { code, name, lang = 'es' } = req.body;\n\n  if (!code || !name) {\n    return res.status(400).json({ error: 'CÃ³digo y nombre son requeridos' });\n  }\n\n  const countryDir = path.join(dataDir, lang, code);\n  \n  if (fs.existsSync(countryDir)) {\n    return res.status(400).json({ error: 'El paÃ­s ya existe' });\n  }\n\n  ensureDir(countryDir);\n  ensureDir(path.join(countryDir, 'timeline'));\n  ensureDir(path.join(countryDir, 'testimonies'));\n  ensureDir(path.join(countryDir, 'analysts'));\n  ensureDir(path.join(countryDir, 'media', 'images'));\n  ensureDir(path.join(countryDir, 'resistance'));\n\n  const meta = {\n    name,\n    sections: [\n      { id: 'description', label: 'DescripciÃ³n del conflicto' },\n      { id: 'timeline', label: 'Timeline' },\n      { id: 'testimonies', label: 'Testimonios' },\n      { id: 'resistance', label: 'Resistencia' },\n      { id: 'media-gallery', label: 'Fototeca' }\n    ]\n  };\n\n  writeJSON(path.join(countryDir, 'meta.json'), meta);\n  writeJSON(path.join(countryDir, 'description.json'), { chapters: [] });\n  writeJSON(path.join(countryDir, 'timeline', 'timeline.index.json'), { items: [] });\n  writeJSON(path.join(countryDir, 'testimonies', 'testimonies.index.json'), { items: [] });\n  writeJSON(path.join(countryDir, 'analysts', 'analysts.index.json'), { items: [] });\n  writeJSON(path.join(countryDir, 'resistance', 'resistance.index.json'), { items: [] });\n  writeJSON(path.join(countryDir, 'media', 'images.json'), { images: [] });\n  writeJSON(path.join(countryDir, 'media', 'videos.json'), { videos: [] });\n\n  res.json({ success: true, country: { code, name } });\n});\n\nrouter.get('/countries/:countryCode/timeline', authenticateToken, (req, res) => {\n  const { countryCode } = req.params;\n  const lang = req.query.lang || 'es';\n  const indexPath = path.join(dataDir, lang, countryCode, 'timeline', 'timeline.index.json');\n  \n  const data = readJSON(indexPath) || { items: [] };\n  res.json(data);\n});\n\nrouter.post('/countries/:countryCode/timeline', authenticateToken, checkCountryPermission, checkPermission('create'), (req, res) => {\n  const { countryCode } = req.params;\n  const lang = req.query.lang || 'es';\n  const { id, date, year, month, title, summary, image, video } = req.body;\n\n  if (!id || !title || !date) {\n    return res.status(400).json({ error: 'ID, tÃ­tulo y fecha son requeridos' });\n  }\n\n  const timelineDir = path.join(dataDir, lang, countryCode, 'timeline');\n  ensureDir(timelineDir);\n\n  const indexPath = path.join(timelineDir, 'timeline.index.json');\n  const indexData = readJSON(indexPath) || { items: [] };\n\n  const newItem = { id, date, year: year || null, month: month || null, title, summary: summary || '', image: image || null };\n  \n  if (req.requiresApproval) {\n    savePendingChange({\n      type: 'create',\n      section: 'timeline',\n      countryCode,\n      lang,\n      data: newItem,\n      userId: req.user.id,\n      userName: req.user.name\n    });\n    return res.json({ success: true, pending: true, message: 'Cambio enviado para aprobaciÃ³n' });\n  }\n\n  indexData.items.push(newItem);\n  writeJSON(indexPath, indexData);\n\n  const detailData = {\n    id,\n    date,\n    year: year || null,\n    month: month || null,\n    title,\n    image: image || null,\n    video: video || null,\n    paragraphs: [],\n    sources: []\n  };\n  writeJSON(path.join(timelineDir, `${id}.json`), detailData);\n\n  res.json({ success: true, item: newItem });\n});\n\nrouter.put('/countries/:countryCode/timeline/:itemId', authenticateToken, checkCountryPermission, checkPermission('edit'), (req, res) => {\n  const { countryCode, itemId } = req.params;\n  const lang = req.query.lang || 'es';\n  const updates = req.body;\n\n  const timelineDir = path.join(dataDir, lang, countryCode, 'timeline');\n  const indexPath = path.join(timelineDir, 'timeline.index.json');\n  const detailPath = path.join(timelineDir, `${itemId}.json`);\n\n  const indexData = readJSON(indexPath);\n  if (!indexData) {\n    return res.status(404).json({ error: 'Timeline no encontrado' });\n  }\n\n  const itemIndex = indexData.items.findIndex(i => i.id === itemId);\n  if (itemIndex === -1) {\n    return res.status(404).json({ error: 'Evento no encontrado' });\n  }\n\n  if (req.requiresApproval) {\n    savePendingChange({\n      type: 'edit',\n      section: 'timeline',\n      countryCode,\n      lang,\n      itemId,\n      data: updates,\n      userId: req.user.id,\n      userName: req.user.name\n    });\n    return res.json({ success: true, pending: true, message: 'Cambio enviado para aprobaciÃ³n' });\n  }\n\n  Object.assign(indexData.items[itemIndex], {\n    date: updates.date,\n    year: updates.year,\n    month: updates.month,\n    title: updates.title,\n    summary: updates.summary,\n    image: updates.image\n  });\n  writeJSON(indexPath, indexData);\n\n  const detailData = readJSON(detailPath) || {};\n  Object.assign(detailData, updates);\n  writeJSON(detailPath, detailData);\n\n  res.json({ success: true, item: indexData.items[itemIndex] });\n});\n\nrouter.delete('/countries/:countryCode/timeline/:itemId', authenticateToken, checkCountryPermission, checkPermission('delete'), (req, res) => {\n  const { countryCode, itemId } = req.params;\n  const lang = req.query.lang || 'es';\n\n  const timelineDir = path.join(dataDir, lang, countryCode, 'timeline');\n  const indexPath = path.join(timelineDir, 'timeline.index.json');\n  const detailPath = path.join(timelineDir, `${itemId}.json`);\n\n  if (req.requiresApproval) {\n    savePendingChange({\n      type: 'delete',\n      section: 'timeline',\n      countryCode,\n      lang,\n      itemId,\n      userId: req.user.id,\n      userName: req.user.name\n    });\n    return res.json({ success: true, pending: true, message: 'EliminaciÃ³n enviada para aprobaciÃ³n' });\n  }\n\n  const indexData = readJSON(indexPath);\n  if (indexData) {\n    indexData.items = indexData.items.filter(i => i.id !== itemId);\n    writeJSON(indexPath, indexData);\n  }\n\n  if (fs.existsSync(detailPath)) {\n    fs.unlinkSync(detailPath);\n  }\n\n  res.json({ success: true });\n});\n\nrouter.get('/countries/:countryCode/testimonies', authenticateToken, (req, res) => {\n  const { countryCode } = req.params;\n  const lang = req.query.lang || 'es';\n  const indexPath = path.join(dataDir, lang, countryCode, 'testimonies', 'testimonies.index.json');\n  \n  const data = readJSON(indexPath) || { items: [] };\n  res.json(data);\n});\n\nrouter.post('/countries/:countryCode/testimonies', authenticateToken, checkCountryPermission, checkPermission('create'), (req, res) => {\n  const { countryCode } = req.params;\n  const lang = req.query.lang || 'es';\n  const { id, name, image, bio, social } = req.body;\n\n  if (!id || !name) {\n    return res.status(400).json({ error: 'ID y nombre son requeridos' });\n  }\n\n  const testimoniesDir = path.join(dataDir, lang, countryCode, 'testimonies');\n  ensureDir(testimoniesDir);\n  ensureDir(path.join(testimoniesDir, id));\n\n  const indexPath = path.join(testimoniesDir, 'testimonies.index.json');\n  const indexData = readJSON(indexPath) || { items: [] };\n\n  if (req.requiresApproval) {\n    savePendingChange({\n      type: 'create',\n      section: 'testimonies',\n      countryCode,\n      lang,\n      data: { id, name, image, bio, social },\n      userId: req.user.id,\n      userName: req.user.name\n    });\n    return res.json({ success: true, pending: true, message: 'Cambio enviado para aprobaciÃ³n' });\n  }\n\n  const newIndexItem = { id, name, image: image || null };\n  indexData.items.push(newIndexItem);\n  writeJSON(indexPath, indexData);\n\n  const witnessData = {\n    id,\n    name,\n    bio: bio || '',\n    image: image || null,\n    social: social || {},\n    testimonies: []\n  };\n  writeJSON(path.join(testimoniesDir, `${id}.json`), witnessData);\n\n  res.json({ success: true, item: newIndexItem });\n});\n\nrouter.get('/countries/:countryCode/testimonies/:witnessId', authenticateToken, (req, res) => {\n  const { countryCode, witnessId } = req.params;\n  const lang = req.query.lang || 'es';\n  const witnessPath = path.join(dataDir, lang, countryCode, 'testimonies', `${witnessId}.json`);\n  \n  const data = readJSON(witnessPath);\n  if (!data) {\n    return res.status(404).json({ error: 'Testigo no encontrado' });\n  }\n  res.json(data);\n});\n\nrouter.put('/countries/:countryCode/testimonies/:witnessId', authenticateToken, checkCountryPermission, checkPermission('edit'), (req, res) => {\n  const { countryCode, witnessId } = req.params;\n  const lang = req.query.lang || 'es';\n  const updates = req.body;\n\n  const testimoniesDir = path.join(dataDir, lang, countryCode, 'testimonies');\n  const indexPath = path.join(testimoniesDir, 'testimonies.index.json');\n  const witnessPath = path.join(testimoniesDir, `${witnessId}.json`);\n\n  if (req.requiresApproval) {\n    savePendingChange({\n      type: 'edit',\n      section: 'testimonies',\n      countryCode,\n      lang,\n      itemId: witnessId,\n      data: updates,\n      userId: req.user.id,\n      userName: req.user.name\n    });\n    return res.json({ success: true, pending: true, message: 'Cambio enviado para aprobaciÃ³n' });\n  }\n\n  const indexData = readJSON(indexPath);\n  if (indexData) {\n    const itemIndex = indexData.items.findIndex(i => i.id === witnessId);\n    if (itemIndex !== -1) {\n      if (updates.name) indexData.items[itemIndex].name = updates.name;\n      if (updates.image) indexData.items[itemIndex].image = updates.image;\n      writeJSON(indexPath, indexData);\n    }\n  }\n\n  const witnessData = readJSON(witnessPath) || { id: witnessId };\n  Object.assign(witnessData, updates);\n  writeJSON(witnessPath, witnessData);\n\n  res.json({ success: true, item: witnessData });\n});\n\nrouter.post('/countries/:countryCode/testimonies/:witnessId/testimony', authenticateToken, checkCountryPermission, checkPermission('create'), (req, res) => {\n  const { countryCode, witnessId } = req.params;\n  const lang = req.query.lang || 'es';\n  const { id, title, summary, date, paragraphs, media } = req.body;\n\n  if (!id || !title) {\n    return res.status(400).json({ error: 'ID y tÃ­tulo son requeridos' });\n  }\n\n  const testimoniesDir = path.join(dataDir, lang, countryCode, 'testimonies');\n  const witnessPath = path.join(testimoniesDir, `${witnessId}.json`);\n  const witnessDir = path.join(testimoniesDir, witnessId);\n  ensureDir(witnessDir);\n\n  if (req.requiresApproval) {\n    savePendingChange({\n      type: 'create',\n      section: 'testimony',\n      countryCode,\n      lang,\n      witnessId,\n      data: { id, title, summary, date, paragraphs, media },\n      userId: req.user.id,\n      userName: req.user.name\n    });\n    return res.json({ success: true, pending: true, message: 'Cambio enviado para aprobaciÃ³n' });\n  }\n\n  const witnessData = readJSON(witnessPath);\n  if (!witnessData) {\n    return res.status(404).json({ error: 'Testigo no encontrado' });\n  }\n\n  const newTestimonyRef = { id, title, summary: summary || '', date: date || '', media: media || [] };\n  witnessData.testimonies = witnessData.testimonies || [];\n  witnessData.testimonies.push(newTestimonyRef);\n  writeJSON(witnessPath, witnessData);\n\n  const testimonyData = {\n    id,\n    title,\n    paragraphs: paragraphs || [],\n    media: media || []\n  };\n  writeJSON(path.join(witnessDir, `${id}.json`), testimonyData);\n\n  res.json({ success: true, item: newTestimonyRef });\n});\n\nrouter.put('/countries/:countryCode/testimonies/:witnessId/testimony/:testimonyId', authenticateToken, checkCountryPermission, checkPermission('edit'), (req, res) => {\n  const { countryCode, witnessId, testimonyId } = req.params;\n  const lang = req.query.lang || 'es';\n  const { title, summary, date, paragraphs, media } = req.body;\n\n  const testimoniesDir = path.join(dataDir, lang, countryCode, 'testimonies');\n  const witnessPath = path.join(testimoniesDir, `${witnessId}.json`);\n  const witnessDir = path.join(testimoniesDir, witnessId);\n  const testimonyPath = path.join(witnessDir, `${testimonyId}.json`);\n\n  if (req.requiresApproval) {\n    savePendingChange({\n      type: 'edit',\n      section: 'testimony',\n      countryCode,\n      lang,\n      witnessId,\n      testimonyId,\n      data: { title, summary, date, paragraphs, media },\n      userId: req.user.id,\n      userName: req.user.name\n    });\n    return res.json({ success: true, pending: true, message: 'Cambio enviado para aprobaciÃ³n' });\n  }\n\n  const witnessData = readJSON(witnessPath);\n  if (witnessData && witnessData.testimonies) {\n    const idx = witnessData.testimonies.findIndex(t => t.id === testimonyId);\n    if (idx !== -1) {\n      witnessData.testimonies[idx] = {\n        ...witnessData.testimonies[idx],\n        title: title || witnessData.testimonies[idx].title,\n        summary: summary !== undefined ? summary : witnessData.testimonies[idx].summary,\n        date: date !== undefined ? date : witnessData.testimonies[idx].date,\n        media: media || witnessData.testimonies[idx].media || []\n      };\n      writeJSON(witnessPath, witnessData);\n    }\n  }\n\n  const testimonyData = readJSON(testimonyPath) || { id: testimonyId };\n  Object.assign(testimonyData, {\n    title: title || testimonyData.title,\n    paragraphs: paragraphs || testimonyData.paragraphs,\n    media: media || testimonyData.media || []\n  });\n  writeJSON(testimonyPath, testimonyData);\n\n  res.json({ success: true, item: testimonyData });\n});\n\nrouter.get('/countries/:countryCode/resistance', authenticateToken, (req, res) => {\n  const { countryCode } = req.params;\n  const lang = req.query.lang || 'es';\n  const indexPath = path.join(dataDir, lang, countryCode, 'resistance', 'resistance.index.json');\n  \n  const data = readJSON(indexPath) || { items: [] };\n  res.json(data);\n});\n\nrouter.post('/countries/:countryCode/resistance', authenticateToken, checkCountryPermission, checkPermission('create'), (req, res) => {\n  const { countryCode } = req.params;\n  const lang = req.query.lang || 'es';\n  const { id, name, image, bio, social } = req.body;\n\n  if (!id || !name) {\n    return res.status(400).json({ error: 'ID y nombre son requeridos' });\n  }\n\n  const resistanceDir = path.join(dataDir, lang, countryCode, 'resistance');\n  ensureDir(resistanceDir);\n  ensureDir(path.join(resistanceDir, id));\n\n  const indexPath = path.join(resistanceDir, 'resistance.index.json');\n  const indexData = readJSON(indexPath) || { items: [] };\n\n  if (req.requiresApproval) {\n    savePendingChange({\n      type: 'create',\n      section: 'resistance',\n      countryCode,\n      lang,\n      data: { id, name, image, bio, social },\n      userId: req.user.id,\n      userName: req.user.name\n    });\n    return res.json({ success: true, pending: true, message: 'Cambio enviado para aprobaciÃ³n' });\n  }\n\n  const newIndexItem = { id, name, image: image || null };\n  indexData.items.push(newIndexItem);\n  writeJSON(indexPath, indexData);\n\n  const resistorData = {\n    id,\n    name,\n    bio: bio || '',\n    image: image || null,\n    social: social || {},\n    entries: []\n  };\n  writeJSON(path.join(resistanceDir, `${id}.json`), resistorData);\n\n  res.json({ success: true, item: newIndexItem });\n});\n\nrouter.get('/countries/:countryCode/resistance/:resistorId', authenticateToken, (req, res) => {\n  const { countryCode, resistorId } = req.params;\n  const lang = req.query.lang || 'es';\n  const resistorPath = path.join(dataDir, lang, countryCode, 'resistance', `${resistorId}.json`);\n  \n  const data = readJSON(resistorPath);\n  if (!data) {\n    return res.status(404).json({ error: 'Entrada no encontrada' });\n  }\n  res.json(data);\n});\n\nrouter.put('/countries/:countryCode/resistance/:resistorId', authenticateToken, checkCountryPermission, checkPermission('edit'), (req, res) => {\n  const { countryCode, resistorId } = req.params;\n  const lang = req.query.lang || 'es';\n  const updates = req.body;\n\n  const resistanceDir = path.join(dataDir, lang, countryCode, 'resistance');\n  const indexPath = path.join(resistanceDir, 'resistance.index.json');\n  const resistorPath = path.join(resistanceDir, `${resistorId}.json`);\n\n  if (req.requiresApproval) {\n    savePendingChange({\n      type: 'edit',\n      section: 'resistance',\n      countryCode,\n      lang,\n      itemId: resistorId,\n      data: updates,\n      userId: req.user.id,\n      userName: req.user.name\n    });\n    return res.json({ success: true, pending: true, message: 'Cambio enviado para aprobaciÃ³n' });\n  }\n\n  const indexData = readJSON(indexPath);\n  if (indexData) {\n    const itemIndex = indexData.items.findIndex(i => i.id === resistorId);\n    if (itemIndex !== -1) {\n      if (updates.name) indexData.items[itemIndex].name = updates.name;\n      if (updates.image) indexData.items[itemIndex].image = updates.image;\n      writeJSON(indexPath, indexData);\n    }\n  }\n\n  const resistorData = readJSON(resistorPath) || { id: resistorId };\n  Object.assign(resistorData, updates);\n  writeJSON(resistorPath, resistorData);\n\n  res.json({ success: true, item: resistorData });\n});\n\nrouter.post('/countries/:countryCode/resistance/:resistorId/entry', authenticateToken, checkCountryPermission, checkPermission('create'), (req, res) => {\n  const { countryCode, resistorId } = req.params;\n  const lang = req.query.lang || 'es';\n  const { id, title, summary, date, paragraphs, media } = req.body;\n\n  if (!id || !title) {\n    return res.status(400).json({ error: 'ID y tÃ­tulo son requeridos' });\n  }\n\n  const resistanceDir = path.join(dataDir, lang, countryCode, 'resistance');\n  const resistorPath = path.join(resistanceDir, `${resistorId}.json`);\n  const resistorFolder = path.join(resistanceDir, resistorId);\n  ensureDir(resistorFolder);\n\n  if (req.requiresApproval) {\n    savePendingChange({\n      type: 'create',\n      section: 'resistance-entry',\n      countryCode,\n      lang,\n      resistorId,\n      data: { id, title, summary, date, paragraphs, media },\n      userId: req.user.id,\n      userName: req.user.name\n    });\n    return res.json({ success: true, pending: true, message: 'Cambio enviado para aprobaciÃ³n' });\n  }\n\n  const resistorData = readJSON(resistorPath);\n  if (!resistorData) {\n    return res.status(404).json({ error: 'Entrada de resistencia no encontrada' });\n  }\n\n  const newEntryRef = { id, title, summary: summary || '', date: date || '', media: media || [] };\n  resistorData.entries = resistorData.entries || [];\n  resistorData.entries.push(newEntryRef);\n  writeJSON(resistorPath, resistorData);\n\n  const entryData = {\n    id,\n    title,\n    paragraphs: paragraphs || [],\n    media: media || []\n  };\n  writeJSON(path.join(resistorFolder, `${id}.json`), entryData);\n\n  res.json({ success: true, item: newEntryRef });\n});\n\nrouter.put('/countries/:countryCode/resistance/:resistorId/entry/:entryId', authenticateToken, checkCountryPermission, checkPermission('edit'), (req, res) => {\n  const { countryCode, resistorId, entryId } = req.params;\n  const lang = req.query.lang || 'es';\n  const { title, summary, date, paragraphs, media } = req.body;\n\n  const resistanceDir = path.join(dataDir, lang, countryCode, 'resistance');\n  const resistorPath = path.join(resistanceDir, `${resistorId}.json`);\n  const resistorFolder = path.join(resistanceDir, resistorId);\n  const entryPath = path.join(resistorFolder, `${entryId}.json`);\n\n  if (req.requiresApproval) {\n    savePendingChange({\n      type: 'edit',\n      section: 'resistance-entry',\n      countryCode,\n      lang,\n      resistorId,\n      entryId,\n      data: { title, summary, date, paragraphs, media },\n      userId: req.user.id,\n      userName: req.user.name\n    });\n    return res.json({ success: true, pending: true, message: 'Cambio enviado para aprobaciÃ³n' });\n  }\n\n  const resistorData = readJSON(resistorPath);\n  if (resistorData && resistorData.entries) {\n    const idx = resistorData.entries.findIndex(e => e.id === entryId);\n    if (idx !== -1) {\n      resistorData.entries[idx] = {\n        ...resistorData.entries[idx],\n        title: title || resistorData.entries[idx].title,\n        summary: summary !== undefined ? summary : resistorData.entries[idx].summary,\n        date: date !== undefined ? date : resistorData.entries[idx].date,\n        media: media || resistorData.entries[idx].media || []\n      };\n      writeJSON(resistorPath, resistorData);\n    }\n  }\n\n  const entryData = readJSON(entryPath) || { id: entryId };\n  Object.assign(entryData, {\n    title: title || entryData.title,\n    paragraphs: paragraphs || entryData.paragraphs,\n    media: media || entryData.media || []\n  });\n  writeJSON(entryPath, entryData);\n\n  res.json({ success: true, item: entryData });\n});\n\nrouter.get('/countries/:countryCode/analysts', authenticateToken, (req, res) => {\n  const { countryCode } = req.params;\n  const lang = req.query.lang || 'es';\n  const indexPath = path.join(dataDir, lang, countryCode, 'analysts', 'analysts.index.json');\n  \n  const data = readJSON(indexPath) || { items: [] };\n  res.json(data);\n});\n\nrouter.post('/countries/:countryCode/analysts', authenticateToken, checkCountryPermission, checkPermission('create'), (req, res) => {\n  const { countryCode } = req.params;\n  const lang = req.query.lang || 'es';\n  const { id, name, image, bio } = req.body;\n\n  if (!id || !name) {\n    return res.status(400).json({ error: 'ID y nombre son requeridos' });\n  }\n\n  const analystsDir = path.join(dataDir, lang, countryCode, 'analysts');\n  ensureDir(analystsDir);\n  ensureDir(path.join(analystsDir, id));\n\n  const indexPath = path.join(analystsDir, 'analysts.index.json');\n  const indexData = readJSON(indexPath) || { items: [] };\n\n  if (req.requiresApproval) {\n    savePendingChange({\n      type: 'create',\n      section: 'analysts',\n      countryCode,\n      lang,\n      data: { id, name, image, bio },\n      userId: req.user.id,\n      userName: req.user.name\n    });\n    return res.json({ success: true, pending: true, message: 'Cambio enviado para aprobaciÃ³n' });\n  }\n\n  const newIndexItem = { id, name, image: image || null };\n  indexData.items.push(newIndexItem);\n  writeJSON(indexPath, indexData);\n\n  const analystData = {\n    id,\n    name,\n    bio: bio || '',\n    image: image || null,\n    analyses: []\n  };\n  writeJSON(path.join(analystsDir, `${id}.json`), analystData);\n\n  res.json({ success: true, item: newIndexItem });\n});\n\nrouter.get('/pending', authenticateToken, (req, res) => {\n  if (req.user.role !== 'admin') {\n    return res.status(403).json({ error: 'Solo el administrador puede ver cambios pendientes' });\n  }\n  \n  const data = getPendingChanges();\n  res.json(data);\n});\n\nrouter.post('/pending/:changeId/approve', authenticateToken, (req, res) => {\n  if (req.user.role !== 'admin') {\n    return res.status(403).json({ error: 'Solo el administrador puede aprobar cambios' });\n  }\n\n  const { changeId } = req.params;\n  const data = getPendingChanges();\n  const changeIndex = data.changes.findIndex(c => c.id === changeId);\n\n  if (changeIndex === -1) {\n    return res.status(404).json({ error: 'Cambio no encontrado' });\n  }\n\n  const change = data.changes[changeIndex];\n  \n  data.changes.splice(changeIndex, 1);\n  writeJSON(pendingFile, data);\n\n  res.json({ success: true, message: 'Cambio aprobado' });\n});\n\nrouter.post('/pending/:changeId/reject', authenticateToken, (req, res) => {\n  if (req.user.role !== 'admin') {\n    return res.status(403).json({ error: 'Solo el administrador puede rechazar cambios' });\n  }\n\n  const { changeId } = req.params;\n  const data = getPendingChanges();\n  const changeIndex = data.changes.findIndex(c => c.id === changeId);\n\n  if (changeIndex === -1) {\n    return res.status(404).json({ error: 'Cambio no encontrado' });\n  }\n\n  data.changes.splice(changeIndex, 1);\n  writeJSON(pendingFile, data);\n\n  res.json({ success: true, message: 'Cambio rechazado' });\n});\n\nrouter.get('/countries/:countryCode/fototeca', authenticateToken, (req, res) => {\n  const { countryCode } = req.params;\n  const lang = req.query.lang || 'es';\n  const indexPath = path.join(dataDir, lang, countryCode, 'fototeca', 'fototeca.index.json');\n  \n  const data = readJSON(indexPath) || { items: [] };\n  res.json(data);\n});\n\nrouter.post('/countries/:countryCode/fototeca', authenticateToken, checkCountryPermission, checkPermission('create'), (req, res) => {\n  const { countryCode } = req.params;\n  const lang = req.query.lang || 'es';\n  const { title, date, description, type, url } = req.body;\n\n  if (!title || !url) {\n    return res.status(400).json({ error: 'TÃ­tulo y URL son requeridos' });\n  }\n\n  const fototecaDir = path.join(dataDir, lang, countryCode, 'fototeca');\n  ensureDir(fototecaDir);\n\n  const indexPath = path.join(fototecaDir, 'fototeca.index.json');\n  const indexData = readJSON(indexPath) || { items: [] };\n\n  const id = uuidv4();\n\n  if (req.requiresApproval) {\n    savePendingChange({\n      type: 'create',\n      section: 'fototeca',\n      countryCode,\n      lang,\n      data: { id, title, date, description, type, url },\n      userId: req.user.id,\n      userName: req.user.name\n    });\n    return res.json({ success: true, pending: true, message: 'Cambio enviado para aprobaciÃ³n' });\n  }\n\n  const newItem = { id, title, date: date || '', description: description || '', type: type || 'image', url };\n  indexData.items.push(newItem);\n  writeJSON(indexPath, indexData);\n\n  res.json({ success: true, item: newItem });\n});\n\nrouter.put('/countries/:countryCode/fototeca/:itemId', authenticateToken, checkCountryPermission, checkPermission('edit'), (req, res) => {\n  const { countryCode, itemId } = req.params;\n  const lang = req.query.lang || 'es';\n  const { title, date, description, type, url } = req.body;\n\n  const indexPath = path.join(dataDir, lang, countryCode, 'fototeca', 'fototeca.index.json');\n  const indexData = readJSON(indexPath);\n\n  if (!indexData) {\n    return res.status(404).json({ error: 'Fototeca no encontrada' });\n  }\n\n  const itemIndex = indexData.items.findIndex(i => i.id === itemId);\n  if (itemIndex === -1) {\n    return res.status(404).json({ error: 'Elemento no encontrado' });\n  }\n\n  if (req.requiresApproval) {\n    savePendingChange({\n      type: 'edit',\n      section: 'fototeca',\n      countryCode,\n      lang,\n      itemId,\n      data: { title, date, description, type, url },\n      userId: req.user.id,\n      userName: req.user.name\n    });\n    return res.json({ success: true, pending: true, message: 'Cambio enviado para aprobaciÃ³n' });\n  }\n\n  indexData.items[itemIndex] = {\n    ...indexData.items[itemIndex],\n    title: title || indexData.items[itemIndex].title,\n    date: date !== undefined ? date : indexData.items[itemIndex].date,\n    description: description !== undefined ? description : indexData.items[itemIndex].description,\n    type: type || indexData.items[itemIndex].type,\n    url: url || indexData.items[itemIndex].url\n  };\n\n  writeJSON(indexPath, indexData);\n  res.json({ success: true, item: indexData.items[itemIndex] });\n});\n\nrouter.delete('/countries/:countryCode/fototeca/:itemId', authenticateToken, checkCountryPermission, checkPermission('delete'), (req, res) => {\n  const { countryCode, itemId } = req.params;\n  const lang = req.query.lang || 'es';\n\n  const indexPath = path.join(dataDir, lang, countryCode, 'fototeca', 'fototeca.index.json');\n  const indexData = readJSON(indexPath);\n\n  if (!indexData) {\n    return res.status(404).json({ error: 'Fototeca no encontrada' });\n  }\n\n  const itemIndex = indexData.items.findIndex(i => i.id === itemId);\n  if (itemIndex === -1) {\n    return res.status(404).json({ error: 'Elemento no encontrado' });\n  }\n\n  if (req.requiresApproval) {\n    savePendingChange({\n      type: 'delete',\n      section: 'fototeca',\n      countryCode,\n      lang,\n      itemId,\n      data: indexData.items[itemIndex],\n      userId: req.user.id,\n      userName: req.user.name\n    });\n    return res.json({ success: true, pending: true, message: 'Cambio enviado para aprobaciÃ³n' });\n  }\n\n  indexData.items.splice(itemIndex, 1);\n  writeJSON(indexPath, indexData);\n\n  res.json({ success: true, message: 'Elemento eliminado' });\n});\n\nrouter.get('/velum', authenticateToken, (req, res) => {\n  const lang = req.query.lang || 'es';\n  const indexPath = path.join(dataDir, lang, 'velum', 'velum.index.json');\n  \n  const data = readJSON(indexPath) || { items: [] };\n  res.json(data);\n});\n\nrouter.post('/velum', authenticateToken, checkPermission('create'), (req, res) => {\n  const lang = req.query.lang || 'es';\n  const { id, title, author, authorImage, date, abstract, keywords, sections, bibliography } = req.body;\n\n  if (!id || !title) {\n    return res.status(400).json({ error: 'ID y tÃ­tulo son requeridos' });\n  }\n\n  const velumDir = path.join(dataDir, lang, 'velum');\n  ensureDir(velumDir);\n\n  const indexPath = path.join(velumDir, 'velum.index.json');\n  const indexData = readJSON(indexPath) || { items: [] };\n\n  if (req.requiresApproval) {\n    savePendingChange({\n      type: 'create',\n      section: 'velum',\n      lang,\n      data: { id, title, author, authorImage, date, abstract, keywords, sections, bibliography },\n      userId: req.user.id,\n      userName: req.user.name\n    });\n    return res.json({ success: true, pending: true, message: 'Cambio enviado para aprobaciÃ³n' });\n  }\n\n  const newIndexItem = { \n    id, \n    title, \n    author: author || '', \n    date: date || '',\n    abstract: abstract || '',\n    keywords: keywords || []\n  };\n  indexData.items.push(newIndexItem);\n  writeJSON(indexPath, indexData);\n\n  const articleData = {\n    id,\n    title,\n    author: author || '',\n    authorImage: authorImage || '',\n    date: date || '',\n    abstract: abstract || '',\n    keywords: keywords || [],\n    sections: sections || [],\n    bibliography: bibliography || []\n  };\n  writeJSON(path.join(velumDir, `${id}.json`), articleData);\n\n  res.json({ success: true, item: newIndexItem });\n});\n\nrouter.get('/velum/:articleId', authenticateToken, (req, res) => {\n  const { articleId } = req.params;\n  const lang = req.query.lang || 'es';\n  const articlePath = path.join(dataDir, lang, 'velum', `${articleId}.json`);\n  \n  const data = readJSON(articlePath);\n  if (!data) {\n    return res.status(404).json({ error: 'ArtÃ­culo no encontrado' });\n  }\n  res.json(data);\n});\n\nrouter.put('/velum/:articleId', authenticateToken, checkPermission('edit'), (req, res) => {\n  const { articleId } = req.params;\n  const lang = req.query.lang || 'es';\n  const { title, author, authorImage, date, abstract, keywords, sections, bibliography } = req.body;\n\n  const velumDir = path.join(dataDir, lang, 'velum');\n  const indexPath = path.join(velumDir, 'velum.index.json');\n  const articlePath = path.join(velumDir, `${articleId}.json`);\n\n  if (req.requiresApproval) {\n    savePendingChange({\n      type: 'edit',\n      section: 'velum',\n      lang,\n      articleId,\n      data: { title, author, authorImage, date, abstract, keywords, sections, bibliography },\n      userId: req.user.id,\n      userName: req.user.name\n    });\n    return res.json({ success: true, pending: true, message: 'Cambio enviado para aprobaciÃ³n' });\n  }\n\n  const indexData = readJSON(indexPath);\n  if (indexData) {\n    const itemIndex = indexData.items.findIndex(i => i.id === articleId);\n    if (itemIndex !== -1) {\n      indexData.items[itemIndex] = {\n        ...indexData.items[itemIndex],\n        title: title || indexData.items[itemIndex].title,\n        author: author !== undefined ? author : indexData.items[itemIndex].author,\n        date: date !== undefined ? date : indexData.items[itemIndex].date,\n        abstract: abstract !== undefined ? abstract : indexData.items[itemIndex].abstract,\n        keywords: keywords || indexData.items[itemIndex].keywords\n      };\n      writeJSON(indexPath, indexData);\n    }\n  }\n\n  const articleData = readJSON(articlePath) || { id: articleId };\n  Object.assign(articleData, {\n    title: title || articleData.title,\n    author: author !== undefined ? author : articleData.author,\n    authorImage: authorImage !== undefined ? authorImage : articleData.authorImage,\n    date: date !== undefined ? date : articleData.date,\n    abstract: abstract !== undefined ? abstract : articleData.abstract,\n    keywords: keywords || articleData.keywords,\n    sections: sections || articleData.sections,\n    bibliography: bibliography || articleData.bibliography\n  });\n  writeJSON(articlePath, articleData);\n\n  res.json({ success: true, item: articleData });\n});\n\nrouter.delete('/velum/:articleId', authenticateToken, checkPermission('delete'), (req, res) => {\n  const { articleId } = req.params;\n  const lang = req.query.lang || 'es';\n\n  const velumDir = path.join(dataDir, lang, 'velum');\n  const indexPath = path.join(velumDir, 'velum.index.json');\n  const articlePath = path.join(velumDir, `${articleId}.json`);\n\n  const indexData = readJSON(indexPath);\n  if (!indexData) {\n    return res.status(404).json({ error: 'VELUM no encontrado' });\n  }\n\n  const itemIndex = indexData.items.findIndex(i => i.id === articleId);\n  if (itemIndex === -1) {\n    return res.status(404).json({ error: 'ArtÃ­culo no encontrado' });\n  }\n\n  if (req.requiresApproval) {\n    savePendingChange({\n      type: 'delete',\n      section: 'velum',\n      lang,\n      articleId,\n      data: indexData.items[itemIndex],\n      userId: req.user.id,\n      userName: req.user.name\n    });\n    return res.json({ success: true, pending: true, message: 'Cambio enviado para aprobaciÃ³n' });\n  }\n\n  indexData.items.splice(itemIndex, 1);\n  writeJSON(indexPath, indexData);\n\n  if (fs.existsSync(articlePath)) {\n    fs.unlinkSync(articlePath);\n  }\n\n  res.json({ success: true, message: 'ArtÃ­culo eliminado' });\n});\n\nmodule.exports = router;\n","path":null,"size_bytes":35299,"size_tokens":null}},"version":2}